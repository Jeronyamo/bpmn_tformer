<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="4.6.0"><bpmn:process id="TEMPLATE_INSTANCE_PROCESS_OptimizationModelPortfolio_a48c8e02-04df-4b8c-96ed-1c6f6105ce6b" name="Оптимизация модельного портфеля" isExecutable="true"><bpmn:documentation /><bpmn:startEvent id="StartEvent_1"><bpmn:outgoing>SequenceFlow_0or7jn6</bpmn:outgoing></bpmn:startEvent><bpmn:endEvent id="EndEvent_0djl7a3"><bpmn:incoming>SequenceFlow_049okmm</bpmn:incoming></bpmn:endEvent><bpmn:sequenceFlow id="SequenceFlow_0or7jn6" sourceRef="StartEvent_1" targetRef="Activity_1qvpiyz" /><bpmn:sequenceFlow id="SequenceFlow_049okmm" sourceRef="Task_1ujk4ck" targetRef="EndEvent_0djl7a3" /><bpmn:serviceTask id="Task_1ujk4ck" name="Сообщаем об окончании процесса"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/processCompleted/${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_15n8ayk</bpmn:incoming><bpmn:outgoing>SequenceFlow_049okmm</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="Activity_1dmo7st" name="Статус: Портфель оптимизирован"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Портфель+оптимизирован</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0rrjz0c</bpmn:incoming><bpmn:outgoing>Flow_15n8ayk</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_15n8ayk" sourceRef="Activity_1dmo7st" targetRef="Task_1ujk4ck" /><bpmn:serviceTask id="Activity_19posc1" name="Статус: Получен промежуточный расчет"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Получены+характеристики+инструментов</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0xxwqtk</bpmn:incoming><bpmn:outgoing>Flow_0qri0z7</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="Activity_0nlvmfl" name="Статус: Оптимизация портфеля"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Оптимизация+портфеля</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1lpjyl1</bpmn:incoming><bpmn:outgoing>Flow_0x0sldj</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="Activity_0hk18j9" name="Статус: Корректировка данных"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Корректировка+данных</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_15hhgcy</bpmn:incoming><bpmn:outgoing>Flow_1fc43pe</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="Activity_1qvpiyz" name="Статус: Ввод параметров"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Ввод+параметров</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0or7jn6</bpmn:incoming><bpmn:outgoing>Flow_0leu98n</bpmn:outgoing></bpmn:serviceTask><bpmn:userTask id="Activity_1gd43m3" name="Ввод параметров" camunda:asyncAfter="true" camunda:formKey="FILL" camunda:assignee="${initiator}" camunda:candidateGroups="WWW_SVC, Compliance-Managers, FW_VPN_EXT_EGAR, cb_compliance, jira-users, EzDoc_users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="fillverify" /></camunda:properties><camunda:formData><camunda:formField id="ezdocObjectUrl" type="string" /><camunda:formField id="ezdocObjectEditorUrl" type="string" /><camunda:formField id="mp_OptimizationAlgorithm" label="Алгоритм оптимизации" type="string" /><camunda:formField id="mp_OptimizationGoalList" label="Цель оптимизации " type="string" /><camunda:formField id="ExcludingShortPositions" label="Без учета коротких позиций" type="boolean" /><camunda:formField id="NoWeightLimits" label="Без ограничений по весам" type="boolean" /><camunda:formField id="ExpectedYield" label="Ожидаемая  доходность" type="string" /><camunda:formField id="mp_AllowRisk" label="Ожидаемый риск" type="string" /><camunda:formField id="MinNumObservat" label="Минимальное число наблюдений" type="string" /><camunda:formField id="NumberPoints" label="Число точек" type="string" /><camunda:formField id="NumberDaysYear" label="Число торговых дней в году" type="string" /><camunda:formField id="Message" label="Сообщение" type="string" /></camunda:formData><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
data.templateId = templateId;
data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener></bpmn:extensionElements><bpmn:incoming>Flow_04lit63</bpmn:incoming><bpmn:incoming>Flow_0fy399u</bpmn:incoming><bpmn:incoming>Flow_0t58wpg</bpmn:incoming><bpmn:incoming>Flow_0kkxuuc</bpmn:incoming><bpmn:outgoing>Flow_0aorocz</bpmn:outgoing></bpmn:userTask><bpmn:sequenceFlow id="Flow_0leu98n" sourceRef="Activity_1qvpiyz" targetRef="Activity_10e5shl" /><bpmn:sequenceFlow id="Flow_0aorocz" sourceRef="Activity_1gd43m3" targetRef="Activity_1uwqtdv" /><bpmn:userTask id="Activity_1fddfr0" name="Кнопки Редактировать, Принять" camunda:asyncAfter="true" camunda:assignee="${initiator}" camunda:candidateGroups="WWW_SVC, Compliance-Managers, FW_VPN_EXT_EGAR, cb_compliance, jira-users, EzDoc_users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;: &#34;Correct&#34;, &#34;label&#34;: &#34;Скорректировать расчеты&#34;, &#34;type&#34;:&#34;simple&#34;}" type="string" /><camunda:formField id="ezdocObjectUrl" type="string" /><camunda:formField id="ezdocObjectEditorUrl" type="string" /><camunda:formField id="{&#34;id&#34;: &#34;Accept&#34;, &#34;label&#34;: &#34;Принять расчеты&#34;, &#34;type&#34;:&#34;simple&#34;}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>Flow_0qri0z7</bpmn:incoming><bpmn:outgoing>Flow_1lpjyl1</bpmn:outgoing><bpmn:outgoing>Flow_15hhgcy</bpmn:outgoing></bpmn:userTask><bpmn:sequenceFlow id="Flow_0qri0z7" sourceRef="Activity_19posc1" targetRef="Activity_1fddfr0" /><bpmn:sequenceFlow id="Flow_1lpjyl1" sourceRef="Activity_1fddfr0" targetRef="Activity_0nlvmfl"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'Accept'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="Flow_15hhgcy" sourceRef="Activity_1fddfr0" targetRef="Activity_0hk18j9"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'Correct'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="Activity_13m6clf" name="Запрос предвариетльного расчета оптимизации портфеля в CalcService"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry><camunda:entry key="Authorization">Basic ${Authorization}</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="url">${focusUrl}/api/Tasks/ExecuteSync/Markowitz?isFinalCalc=false&amp;covarianceMatrixMethod=ledoit_wolf_constant_correlation&amp;optimizationModel=${optimizationModel}&amp;expectedReturn=${ExpectedYield}&amp;expectedVolatility=${mp_AllowRisk}&amp;minObservations=${MinNumObservat}&amp;weight_bounds=${weight_bounds}&amp;tradingDays=${NumberDaysYear}&amp;efPoints=${NumberPoints}&amp;ef_param=${ef_param}&amp;mapConstraints=${NoWeightLimits}&amp;setVolatilities=false&amp;setExpectedReturns=false</camunda:inputParameter><camunda:outputParameter name="OMPInstruments"><camunda:script scriptFormat="javascript">try {
S(response).prop("Result").prop("ExpectedReturnAndVolatilities").elements().size()
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="Message"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).Message
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="TaskStatus"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).TaskStatus
}
catch (e)
{
-1
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="response_r">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_13m0dzi</bpmn:incoming><bpmn:outgoing>Flow_0w1cipw</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="Gateway_08hysbi" default="Flow_004imb2"><bpmn:incoming>Flow_0p78z1x</bpmn:incoming><bpmn:outgoing>Flow_004imb2</bpmn:outgoing><bpmn:outgoing>Flow_1ewf4db</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_004imb2" sourceRef="Gateway_08hysbi" targetRef="Activity_0otacew" /><bpmn:serviceTask id="Activity_1uwqtdv" name="Получаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttributes?systemName=mp_OptimizationAlgorithm&amp;systemName=mp_OptimizationGoalList&amp;systemName=MinNumObservat&amp;systemName=NumberPoints&amp;systemName=NumberDaysYear&amp;systemName=ExpectedYield&amp;systemName=mp_AllowRisk&amp;systemName=ExcludingShortPositions&amp;systemName=NoWeightLimits&amp;systemName=mp_ResultPriorCalculations</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="OMPRequests"><camunda:script scriptFormat="javascript">try{
S(response).prop("mp_ResultPriorCalculations")
} catch(e)
{
throw new org.camunda.bpm.engine.delegate.BpmnError("IT_EXCEPTION",e);
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="NoWeightLimits"><camunda:script scriptFormat="javascript">JSON.parse(response).NoWeightLimits</camunda:script></camunda:outputParameter><camunda:outputParameter name="ExcludingShortPositions"><camunda:script scriptFormat="javascript">JSON.parse(response).ExcludingShortPositions</camunda:script></camunda:outputParameter><camunda:outputParameter name="mp_AllowRisk"><camunda:script scriptFormat="javascript">JSON.parse(response).mp_AllowRisk</camunda:script></camunda:outputParameter><camunda:outputParameter name="ExpectedYield"><camunda:script scriptFormat="javascript">JSON.parse(response).ExpectedYield</camunda:script></camunda:outputParameter><camunda:outputParameter name="NumberDaysYear"><camunda:script scriptFormat="javascript">JSON.parse(response).NumberDaysYear</camunda:script></camunda:outputParameter><camunda:outputParameter name="mp_OptimizationAlgorithm"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).mp_OptimizationAlgorithm
}
catch (e)
{
"0"
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="mp_OptimizationGoalList"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).mp_OptimizationGoalList
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="MinNumObservat"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).MinNumObservat
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="NumberPoints"><camunda:script scriptFormat="javascript">JSON.parse(response).NumberPoints</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0aorocz</bpmn:incoming><bpmn:outgoing>Flow_0p78z1x</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0p78z1x" sourceRef="Activity_1uwqtdv" targetRef="Gateway_08hysbi" /><bpmn:serviceTask id="Activity_17fnlwv" name="Устанавливаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("Message", "Не заполнено одно или несколько обязательных параметров: Алгоритм оптимизации, Цель оптимизации, Минимальное число наблюдений, Число точек, Число торговых дней в году.")
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1ewf4db</bpmn:incoming><bpmn:outgoing>Flow_02jibfx</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_02jibfx" sourceRef="Activity_17fnlwv" targetRef="Activity_1a4tqtv" /><bpmn:sequenceFlow id="Flow_1ewf4db" name="Не заполнены обязательные параметры" sourceRef="Gateway_08hysbi" targetRef="Activity_17fnlwv"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${mp_OptimizationAlgorithm == null || mp_OptimizationGoalList == null || MinNumObservat == null || NumberPoints == null || NumberDaysYear == null}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:exclusiveGateway id="Gateway_0zjhsao"><bpmn:incoming>Flow_1fkh9i0</bpmn:incoming><bpmn:outgoing>Flow_0z68wk6</bpmn:outgoing><bpmn:outgoing>Flow_03ndiwc</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="Activity_0ol1am8" name="Устанавливаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("Message", "Не заполнен параметр Ожидаемая доходность.")
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1hekhfo</bpmn:incoming><bpmn:outgoing>Flow_1axzoy0</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="Activity_1doq1ir" name="Устанавливаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("Message", "Не заполнен параметр Ожидаемый риск.")
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1f1uolw</bpmn:incoming><bpmn:outgoing>Flow_1ggdmli</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0z68wk6" sourceRef="Gateway_0zjhsao" targetRef="Gateway_1ld042j"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${mp_OptimizationGoalList == "Минимизация риска"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="Flow_03ndiwc" sourceRef="Gateway_0zjhsao" targetRef="Gateway_0l0agtc"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${mp_OptimizationGoalList == "Максимизация доходности"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="Activity_1irt4lf" name="Статус: Не заполнены обязательные параметры"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Не+заполнены+обязательные+параметры</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1axzoy0</bpmn:incoming><bpmn:outgoing>Flow_0t58wpg</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0t58wpg" sourceRef="Activity_1irt4lf" targetRef="Activity_1gd43m3" /><bpmn:sequenceFlow id="Flow_1axzoy0" sourceRef="Activity_0ol1am8" targetRef="Activity_1irt4lf" /><bpmn:sequenceFlow id="Flow_1fc43pe" sourceRef="Activity_0hk18j9" targetRef="Activity_0eweprz" /><bpmn:userTask id="Activity_0eweprz" name="Корректировка данных" camunda:asyncAfter="true" camunda:formKey="FILL" camunda:assignee="${initiator}" camunda:candidateGroups="WWW_SVC, Compliance-Managers, FW_VPN_EXT_EGAR, cb_compliance, jira-users, EzDoc_users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="fillverify" /></camunda:properties><camunda:formData><camunda:formField id="ezdocObjectUrl" type="string" /><camunda:formField id="ezdocObjectEditorUrl" type="string" /><camunda:formField id="mp_OptimizationAlgorithm" label="Алгоритм оптимизации" type="string" /><camunda:formField id="mp_OptimizationGoalList" label="Цель оптимизации " type="string" /><camunda:formField id="ExcludingShortPositions" label="Без учета коротких позиций" type="boolean" /><camunda:formField id="NoWeightLimits" label="Без ограничений по весам" type="boolean" /><camunda:formField id="ExpectedYield" label="Ожидаемая  доходность" type="string" /><camunda:formField id="mp_AllowRisk" label="Ожидаемый риск" type="string" /><camunda:formField id="MinNumObservat" label="Минимальное число наблюдений" type="string" /><camunda:formField id="NumberPoints" label="Число точек" type="string" /><camunda:formField id="NumberDaysYear" label="Число торговых дней в году" type="string" /><camunda:formField id="Message" label="Сообщение" type="string" /></camunda:formData><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
data.templateId = templateId;
data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener></bpmn:extensionElements><bpmn:incoming>Flow_1fc43pe</bpmn:incoming><bpmn:outgoing>Flow_0jkyrdh</bpmn:outgoing></bpmn:userTask><bpmn:exclusiveGateway id="Gateway_1ld042j" default="Flow_1r0gnio"><bpmn:incoming>Flow_0z68wk6</bpmn:incoming><bpmn:outgoing>Flow_1hekhfo</bpmn:outgoing><bpmn:outgoing>Flow_1r0gnio</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_1hekhfo" sourceRef="Gateway_1ld042j" targetRef="Activity_0ol1am8"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${ExpectedYield == null}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="Flow_1r0gnio" sourceRef="Gateway_1ld042j" targetRef="Activity_03f292o" /><bpmn:exclusiveGateway id="Gateway_0l0agtc" default="Flow_096nu3p"><bpmn:incoming>Flow_03ndiwc</bpmn:incoming><bpmn:outgoing>Flow_1f1uolw</bpmn:outgoing><bpmn:outgoing>Flow_096nu3p</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_1f1uolw" sourceRef="Gateway_0l0agtc" targetRef="Activity_1doq1ir"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${mp_AllowRisk == null}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="Activity_1p2ai2y" name="Статус: Не заполнены обязательные параметры"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Не+заполнены+обязательные+параметры</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1ggdmli</bpmn:incoming><bpmn:outgoing>Flow_0fy399u</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0fy399u" sourceRef="Activity_1p2ai2y" targetRef="Activity_1gd43m3" /><bpmn:sequenceFlow id="Flow_1ggdmli" sourceRef="Activity_1doq1ir" targetRef="Activity_1p2ai2y" /><bpmn:sequenceFlow id="Flow_096nu3p" sourceRef="Gateway_0l0agtc" targetRef="Activity_11rcb8j" /><bpmn:exclusiveGateway id="Gateway_0fvkcm9"><bpmn:incoming>Flow_1o0hni4</bpmn:incoming><bpmn:incoming>Flow_0it45xs</bpmn:incoming><bpmn:outgoing>Flow_00zpxk7</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_00zpxk7" sourceRef="Gateway_0fvkcm9" targetRef="Gateway_114x4fu" /><bpmn:serviceTask id="Activity_1a4tqtv" name="Статус: Не заполнены обязательные параметры"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Не+заполнены+обязательные+параметры</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_02jibfx</bpmn:incoming><bpmn:outgoing>Flow_04lit63</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_04lit63" sourceRef="Activity_1a4tqtv" targetRef="Activity_1gd43m3" /><bpmn:serviceTask id="Activity_0otacew" name="Устанавливаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("Message", " ")
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_004imb2</bpmn:incoming><bpmn:outgoing>Flow_1fkh9i0</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_1fkh9i0" sourceRef="Activity_0otacew" targetRef="Gateway_0zjhsao" /><bpmn:serviceTask id="Activity_0kwmvui" name="Запрос окончательного расчета оптимизации портфеля в CalcService"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry><camunda:entry key="Authorization">Basic ${Authorization}</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="url">${focusUrl}/api/Tasks/ExecuteSync/Markowitz?isFinalCalc=true&amp;covarianceMatrixMethod=ledoit_wolf_constant_correlation&amp;optimizationModel=${optimizationModel}&amp;expectedReturn=${ExpectedYield}&amp;expectedVolatility=${mp_AllowRisk}&amp;minObservations=${MinNumObservat}&amp;weight_bounds=${weight_bounds}&amp;tradingDays=${NumberDaysYear}&amp;efPoints=${NumberPoints}&amp;ef_param=${ef_param}&amp;mapConstraints=${NoWeightLimits}&amp;setVolatilities=true&amp;setExpectedReturns=true&amp;volatilities=${volatilities}&amp;expectedReturns=${expectedReturns}</camunda:inputParameter><camunda:outputParameter name="OMPInstrumentsF"><camunda:script scriptFormat="javascript">try {
S(response).prop("Result").prop("Weights").elements().size()
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="MessageF"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).Message
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="TaskStatusF"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).TaskStatus
}
catch (e)
{
-1
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="responseF">${response}</camunda:outputParameter><camunda:outputParameter name="mp_PortfolioRisk"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).Result.ExpectedRisk
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="mp_ExpectedProfit"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).Result.ExpectedReturn
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="mp_OptimizationGoal"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).Result.OptimizationModel
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0v9y598</bpmn:incoming><bpmn:outgoing>Flow_0pr6nsv</bpmn:outgoing></bpmn:serviceTask><bpmn:scriptTask id="Activity_00kh6qi" name="Предвариетльный расчет из фокуса" scriptFormat="JavaScript" camunda:resultVariable="RequestsFromFocus"><bpmn:incoming>Flow_04xcuxq</bpmn:incoming><bpmn:outgoing>Flow_1rj2a30</bpmn:outgoing><bpmn:script>S(response_r).prop("Result").prop("ExpectedReturnAndVolatilities")</bpmn:script></bpmn:scriptTask><bpmn:scriptTask id="Activity_1ba90yl" name="Преобразование предварительного расчета" scriptFormat="javascript" camunda:resultVariable="OMPRequests_modified"><bpmn:incoming>Flow_1rj2a30</bpmn:incoming><bpmn:outgoing>Flow_0bq2c6v</bpmn:outgoing><bpmn:script>var OMPRequestsEzD = [];
var OMPRequestsFocus = JSON.parse(RequestsFromFocus);
for (var i = 0; i &lt; OMPInstruments; i++) 
{
   var q = new Object();
   q.mp_instrumentsName = OMPRequestsFocus[i].Ticker;
   q.ClassInstrumentName = OMPRequestsFocus[i].Class;
   q.mp_Expected = OMPRequestsFocus[i].ExpectedReturn;
   q.AllowRisk = OMPRequestsFocus[i].Volatility;
   OMPRequestsEzD.push(q);

}
result = new Object();
result.OMPRequests = OMPRequestsEzD;
JSON.stringify(result);</bpmn:script></bpmn:scriptTask><bpmn:serviceTask id="Activity_11rcb8j" name="Устанавливаем значение параметров optimizationModel" camunda:expression="efficient_risk" camunda:resultVariable="optimizationModel"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties></bpmn:extensionElements><bpmn:incoming>Flow_096nu3p</bpmn:incoming><bpmn:outgoing>Flow_0it45xs</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0it45xs" sourceRef="Activity_11rcb8j" targetRef="Gateway_0fvkcm9" /><bpmn:serviceTask id="Activity_03f292o" name="Устанавливаем значение параметров optimizationModel" camunda:expression="efficient_return" camunda:resultVariable="optimizationModel"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties></bpmn:extensionElements><bpmn:incoming>Flow_1r0gnio</bpmn:incoming><bpmn:outgoing>Flow_1o0hni4</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_1o0hni4" sourceRef="Activity_03f292o" targetRef="Gateway_0fvkcm9" /><bpmn:serviceTask id="Activity_00qjq30" name="Устанавливаем значение параметров weight_bounds" camunda:expression="%5B-1,1%5D" camunda:resultVariable="weight_bounds"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties></bpmn:extensionElements><bpmn:incoming>Flow_17bmhz4</bpmn:incoming><bpmn:outgoing>Flow_1bftx8y</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_1bftx8y" sourceRef="Activity_00qjq30" targetRef="Gateway_1bw3g9g" /><bpmn:exclusiveGateway id="Gateway_114x4fu" default="Flow_08nnyxx"><bpmn:incoming>Flow_00zpxk7</bpmn:incoming><bpmn:outgoing>Flow_1kjetjx</bpmn:outgoing><bpmn:outgoing>Flow_11qpsmk</bpmn:outgoing><bpmn:outgoing>Flow_08nnyxx</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_1kjetjx" sourceRef="Gateway_114x4fu" targetRef="Activity_0el6xln"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${optimizationModel == "efficient_risk"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="Activity_11qy6uv" name="Устанавливаем значение параметров ef_param" camunda:expression="return" camunda:resultVariable="ef_param"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties></bpmn:extensionElements><bpmn:incoming>Flow_11qpsmk</bpmn:incoming><bpmn:outgoing>Flow_0ncq8vz</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="Activity_0el6xln" name="Устанавливаем значение параметров ef_param" camunda:expression="risk" camunda:resultVariable="ef_param"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties></bpmn:extensionElements><bpmn:incoming>Flow_1kjetjx</bpmn:incoming><bpmn:outgoing>Flow_0lbrvum</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0lbrvum" sourceRef="Activity_0el6xln" targetRef="Gateway_03nygfj" /><bpmn:serviceTask id="Activity_1dga9cb" name="Устанавливаем значение параметров ef_param" camunda:expression="utility" camunda:resultVariable="ef_param"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties></bpmn:extensionElements><bpmn:incoming>Flow_08nnyxx</bpmn:incoming><bpmn:outgoing>Flow_03dfm59</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_11qpsmk" sourceRef="Gateway_114x4fu" targetRef="Activity_11qy6uv"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${optimizationModel == "efficient_return"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="Flow_08nnyxx" sourceRef="Gateway_114x4fu" targetRef="Activity_1dga9cb" /><bpmn:exclusiveGateway id="Gateway_03nygfj"><bpmn:incoming>Flow_0lbrvum</bpmn:incoming><bpmn:incoming>Flow_03dfm59</bpmn:incoming><bpmn:incoming>Flow_0ncq8vz</bpmn:incoming><bpmn:outgoing>Flow_01yztt8</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_01yztt8" sourceRef="Gateway_03nygfj" targetRef="Gateway_0tcspsm" /><bpmn:sequenceFlow id="Flow_03dfm59" sourceRef="Activity_1dga9cb" targetRef="Gateway_03nygfj" /><bpmn:sequenceFlow id="Flow_0ncq8vz" sourceRef="Activity_11qy6uv" targetRef="Gateway_03nygfj" /><bpmn:exclusiveGateway id="Gateway_0tcspsm" default="Flow_17bmhz4"><bpmn:incoming>Flow_01yztt8</bpmn:incoming><bpmn:outgoing>Flow_17bmhz4</bpmn:outgoing><bpmn:outgoing>Flow_0bhyxd4</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_17bmhz4" sourceRef="Gateway_0tcspsm" targetRef="Activity_00qjq30" /><bpmn:serviceTask id="Activity_0229g2c" name="Устанавливаем значение параметров weight_bounds" camunda:expression="%5B0,1%5D" camunda:resultVariable="weight_bounds"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties></bpmn:extensionElements><bpmn:incoming>Flow_0bhyxd4</bpmn:incoming><bpmn:outgoing>Flow_19vhl3t</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0bhyxd4" sourceRef="Gateway_0tcspsm" targetRef="Activity_0229g2c"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${ExcludingShortPositions == true}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="Flow_19vhl3t" sourceRef="Activity_0229g2c" targetRef="Gateway_1bw3g9g" /><bpmn:exclusiveGateway id="Gateway_1bw3g9g"><bpmn:incoming>Flow_19vhl3t</bpmn:incoming><bpmn:incoming>Flow_1bftx8y</bpmn:incoming><bpmn:outgoing>Flow_0dnkqm4</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_0dnkqm4" sourceRef="Gateway_1bw3g9g" targetRef="Activity_03zpxco" /><bpmn:scriptTask id="Activity_01yibxp" name="переменная адрес фокус" scriptFormat="javascript"><bpmn:incoming>Flow_0hxvfng</bpmn:incoming><bpmn:outgoing>Flow_0kkxuuc</bpmn:outgoing><bpmn:script>execution.setVariable("focusUrl", (java.lang.System).getenv("focusUrl"))</bpmn:script></bpmn:scriptTask><bpmn:sequenceFlow id="Flow_0kkxuuc" sourceRef="Activity_01yibxp" targetRef="Activity_1gd43m3" /><bpmn:sequenceFlow id="Flow_0jkyrdh" sourceRef="Activity_0eweprz" targetRef="Activity_14x27xj" /><bpmn:sequenceFlow id="Flow_0w1cipw" sourceRef="Activity_13m6clf" targetRef="Activity_156rzg2" /><bpmn:sequenceFlow id="Flow_1rj2a30" sourceRef="Activity_00kh6qi" targetRef="Activity_1ba90yl" /><bpmn:sequenceFlow id="Flow_0bq2c6v" sourceRef="Activity_1ba90yl" targetRef="Activity_1aaqt96" /><bpmn:serviceTask id="Activity_0rs1vs5" name="Статус: Невозможно выполнить оптимизацию портфеля"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Невозможно+выполнить+оптимизацию+портфеля</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0k57ecf</bpmn:incoming><bpmn:outgoing>Flow_1jptbzy</bpmn:outgoing></bpmn:serviceTask><bpmn:endEvent id="Event_0gcmwg7"><bpmn:incoming>Flow_1lsoyyc</bpmn:incoming></bpmn:endEvent><bpmn:serviceTask id="Activity_16xvx1a" name="Сообщаем об окончании процесса"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/processCompleted/${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1jptbzy</bpmn:incoming><bpmn:outgoing>Flow_1lsoyyc</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="Gateway_1fqt24v" default="Flow_1nuozd3"><bpmn:incoming>Flow_1lzvme7</bpmn:incoming><bpmn:incoming>Flow_0pv0hjp</bpmn:incoming><bpmn:outgoing>Flow_04xcuxq</bpmn:outgoing><bpmn:outgoing>Flow_1nuozd3</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_1jptbzy" sourceRef="Activity_0rs1vs5" targetRef="Activity_16xvx1a" /><bpmn:sequenceFlow id="Flow_1lsoyyc" sourceRef="Activity_16xvx1a" targetRef="Event_0gcmwg7" /><bpmn:sequenceFlow id="Flow_04xcuxq" sourceRef="Gateway_1fqt24v" targetRef="Activity_00kh6qi"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${TaskStatus == 1}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="Activity_0ew7w8m" name="Получаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttributes?systemName=mp_ResultPriorCalculations</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="OMPInstruments"><camunda:script scriptFormat="javascript">try {
S(response).prop("mp_ResultPriorCalculations").elements().size()
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="RequestsFromEZD"><camunda:script scriptFormat="javascript">try{
S(response).prop("mp_ResultPriorCalculations")
} catch(e)
{
throw new org.camunda.bpm.engine.delegate.BpmnError("IT_EXCEPTION",e);
}</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0qx6onj</bpmn:incoming><bpmn:outgoing>Flow_1f51uu6</bpmn:outgoing></bpmn:serviceTask><bpmn:scriptTask id="Activity_1aaqt96" name="json" scriptFormat="JavaScript" camunda:resultVariable="OMPRequests12"><bpmn:incoming>Flow_0bq2c6v</bpmn:incoming><bpmn:outgoing>Flow_1scp3a7</bpmn:outgoing><bpmn:script>S(OMPRequests_modified).prop("OMPRequests")</bpmn:script></bpmn:scriptTask><bpmn:serviceTask id="Activity_10kioj7" name="Устанавливаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("mp_ResultPriorCalculations", OMPRequests12)
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1scp3a7</bpmn:incoming><bpmn:outgoing>Flow_0xxwqtk</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0xxwqtk" sourceRef="Activity_10kioj7" targetRef="Activity_19posc1" /><bpmn:sequenceFlow id="Flow_1tkvohb" sourceRef="Activity_1gvry0e" targetRef="Activity_1argcnj" /><bpmn:exclusiveGateway id="Gateway_0f79g2p" default="Flow_02qtzye"><bpmn:incoming>Flow_0pr6nsv</bpmn:incoming><bpmn:outgoing>Flow_02qtzye</bpmn:outgoing><bpmn:outgoing>Flow_0hyhvc6</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_02qtzye" name="Ошибка при расчете" sourceRef="Gateway_0f79g2p" targetRef="Activity_08oj2u0" /><bpmn:sequenceFlow id="Flow_0pr6nsv" sourceRef="Activity_0kwmvui" targetRef="Gateway_0f79g2p" /><bpmn:sequenceFlow id="Flow_1scp3a7" sourceRef="Activity_1aaqt96" targetRef="Activity_10kioj7" /><bpmn:scriptTask id="Activity_1gwcpsh" name="Предвариетльный расчет из фокуса" scriptFormat="JavaScript" camunda:resultVariable="RequestsFromFocusFinal"><bpmn:incoming>Flow_0hyhvc6</bpmn:incoming><bpmn:outgoing>Flow_0f766yt</bpmn:outgoing><bpmn:script>S(responseF).prop("Result").prop("Weights")</bpmn:script></bpmn:scriptTask><bpmn:scriptTask id="Activity_0w0y1v8" name="Преобразование предварительного расчета" scriptFormat="javascript" camunda:resultVariable="OMPRequests_modifiedFinal"><bpmn:incoming>Flow_0f766yt</bpmn:incoming><bpmn:outgoing>Flow_1gyrmey</bpmn:outgoing><bpmn:script>var OMPRequestsEzD = [];
var OMPRequestsFocus = JSON.parse(RequestsFromFocusFinal);
for (var i = 0; i &lt; OMPInstrumentsF; i++) 
{
   var q = new Object();
   q.instrumentName = OMPRequestsFocus[i].Ticker;
   q.ClassName = OMPRequestsFocus[i].Class;
   q.mp_instrumentShare = OMPRequestsFocus[i].Weight;
   OMPRequestsEzD.push(q);

}
result = new Object();
result.OMPRequests = OMPRequestsEzD;
JSON.stringify(result);</bpmn:script></bpmn:scriptTask><bpmn:scriptTask id="Activity_1dh4ogt" name="json" scriptFormat="JavaScript" camunda:resultVariable="OMPRequests12"><bpmn:incoming>Flow_1gyrmey</bpmn:incoming><bpmn:outgoing>Flow_1gpqagr</bpmn:outgoing><bpmn:script>S(OMPRequests_modifiedFinal).prop("OMPRequests")</bpmn:script></bpmn:scriptTask><bpmn:sequenceFlow id="Flow_0hyhvc6" sourceRef="Gateway_0f79g2p" targetRef="Activity_1gwcpsh"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${TaskStatusF == 1}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="Flow_0x0sldj" sourceRef="Activity_0nlvmfl" targetRef="Activity_1fdtt7j" /><bpmn:scriptTask id="Activity_0fza31u" name="Преобразование параметров expectedReturns" scriptFormat="javascript"><bpmn:incoming>Flow_0o9pget</bpmn:incoming><bpmn:outgoing>Flow_0gsve7j</bpmn:outgoing><bpmn:script>var OMPRequestsEzD = [];
var Requests = JSON.parse(RequestsFromEZD);
for (var i = 0; i &lt; OMPInstruments - Number(0); i++) 
{
OMPRequestsEzD.push('%22'+Requests[i].mp_instrumentsName + '%22:' +Requests[i].mp_Expected);
}
execution.setVariable("expectedReturns",'%7b' + OMPRequestsEzD + '%7d');</bpmn:script></bpmn:scriptTask><bpmn:sequenceFlow id="Flow_0gsve7j" sourceRef="Activity_0fza31u" targetRef="Activity_19kiaac" /><bpmn:sequenceFlow id="Flow_1f51uu6" sourceRef="Activity_0ew7w8m" targetRef="Activity_0k9dl3m" /><bpmn:sequenceFlow id="Flow_0o9pget" sourceRef="Activity_0k9dl3m" targetRef="Activity_0fza31u" /><bpmn:serviceTask id="Activity_1gvry0e" name="Запрос предвариетльного расчета оптимизации портфеля в CalcService"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry><camunda:entry key="Authorization">Basic ${Authorization}</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="url">${focusUrl}/api/Tasks/ExecuteSync/Markowitz?isFinalCalc=false&amp;covarianceMatrixMethod=ledoit_wolf_constant_correlation&amp;optimizationModel=${optimizationModel}&amp;expectedReturn=${ExpectedYield}&amp;expectedVolatility=${mp_AllowRisk}&amp;minObservations=${MinNumObservat}&amp;weight_bounds=${weight_bounds}&amp;tradingDays=${NumberDaysYear}&amp;efPoints=${NumberPoints}&amp;ef_param=${ef_param}&amp;mapConstraints=${NoWeightLimits}&amp;setVolatilities=true&amp;setExpectedReturns=true&amp;volatilities=${volatilities}&amp;expectedReturns=${expectedReturns}</camunda:inputParameter><camunda:outputParameter name="OMPInstruments"><camunda:script scriptFormat="javascript">try {
S(response).prop("Result").prop("ExpectedReturnAndVolatilities").elements().size()
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="Message"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).Message
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="TaskStatus"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).TaskStatus
}
catch (e)
{
-1
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="response_r">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0mt4iav</bpmn:incoming><bpmn:outgoing>Flow_1tkvohb</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0f766yt" sourceRef="Activity_1gwcpsh" targetRef="Activity_0w0y1v8" /><bpmn:sequenceFlow id="Flow_1gyrmey" sourceRef="Activity_0w0y1v8" targetRef="Activity_1dh4ogt" /><bpmn:scriptTask id="Activity_0k9dl3m" name="Преобразование параметров volatilities" scriptFormat="javascript"><bpmn:incoming>Flow_1f51uu6</bpmn:incoming><bpmn:outgoing>Flow_0o9pget</bpmn:outgoing><bpmn:script>var OMPRequestsEzD = [];
var Requests = JSON.parse(RequestsFromEZD);
for (var i = 0; i &lt; OMPInstruments - Number(0); i++) 
{
OMPRequestsEzD.push('%22'+Requests[i].mp_instrumentsName + '%22:' +Requests[i].AllowRisk);
}
execution.setVariable("volatilities",'%7b' + OMPRequestsEzD + '%7d');</bpmn:script></bpmn:scriptTask><bpmn:serviceTask id="Activity_1fdtt7j" name="Получаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttributes?systemName=mp_ResultPriorCalculations</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="OMPInstruments"><camunda:script scriptFormat="javascript">try {
S(response).prop("mp_ResultPriorCalculations").elements().size()
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="RequestsFromEZD"><camunda:script scriptFormat="javascript">try{
S(response).prop("mp_ResultPriorCalculations")
} catch(e)
{
throw new org.camunda.bpm.engine.delegate.BpmnError("IT_EXCEPTION",e);
}</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0x0sldj</bpmn:incoming><bpmn:outgoing>Flow_1hwv7hr</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_1hwv7hr" sourceRef="Activity_1fdtt7j" targetRef="Activity_13k65ym" /><bpmn:scriptTask id="Activity_13k65ym" name="Преобразование параметров volatilities" scriptFormat="javascript"><bpmn:incoming>Flow_1hwv7hr</bpmn:incoming><bpmn:outgoing>Flow_0zaxnm6</bpmn:outgoing><bpmn:script>var OMPRequestsEzD = [];
var Requests = JSON.parse(RequestsFromEZD);
for (var i = 0; i &lt; OMPInstruments - Number(0); i++) 
{
OMPRequestsEzD.push('%22'+Requests[i].mp_instrumentsName + '%22:' +Requests[i].AllowRisk);
}
execution.setVariable("volatilities",'%7b' + OMPRequestsEzD + '%7d');</bpmn:script></bpmn:scriptTask><bpmn:sequenceFlow id="Flow_0zaxnm6" sourceRef="Activity_13k65ym" targetRef="Activity_1vry2o9" /><bpmn:scriptTask id="Activity_1vry2o9" name="Преобразование параметров expectedReturns" scriptFormat="javascript"><bpmn:incoming>Flow_0zaxnm6</bpmn:incoming><bpmn:outgoing>Flow_0v9y598</bpmn:outgoing><bpmn:script>var OMPRequestsEzD = [];
var Requests = JSON.parse(RequestsFromEZD);
for (var i = 0; i &lt; OMPInstruments - Number(0); i++) 
{
OMPRequestsEzD.push('%22'+Requests[i].mp_instrumentsName + '%22:' +Requests[i].mp_Expected);
}
execution.setVariable("expectedReturns",'%7b' + OMPRequestsEzD + '%7d');</bpmn:script></bpmn:scriptTask><bpmn:sequenceFlow id="Flow_0v9y598" sourceRef="Activity_1vry2o9" targetRef="Activity_0kwmvui" /><bpmn:sequenceFlow id="Flow_1nuozd3" name="Ошибка при расчете" sourceRef="Gateway_1fqt24v" targetRef="Activity_1s90w3u" /><bpmn:serviceTask id="Activity_1eqyuml" name="Устанавливаем значение параметров"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("mp_InstrumentsResultsFinalCalculations", OMPRequests12)
.prop("mp_ExpectedProfit", mp_ExpectedProfit)
.prop("mp_PortfolioRisk", mp_PortfolioRisk)
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1gpqagr</bpmn:incoming><bpmn:outgoing>Flow_0rrjz0c</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_1gpqagr" sourceRef="Activity_1dh4ogt" targetRef="Activity_1eqyuml" /><bpmn:sequenceFlow id="Flow_0rrjz0c" sourceRef="Activity_1eqyuml" targetRef="Activity_1dmo7st" /><bpmn:serviceTask id="Activity_14x27xj" name="Статус: Данные скорректированы"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Данные+скорректированы</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0jkyrdh</bpmn:incoming><bpmn:outgoing>Flow_0qx6onj</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0qx6onj" sourceRef="Activity_14x27xj" targetRef="Activity_0ew7w8m" /><bpmn:serviceTask id="Activity_1s90w3u" name="Статус: Ошибка расчета оптимизации модельного портфеля"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("Message", Message)
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1nuozd3</bpmn:incoming><bpmn:outgoing>Flow_0k57ecf</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0k57ecf" sourceRef="Activity_1s90w3u" targetRef="Activity_0rs1vs5" /><bpmn:serviceTask id="Activity_0inf0bs" name="Статус: Невозможно выполнить оптимизацию портфеля"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Невозможно+выполнить+оптимизацию+портфеля</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1755uhk</bpmn:incoming><bpmn:outgoing>Flow_00h4fg9</bpmn:outgoing></bpmn:serviceTask><bpmn:endEvent id="Event_05p7omp"><bpmn:incoming>Flow_0jevd2m</bpmn:incoming></bpmn:endEvent><bpmn:serviceTask id="Activity_09w44ne" name="Сообщаем об окончании процесса"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/processCompleted/${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_00h4fg9</bpmn:incoming><bpmn:outgoing>Flow_0jevd2m</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="Activity_08oj2u0" name="Статус: Ошибка расчета оптимизации модельного портфеля"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("Message", MessageF)
.toString()</camunda:script></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_02qtzye</bpmn:incoming><bpmn:outgoing>Flow_1755uhk</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_00h4fg9" sourceRef="Activity_0inf0bs" targetRef="Activity_09w44ne" /><bpmn:sequenceFlow id="Flow_0jevd2m" sourceRef="Activity_09w44ne" targetRef="Event_05p7omp" /><bpmn:sequenceFlow id="Flow_1755uhk" sourceRef="Activity_08oj2u0" targetRef="Activity_0inf0bs" /><bpmn:serviceTask id="Activity_19kiaac" name="Статус: Проверка наличия данных"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Проверка+наличия+данных</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0gsve7j</bpmn:incoming><bpmn:outgoing>Flow_0mt4iav</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0mt4iav" sourceRef="Activity_19kiaac" targetRef="Activity_1gvry0e" /><bpmn:serviceTask id="Activity_03zpxco" name="Статус: Проверка наличия данных"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Проверка+наличия+данных</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0dnkqm4</bpmn:incoming><bpmn:outgoing>Flow_13m0dzi</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_13m0dzi" sourceRef="Activity_03zpxco" targetRef="Activity_13m6clf" /><bpmn:serviceTask id="Activity_156rzg2" name="Статус: Расчет характеристик инструментов"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Расчет+характеристик+инструментов</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0w1cipw</bpmn:incoming><bpmn:outgoing>Flow_1lzvme7</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_1lzvme7" sourceRef="Activity_156rzg2" targetRef="Gateway_1fqt24v" /><bpmn:serviceTask id="Activity_1argcnj" name="Статус: Расчет характеристик инструментов"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Расчет+характеристик+инструментов</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_1tkvohb</bpmn:incoming><bpmn:outgoing>Flow_0pv0hjp</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0pv0hjp" sourceRef="Activity_1argcnj" targetRef="Gateway_1fqt24v" /><bpmn:scriptTask id="Activity_10e5shl" name="переменная для авторизации" scriptFormat="javascript"><bpmn:incoming>Flow_0leu98n</bpmn:incoming><bpmn:outgoing>Flow_0hxvfng</bpmn:outgoing><bpmn:script>execution.setVariable("Authorization", (java.lang.System).getenv("Authorization"))</bpmn:script></bpmn:scriptTask><bpmn:sequenceFlow id="Flow_0hxvfng" sourceRef="Activity_10e5shl" targetRef="Activity_01yibxp" /></bpmn:process><bpmn:signal id="Signal_1eotpns" name="OMPUpdate${instanceId}" /><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="TEMPLATE_INSTANCE_PROCESS_OptimizationModelPortfolio_a48c8e02-04df-4b8c-96ed-1c6f6105ce6b"><bpmndi:BPMNEdge id="Flow_0hxvfng_di" bpmnElement="Flow_0hxvfng"><di:waypoint x="450" y="320" /><di:waypoint x="450" y="360" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0pv0hjp_di" bpmnElement="Flow_0pv0hjp"><di:waypoint x="2740" y="300" /><di:waypoint x="2740" y="375" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1lzvme7_di" bpmnElement="Flow_1lzvme7"><di:waypoint x="2660" y="400" /><di:waypoint x="2715" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_13m0dzi_di" bpmnElement="Flow_13m0dzi"><di:waypoint x="2320" y="400" /><di:waypoint x="2400" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0mt4iav_di" bpmnElement="Flow_0mt4iav"><di:waypoint x="2850" y="120" /><di:waypoint x="2790" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1755uhk_di" bpmnElement="Flow_1755uhk"><di:waypoint x="4720" y="610" /><di:waypoint x="4720" y="640" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0jevd2m_di" bpmnElement="Flow_0jevd2m"><di:waypoint x="4720" y="840" /><di:waypoint x="4720" y="872" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_00h4fg9_di" bpmnElement="Flow_00h4fg9"><di:waypoint x="4720" y="720" /><di:waypoint x="4720" y="760" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0k57ecf_di" bpmnElement="Flow_0k57ecf"><di:waypoint x="2740" y="600" /><di:waypoint x="2740" y="640" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0qx6onj_di" bpmnElement="Flow_0qx6onj"><di:waypoint x="3500" y="120" /><di:waypoint x="3440" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0rrjz0c_di" bpmnElement="Flow_0rrjz0c"><di:waypoint x="5430" y="400" /><di:waypoint x="5490" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1gpqagr_di" bpmnElement="Flow_1gpqagr"><di:waypoint x="5260" y="400" /><di:waypoint x="5330" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1nuozd3_di" bpmnElement="Flow_1nuozd3"><di:waypoint x="2740" y="425" /><di:waypoint x="2740" y="520" /><bpmndi:BPMNLabel><dc:Bounds x="2668" y="436" width="63" height="27" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0v9y598_di" bpmnElement="Flow_0v9y598"><di:waypoint x="4420" y="400" /><di:waypoint x="4500" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0zaxnm6_di" bpmnElement="Flow_0zaxnm6"><di:waypoint x="4250" y="400" /><di:waypoint x="4320" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1hwv7hr_di" bpmnElement="Flow_1hwv7hr"><di:waypoint x="4090" y="400" /><di:waypoint x="4150" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1gyrmey_di" bpmnElement="Flow_1gyrmey"><di:waypoint x="5100" y="400" /><di:waypoint x="5160" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0f766yt_di" bpmnElement="Flow_0f766yt"><di:waypoint x="4940" y="400" /><di:waypoint x="5000" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0o9pget_di" bpmnElement="Flow_0o9pget"><di:waypoint x="3180" y="120" /><di:waypoint x="3110" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1f51uu6_di" bpmnElement="Flow_1f51uu6"><di:waypoint x="3340" y="120" /><di:waypoint x="3280" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0gsve7j_di" bpmnElement="Flow_0gsve7j"><di:waypoint x="3010" y="120" /><di:waypoint x="2950" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0x0sldj_di" bpmnElement="Flow_0x0sldj"><di:waypoint x="3920" y="400" /><di:waypoint x="3990" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0hyhvc6_di" bpmnElement="Flow_0hyhvc6"><di:waypoint x="4745" y="400" /><di:waypoint x="4840" y="400" /><di:waypoint x="4840" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1scp3a7_di" bpmnElement="Flow_1scp3a7"><di:waypoint x="3280" y="400" /><di:waypoint x="3340" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0pr6nsv_di" bpmnElement="Flow_0pr6nsv"><di:waypoint x="4600" y="400" /><di:waypoint x="4695" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_02qtzye_di" bpmnElement="Flow_02qtzye"><di:waypoint x="4720" y="425" /><di:waypoint x="4720" y="530" /><bpmndi:BPMNLabel><dc:Bounds x="4648" y="445" width="63" height="27" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1tkvohb_di" bpmnElement="Flow_1tkvohb"><di:waypoint x="2740" y="160" /><di:waypoint x="2740" y="220" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0xxwqtk_di" bpmnElement="Flow_0xxwqtk"><di:waypoint x="3440" y="400" /><di:waypoint x="3500" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_04xcuxq_di" bpmnElement="Flow_04xcuxq"><di:waypoint x="2765" y="400" /><di:waypoint x="2850" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1lsoyyc_di" bpmnElement="Flow_1lsoyyc"><di:waypoint x="2740" y="840" /><di:waypoint x="2740" y="872" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1jptbzy_di" bpmnElement="Flow_1jptbzy"><di:waypoint x="2740" y="720" /><di:waypoint x="2740" y="760" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0bq2c6v_di" bpmnElement="Flow_0bq2c6v"><di:waypoint x="3110" y="400" /><di:waypoint x="3180" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1rj2a30_di" bpmnElement="Flow_1rj2a30"><di:waypoint x="2950" y="400" /><di:waypoint x="3010" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0w1cipw_di" bpmnElement="Flow_0w1cipw"><di:waypoint x="2500" y="400" /><di:waypoint x="2560" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0jkyrdh_di" bpmnElement="Flow_0jkyrdh"><di:waypoint x="3650" y="120" /><di:waypoint x="3600" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0kkxuuc_di" bpmnElement="Flow_0kkxuuc"><di:waypoint x="500" y="400" /><di:waypoint x="570" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0dnkqm4_di" bpmnElement="Flow_0dnkqm4"><di:waypoint x="2155" y="400" /><di:waypoint x="2220" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_19vhl3t_di" bpmnElement="Flow_19vhl3t"><di:waypoint x="2060" y="300" /><di:waypoint x="2130" y="300" /><di:waypoint x="2130" y="375" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0bhyxd4_di" bpmnElement="Flow_0bhyxd4"><di:waypoint x="1890" y="375" /><di:waypoint x="1890" y="300" /><di:waypoint x="1960" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_17bmhz4_di" bpmnElement="Flow_17bmhz4"><di:waypoint x="1890" y="425" /><di:waypoint x="1890" y="490" /><di:waypoint x="1960" y="490" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0ncq8vz_di" bpmnElement="Flow_0ncq8vz"><di:waypoint x="1700" y="270" /><di:waypoint x="1790" y="270" /><di:waypoint x="1790" y="375" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_03dfm59_di" bpmnElement="Flow_03dfm59"><di:waypoint x="1700" y="540" /><di:waypoint x="1790" y="540" /><di:waypoint x="1790" y="425" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_01yztt8_di" bpmnElement="Flow_01yztt8"><di:waypoint x="1815" y="400" /><di:waypoint x="1865" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_08nnyxx_di" bpmnElement="Flow_08nnyxx"><di:waypoint x="1520" y="425" /><di:waypoint x="1520" y="540" /><di:waypoint x="1600" y="540" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_11qpsmk_di" bpmnElement="Flow_11qpsmk"><di:waypoint x="1520" y="375" /><di:waypoint x="1520" y="270" /><di:waypoint x="1600" y="270" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0lbrvum_di" bpmnElement="Flow_0lbrvum"><di:waypoint x="1700" y="400" /><di:waypoint x="1765" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1kjetjx_di" bpmnElement="Flow_1kjetjx"><di:waypoint x="1545" y="400" /><di:waypoint x="1600" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1bftx8y_di" bpmnElement="Flow_1bftx8y"><di:waypoint x="2060" y="490" /><di:waypoint x="2130" y="490" /><di:waypoint x="2130" y="425" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1o0hni4_di" bpmnElement="Flow_1o0hni4"><di:waypoint x="1350" y="540" /><di:waypoint x="1420" y="540" /><di:waypoint x="1420" y="425" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0it45xs_di" bpmnElement="Flow_0it45xs"><di:waypoint x="1350" y="270" /><di:waypoint x="1420" y="270" /><di:waypoint x="1420" y="375" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1fkh9i0_di" bpmnElement="Flow_1fkh9i0"><di:waypoint x="1110" y="400" /><di:waypoint x="1145" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_04lit63_di" bpmnElement="Flow_04lit63"><di:waypoint x="740" y="570" /><di:waypoint x="620" y="570" /><di:waypoint x="620" y="440" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_00zpxk7_di" bpmnElement="Flow_00zpxk7"><di:waypoint x="1445" y="400" /><di:waypoint x="1495" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_096nu3p_di" bpmnElement="Flow_096nu3p"><di:waypoint x="1195" y="270" /><di:waypoint x="1250" y="270" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1ggdmli_di" bpmnElement="Flow_1ggdmli"><di:waypoint x="1120" y="120" /><di:waypoint x="1030" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0fy399u_di" bpmnElement="Flow_0fy399u"><di:waypoint x="930" y="120" /><di:waypoint x="620" y="120" /><di:waypoint x="620" y="360" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1f1uolw_di" bpmnElement="Flow_1f1uolw"><di:waypoint x="1170" y="245" /><di:waypoint x="1170" y="160" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1r0gnio_di" bpmnElement="Flow_1r0gnio"><di:waypoint x="1195" y="540" /><di:waypoint x="1250" y="540" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1hekhfo_di" bpmnElement="Flow_1hekhfo"><di:waypoint x="1170" y="565" /><di:waypoint x="1170" y="690" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1fc43pe_di" bpmnElement="Flow_1fc43pe"><di:waypoint x="3700" y="200" /><di:waypoint x="3700" y="160" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1axzoy0_di" bpmnElement="Flow_1axzoy0"><di:waypoint x="1120" y="730" /><di:waypoint x="1030" y="730" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0t58wpg_di" bpmnElement="Flow_0t58wpg"><di:waypoint x="930" y="730" /><di:waypoint x="620" y="730" /><di:waypoint x="620" y="440" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_03ndiwc_di" bpmnElement="Flow_03ndiwc"><di:waypoint x="1170" y="375" /><di:waypoint x="1170" y="295" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0z68wk6_di" bpmnElement="Flow_0z68wk6"><di:waypoint x="1170" y="425" /><di:waypoint x="1170" y="515" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1ewf4db_di" bpmnElement="Flow_1ewf4db"><di:waypoint x="950" y="425" /><di:waypoint x="950" y="530" /><bpmndi:BPMNLabel><dc:Bounds x="873" y="461" width="73" height="40" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_02jibfx_di" bpmnElement="Flow_02jibfx"><di:waypoint x="900" y="570" /><di:waypoint x="840" y="570" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0p78z1x_di" bpmnElement="Flow_0p78z1x"><di:waypoint x="850" y="400" /><di:waypoint x="925" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_004imb2_di" bpmnElement="Flow_004imb2"><di:waypoint x="975" y="400" /><di:waypoint x="1010" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_15hhgcy_di" bpmnElement="Flow_15hhgcy"><di:waypoint x="3700" y="360" /><di:waypoint x="3700" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1lpjyl1_di" bpmnElement="Flow_1lpjyl1"><di:waypoint x="3750" y="400" /><di:waypoint x="3820" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0qri0z7_di" bpmnElement="Flow_0qri0z7"><di:waypoint x="3600" y="400" /><di:waypoint x="3650" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0aorocz_di" bpmnElement="Flow_0aorocz"><di:waypoint x="670" y="400" /><di:waypoint x="750" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0leu98n_di" bpmnElement="Flow_0leu98n"><di:waypoint x="350" y="400" /><di:waypoint x="375" y="400" /><di:waypoint x="375" y="280" /><di:waypoint x="400" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_15n8ayk_di" bpmnElement="Flow_15n8ayk"><di:waypoint x="5590" y="400" /><di:waypoint x="5640" y="400" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_049okmm_di" bpmnElement="SequenceFlow_049okmm"><di:waypoint x="5740" y="400" /><di:waypoint x="5782" y="400" /><bpmndi:BPMNLabel><dc:Bounds x="1026.5" y="99" width="0" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0or7jn6_di" bpmnElement="SequenceFlow_0or7jn6"><di:waypoint x="188" y="400" /><di:waypoint x="250" y="400" /><bpmndi:BPMNLabel><dc:Bounds x="228" y="114" width="90" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds x="152" y="382" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_0djl7a3_di" bpmnElement="EndEvent_0djl7a3"><dc:Bounds x="5782" y="382" width="36" height="36" /><bpmndi:BPMNLabel><dc:Bounds x="1064" y="142" width="90" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1ezl3om_di" bpmnElement="Task_1ujk4ck"><dc:Bounds x="5640" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1dmo7st_di" bpmnElement="Activity_1dmo7st"><dc:Bounds x="5490" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_19posc1_di" bpmnElement="Activity_19posc1"><dc:Bounds x="3500" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0nlvmfl_di" bpmnElement="Activity_0nlvmfl"><dc:Bounds x="3820" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0hk18j9_di" bpmnElement="Activity_0hk18j9"><dc:Bounds x="3650" y="200" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1qvpiyz_di" bpmnElement="Activity_1qvpiyz"><dc:Bounds x="250" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1gd43m3_di" bpmnElement="Activity_1gd43m3"><dc:Bounds x="570" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1fddfr0_di" bpmnElement="Activity_1fddfr0" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="3650" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_13m6clf_di" bpmnElement="Activity_13m6clf" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="2400" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_08hysbi_di" bpmnElement="Gateway_08hysbi" isMarkerVisible="true"><dc:Bounds x="925" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1uwqtdv_di" bpmnElement="Activity_1uwqtdv" bioc:stroke="black" bioc:fill="white"><dc:Bounds x="750" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_17fnlwv_di" bpmnElement="Activity_17fnlwv"><dc:Bounds x="900" y="530" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_0zjhsao_di" bpmnElement="Gateway_0zjhsao" isMarkerVisible="true"><dc:Bounds x="1145" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0ol1am8_di" bpmnElement="Activity_0ol1am8"><dc:Bounds x="1120" y="690" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1doq1ir_di" bpmnElement="Activity_1doq1ir"><dc:Bounds x="1120" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1irt4lf_di" bpmnElement="Activity_1irt4lf"><dc:Bounds x="930" y="690" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0eweprz_di" bpmnElement="Activity_0eweprz"><dc:Bounds x="3650" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_1ld042j_di" bpmnElement="Gateway_1ld042j" isMarkerVisible="true"><dc:Bounds x="1145" y="515" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_0l0agtc_di" bpmnElement="Gateway_0l0agtc" isMarkerVisible="true"><dc:Bounds x="1145" y="245" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1p2ai2y_di" bpmnElement="Activity_1p2ai2y"><dc:Bounds x="930" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_0fvkcm9_di" bpmnElement="Gateway_0fvkcm9" isMarkerVisible="true"><dc:Bounds x="1395" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1a4tqtv_di" bpmnElement="Activity_1a4tqtv"><dc:Bounds x="740" y="530" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0otacew_di" bpmnElement="Activity_0otacew"><dc:Bounds x="1010" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0kwmvui_di" bpmnElement="Activity_0kwmvui" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="4500" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_00kh6qi_di" bpmnElement="Activity_00kh6qi" bioc:stroke="black" bioc:fill="white"><dc:Bounds x="2850" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1ba90yl_di" bpmnElement="Activity_1ba90yl"><dc:Bounds x="3010" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_11rcb8j_di" bpmnElement="Activity_11rcb8j"><dc:Bounds x="1250" y="230" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_03f292o_di" bpmnElement="Activity_03f292o"><dc:Bounds x="1250" y="500" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_00qjq30_di" bpmnElement="Activity_00qjq30"><dc:Bounds x="1960" y="450" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_114x4fu_di" bpmnElement="Gateway_114x4fu" isMarkerVisible="true"><dc:Bounds x="1495" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_11qy6uv_di" bpmnElement="Activity_11qy6uv"><dc:Bounds x="1600" y="230" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0el6xln_di" bpmnElement="Activity_0el6xln"><dc:Bounds x="1600" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1dga9cb_di" bpmnElement="Activity_1dga9cb"><dc:Bounds x="1600" y="500" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_03nygfj_di" bpmnElement="Gateway_03nygfj" isMarkerVisible="true"><dc:Bounds x="1765" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_0tcspsm_di" bpmnElement="Gateway_0tcspsm" isMarkerVisible="true"><dc:Bounds x="1865" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0229g2c_di" bpmnElement="Activity_0229g2c"><dc:Bounds x="1960" y="260" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_1bw3g9g_di" bpmnElement="Gateway_1bw3g9g" isMarkerVisible="true"><dc:Bounds x="2105" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_01yibxp_di" bpmnElement="Activity_01yibxp" bioc:stroke="black" bioc:fill="white"><dc:Bounds x="400" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0rs1vs5_di" bpmnElement="Activity_0rs1vs5"><dc:Bounds x="2690" y="640" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Event_0gcmwg7_di" bpmnElement="Event_0gcmwg7"><dc:Bounds x="2722" y="872" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_16xvx1a_di" bpmnElement="Activity_16xvx1a"><dc:Bounds x="2690" y="760" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_1fqt24v_di" bpmnElement="Gateway_1fqt24v" isMarkerVisible="true"><dc:Bounds x="2715" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0ew7w8m_di" bpmnElement="Activity_0ew7w8m" bioc:stroke="black" bioc:fill="white"><dc:Bounds x="3340" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1aaqt96_di" bpmnElement="Activity_1aaqt96"><dc:Bounds x="3180" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_10kioj7_di" bpmnElement="Activity_10kioj7"><dc:Bounds x="3340" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_0f79g2p_di" bpmnElement="Gateway_0f79g2p" isMarkerVisible="true"><dc:Bounds x="4695" y="375" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1gwcpsh_di" bpmnElement="Activity_1gwcpsh" bioc:stroke="black" bioc:fill="white"><dc:Bounds x="4840" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0w0y1v8_di" bpmnElement="Activity_0w0y1v8"><dc:Bounds x="5000" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1dh4ogt_di" bpmnElement="Activity_1dh4ogt"><dc:Bounds x="5160" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0fza31u_di" bpmnElement="Activity_0fza31u"><dc:Bounds x="3010" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1gvry0e_di" bpmnElement="Activity_1gvry0e" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="2690" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0k9dl3m_di" bpmnElement="Activity_0k9dl3m"><dc:Bounds x="3180" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1fdtt7j_di" bpmnElement="Activity_1fdtt7j" bioc:stroke="black" bioc:fill="white"><dc:Bounds x="3990" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_13k65ym_di" bpmnElement="Activity_13k65ym"><dc:Bounds x="4150" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1vry2o9_di" bpmnElement="Activity_1vry2o9"><dc:Bounds x="4320" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1eqyuml_di" bpmnElement="Activity_1eqyuml"><dc:Bounds x="5330" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_14x27xj_di" bpmnElement="Activity_14x27xj"><dc:Bounds x="3500" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1s90w3u_di" bpmnElement="Activity_1s90w3u"><dc:Bounds x="2690" y="520" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0inf0bs_di" bpmnElement="Activity_0inf0bs"><dc:Bounds x="4670" y="640" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Event_05p7omp_di" bpmnElement="Event_05p7omp"><dc:Bounds x="4702" y="872" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_09w44ne_di" bpmnElement="Activity_09w44ne"><dc:Bounds x="4670" y="760" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_08oj2u0_di" bpmnElement="Activity_08oj2u0"><dc:Bounds x="4670" y="530" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_19kiaac_di" bpmnElement="Activity_19kiaac"><dc:Bounds x="2850" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_03zpxco_di" bpmnElement="Activity_03zpxco"><dc:Bounds x="2220" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_156rzg2_di" bpmnElement="Activity_156rzg2"><dc:Bounds x="2560" y="360" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_1argcnj_di" bpmnElement="Activity_1argcnj"><dc:Bounds x="2690" y="220" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_10e5shl_di" bpmnElement="Activity_10e5shl" bioc:stroke="black" bioc:fill="white"><dc:Bounds x="400" y="240" width="100" height="80" /></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>