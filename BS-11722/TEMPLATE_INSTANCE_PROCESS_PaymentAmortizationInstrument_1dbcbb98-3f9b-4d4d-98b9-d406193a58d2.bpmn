<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.4.1"><bpmn:process id="TEMPLATE_INSTANCE_PROCESS_PaymentAmortizationInstrument_1dbcbb98-3f9b-4d4d-98b9-d406193a58d2" name="Выплата амортизации по инструменту" isExecutable="true"><bpmn:documentation /><bpmn:startEvent id="StartEvent_1xjczg5"><bpmn:outgoing>SequenceFlow_0pr84yj</bpmn:outgoing></bpmn:startEvent><bpmn:endEvent id="EndEvent_0wpfl50"><bpmn:incoming>SequenceFlow_0q0oy70</bpmn:incoming></bpmn:endEvent><bpmn:serviceTask id="ServiceTask_1l1eld8" name="Статус Подтверждено"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Подтверждено</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1jhjz0t</bpmn:incoming><bpmn:outgoing>SequenceFlow_10no950</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0buh97r" name="Получить значение из объекта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "enrichment",
    "filter": {
        "_id": ObjectId("${instanceId}")
    },
    "projection": {
        "attributes.AssetFlows___lkupClient___ValueDisplayed": 1
    }
}</camunda:inputParameter><camunda:outputParameter name="clientPrimaryId"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.AssetFlows___lkupClient___ValueDisplayed.primaryId</camunda:script></camunda:outputParameter><camunda:outputParameter name="clientSource"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.AssetFlows___lkupClient___ValueDisplayed.source</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0hnst7f</bpmn:incoming><bpmn:outgoing>SequenceFlow_1cck70r</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0bx8tw1" name="Сохранить значение из связанного объекта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
 "hlk_app_id": "${clientPrimaryId}"
}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1cck70r</bpmn:incoming><bpmn:outgoing>SequenceFlow_0bxz0z3</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_05ff5n6" name="Получить номер обязательства"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttribute/AssetFlows___txtID___ValueDisplayed</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="payload" /><camunda:outputParameter name="assetflowid">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_19g7sen</bpmn:incoming><bpmn:outgoing>SequenceFlow_02tqrmg</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0opqfwn" name="Формируем отчёт"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/report-service/generate-report-save/by-name?name=CouponTicketReport</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">[
	{
		"displayName": "Номер заказа",
		"name": "FlowId",
		"value":  "${assetflowid}"
	}
]</camunda:inputParameter><camunda:outputParameter name="generated">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_02tqrmg</bpmn:incoming><bpmn:outgoing>SequenceFlow_0vfqor6</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0ndsgbj" name="Привязываем отчёт к обязательству"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/file/create/ENRICHMENT/${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="payload">${generated}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0vfqor6</bpmn:incoming><bpmn:outgoing>SequenceFlow_1kgdcyf</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_0e867z9" default="SequenceFlow_1fbwe6o"><bpmn:incoming>SequenceFlow_1d255he</bpmn:incoming><bpmn:outgoing>SequenceFlow_0sg4bwt</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1fbwe6o</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_0tb7agh" name="Получение курса валюты"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${msUrl}/api/FXRates?ccyCode1=${ccy}&amp;ccyCode2=KZT&amp;rateSet=NBRK&amp;dateHist=${date.substring(0,10)}</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="rate">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1fbwe6o</bpmn:incoming><bpmn:outgoing>SequenceFlow_0nge99t</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_17wpqv6" name="Получение данных из объекта для расчета суммы в KZT"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttributes?systemName=AssetFlows___lkupAsset___ValueDisplayed&amp;systemName=AssetFlows___txtQtyPcs___Value&amp;systemName=AssetFlows___dateFlowDate___ValueDisplayed</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="ccy"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___lkupAsset___ValueDisplayed</camunda:script></camunda:outputParameter><camunda:outputParameter name="amount"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___txtQtyPcs___Value</camunda:script></camunda:outputParameter><camunda:outputParameter name="date"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___dateFlowDate___ValueDisplayed</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0cb628w</bpmn:incoming><bpmn:outgoing>SequenceFlow_1d255he</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_12d1jon" name="Расчет суммы в валюте KZT" camunda:expression="${amount * rate}" camunda:resultVariable="amount"><bpmn:incoming>SequenceFlow_0nge99t</bpmn:incoming><bpmn:outgoing>SequenceFlow_19p14z2</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0forhta" name="Сохранение суммы в KZT"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{"amountKZT": ${amount}}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0sg4bwt</bpmn:incoming><bpmn:incoming>SequenceFlow_19p14z2</bpmn:incoming><bpmn:outgoing>SequenceFlow_1jhjz0t</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_10q57k3" name="Статус Новая"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Новая</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0pr84yj</bpmn:incoming><bpmn:outgoing>SequenceFlow_0hnst7f</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0w9pwdj" name="Найти связанный объект клиент"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "${clientSource}",
    "filter": {
        "primaryId": "${clientPrimaryId}",
		"activityStatus": "ACTIVE"
    },
    "projection": {
        "attributes.hlk_app_id": 1
    }
}</camunda:inputParameter><camunda:outputParameter name="hlk_app_id"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.hlk_app_id</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0jddbw2" name="Получение данных из объекта для счета"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttributes?systemName=AssetFlows___lkupAsset___ValueDisplayed&amp;systemName=AssetFlows___lkupCS___ValueDisplayed&amp;systemName=AssetFlows___dateFlowDate___ValueDisplayed</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="ccyCS"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___lkupAsset___ValueDisplayed</camunda:script></camunda:outputParameter><camunda:outputParameter name="CS"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___lkupCS___ValueDisplayed</camunda:script></camunda:outputParameter><camunda:outputParameter name="date"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___dateFlowDate___ValueDisplayed</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0bxz0z3</bpmn:incoming><bpmn:outgoing>SequenceFlow_0aknbzm</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0zguqai" name="Найти cчет, попадающий под условия"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "invoice",
    "filter": {
        "templatePrimaryId": "5d9af8742ab79c000a9a05c5",
		"attributes.hlk_account_type": "Денежный",   
        "attributes.hlk_account_currency": "${ccyCS}", 
   "attributes.hlk_account_owner.primaryId": "${clientPrimaryId}",
    "attributes.hlk_clearing_system.value": "${CS.replaceAll("\"", "\\\\\\\"")}",
		"activityStatus": "ACTIVE"
    },
    "projection": {
        "attributes.hlk_Account_Number": 1
"primaryId":1
    }
}</camunda:inputParameter><camunda:outputParameter name="hlk_Account_Number"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0].attributes.hlk_Account_Number;
} catch(e) {
"";
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="hlk_Account_Number_primaryId"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].primaryId</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0ru2ej3</bpmn:incoming><bpmn:incoming>SequenceFlow_1ey996l</bpmn:incoming><bpmn:outgoing>SequenceFlow_0ur62pz</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_14gbsho" default="SequenceFlow_0ru2ej3"><bpmn:incoming>SequenceFlow_0aknbzm</bpmn:incoming><bpmn:outgoing>SequenceFlow_0ru2ej3</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1hm05kv</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_0d5q1cr" name="Изменить валюту с RUR на RUB" camunda:expression="RUB" camunda:resultVariable="ccyCS"><bpmn:incoming>SequenceFlow_1hm05kv</bpmn:incoming><bpmn:outgoing>SequenceFlow_1ey996l</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_06zdq0z" name="создание обязательств"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/sendInstanceTo/ENRICHMENT_OBLIGATION/${instanceId}?AssetFlows___radioFactPlan___ValueDisplayed=План</camunda:inputParameter><camunda:inputParameter name="payload">{
}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0rpx6uo</bpmn:incoming><bpmn:outgoing>SequenceFlow_0w7kgf3</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0mtl33w" name="Сохранить номер счета"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
"AssetFlows___lkupBOAccountNumber___ValueDisplayed" : {
"value" : "${hlk_Account_Number}",
"primaryId" : "${hlk_Account_Number_primaryId}",
"source" : "invoice",
"_class" : "egar.ezdoc.model.entity.attribute.DictionaryValue"
}
}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0ur62pz</bpmn:incoming><bpmn:outgoing>SequenceFlow_0rpx6uo</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1lro8zi" name="Поиск обязательства"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/obligations/one/by-attribute?name=AssetflowID&amp;value=51</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="OutputCash">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_10no950</bpmn:incoming><bpmn:outgoing>SequenceFlow_0k49h91</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0401pf9" name="Создание фактов"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment-obligation/fact/${OutputCash}?AssetFlows___radioFactPlan___ValueDisplayed=Факт&amp;AssetFlows___dateFlowDate___ValueDisplayed=${Date_fact_payment}&amp;AssetFlows___txtQtyPcs___Value=${AssetFlows___txtQtyPcs___Value}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0k49h91</bpmn:incoming><bpmn:outgoing>SequenceFlow_19g7sen</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0gsggat" name="Статус Заполнение:Дата фактической выплаты"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Заполнение:+Дата+фактической+выплаты</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0pr84yj" sourceRef="StartEvent_1xjczg5" targetRef="ServiceTask_10q57k3" /><bpmn:sequenceFlow id="SequenceFlow_1kgdcyf" sourceRef="ServiceTask_0ndsgbj" targetRef="ExclusiveGateway_02rvq9w" /><bpmn:sequenceFlow id="SequenceFlow_1jhjz0t" sourceRef="ServiceTask_0forhta" targetRef="ServiceTask_1l1eld8" /><bpmn:sequenceFlow id="SequenceFlow_10no950" sourceRef="ServiceTask_1l1eld8" targetRef="ServiceTask_1lro8zi" /><bpmn:sequenceFlow id="SequenceFlow_0hnst7f" sourceRef="ServiceTask_10q57k3" targetRef="ServiceTask_0buh97r" /><bpmn:sequenceFlow id="SequenceFlow_1cck70r" sourceRef="ServiceTask_0buh97r" targetRef="ServiceTask_0bx8tw1" /><bpmn:sequenceFlow id="SequenceFlow_0bxz0z3" sourceRef="ServiceTask_0bx8tw1" targetRef="ServiceTask_0jddbw2" /><bpmn:sequenceFlow id="SequenceFlow_19g7sen" sourceRef="ServiceTask_0401pf9" targetRef="ServiceTask_05ff5n6" /><bpmn:sequenceFlow id="SequenceFlow_02tqrmg" sourceRef="ServiceTask_05ff5n6" targetRef="ServiceTask_0opqfwn" /><bpmn:sequenceFlow id="SequenceFlow_0vfqor6" sourceRef="ServiceTask_0opqfwn" targetRef="ServiceTask_0ndsgbj" /><bpmn:sequenceFlow id="SequenceFlow_1d255he" sourceRef="ServiceTask_17wpqv6" targetRef="ExclusiveGateway_0e867z9" /><bpmn:sequenceFlow id="SequenceFlow_0sg4bwt" sourceRef="ExclusiveGateway_0e867z9" targetRef="ServiceTask_0forhta"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"KZT".equals(ccy)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1fbwe6o" sourceRef="ExclusiveGateway_0e867z9" targetRef="ServiceTask_0tb7agh" /><bpmn:sequenceFlow id="SequenceFlow_0nge99t" sourceRef="ServiceTask_0tb7agh" targetRef="ServiceTask_12d1jon" /><bpmn:sequenceFlow id="SequenceFlow_19p14z2" sourceRef="ServiceTask_12d1jon" targetRef="ServiceTask_0forhta" /><bpmn:sequenceFlow id="SequenceFlow_0aknbzm" sourceRef="ServiceTask_0jddbw2" targetRef="ExclusiveGateway_14gbsho" /><bpmn:sequenceFlow id="SequenceFlow_0ru2ej3" sourceRef="ExclusiveGateway_14gbsho" targetRef="ServiceTask_0zguqai" /><bpmn:sequenceFlow id="SequenceFlow_1ey996l" sourceRef="ServiceTask_0d5q1cr" targetRef="ServiceTask_0zguqai" /><bpmn:sequenceFlow id="SequenceFlow_0ur62pz" sourceRef="ServiceTask_0zguqai" targetRef="ServiceTask_0mtl33w" /><bpmn:sequenceFlow id="SequenceFlow_1hm05kv" sourceRef="ExclusiveGateway_14gbsho" targetRef="ServiceTask_0d5q1cr"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"RUR".equals(ccyCS)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_0rpx6uo" sourceRef="ServiceTask_0mtl33w" targetRef="ServiceTask_06zdq0z" /><bpmn:sequenceFlow id="SequenceFlow_0k49h91" sourceRef="ServiceTask_1lro8zi" targetRef="ServiceTask_0401pf9" /><bpmn:subProcess id="SubProcess_14ypmmq"><bpmn:incoming>SequenceFlow_0t09t9y</bpmn:incoming><bpmn:outgoing>SequenceFlow_0cb628w</bpmn:outgoing><bpmn:startEvent id="StartEvent_1imbnb2"><bpmn:outgoing>SequenceFlow_0sf53u2</bpmn:outgoing></bpmn:startEvent><bpmn:userTask id="UserTask_058o7u2" name="Заполнение поля Дата факта и Количество актива" camunda:formKey="FILL" camunda:candidateGroups="jira-users,cb_backoffice"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="fillverify" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="Date_fact_payment" label="Corp. Дата фактической выплаты" type="string" /><camunda:formField id="AssetFlows___txtQtyPcs___Value" label="Corp. Количество актива" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1ov3db5</bpmn:incoming><bpmn:incoming>SequenceFlow_1g2n4su</bpmn:incoming><bpmn:incoming>SequenceFlow_1lv44bm</bpmn:incoming><bpmn:incoming>SequenceFlow_118d0i3</bpmn:incoming><bpmn:outgoing>SequenceFlow_1ti2u7a</bpmn:outgoing></bpmn:userTask><bpmn:exclusiveGateway id="ExclusiveGateway_0644zow" default="SequenceFlow_16c5pwe"><bpmn:incoming>SequenceFlow_157weul</bpmn:incoming><bpmn:outgoing>SequenceFlow_16c5pwe</bpmn:outgoing><bpmn:outgoing>SequenceFlow_06rctd2</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_1wz4m97" name="Статус заявки &#34;Дата факта не указана&#34;"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Дата+фактической+выплаты+не+указана</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_06rctd2</bpmn:incoming><bpmn:outgoing>SequenceFlow_1lv44bm</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0ybacv2" name="Статус заявки &#34;Дата факта &#62; TODAY&#34;"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Дата+фактической+выплаты+больше+текущей+даты</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1fcbwyz</bpmn:incoming><bpmn:outgoing>SequenceFlow_1g2n4su</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_18corv1" name="Получаем modifyDate"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="payload">{
	"find": "enrichment",
	"filter": {
	"_id" : ObjectId("${instanceId}")
	},
	"projection": {
		"modifyDate": 1
	}
}</camunda:inputParameter><camunda:outputParameter name="modifyDate"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].modifyDate</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_16c5pwe</bpmn:incoming><bpmn:outgoing>SequenceFlow_0tvtvnn</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_0x8zqvr" default="SequenceFlow_0kmmj31"><bpmn:incoming>SequenceFlow_0tvtvnn</bpmn:incoming><bpmn:outgoing>SequenceFlow_0kmmj31</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1fcbwyz</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1qod5bp</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_1ygfbwk" name="Статус Подтверждение заявки" camunda:expression="${&#34;Подтверждение заявки&#34;}" camunda:resultVariable="labelStatus"><bpmn:incoming>SequenceFlow_0kmmj31</bpmn:incoming><bpmn:outgoing>SequenceFlow_1a72ikq</bpmn:outgoing></bpmn:serviceTask><bpmn:userTask id="UserTask_0hw7p6v" name="Подтверждение заявки" camunda:assignee="${initiator}" camunda:candidateGroups="jira-users,cb_backoffice"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;:&#34;Accept&#34;,&#34;label&#34;:&#34;Подтвердить&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1a72ikq</bpmn:incoming><bpmn:outgoing>SequenceFlow_1mszrjf</bpmn:outgoing></bpmn:userTask><bpmn:parallelGateway id="ParallelGateway_18oka5e"><bpmn:incoming>SequenceFlow_0sf53u2</bpmn:incoming><bpmn:outgoing>SequenceFlow_0tx936q</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1ov3db5</bpmn:outgoing></bpmn:parallelGateway><bpmn:receiveTask id="ReceiveTask_1x3x2qd" messageRef="Message_1j8sudo"><bpmn:incoming>SequenceFlow_0s37hbe</bpmn:incoming><bpmn:outgoing>SequenceFlow_1fbudh0</bpmn:outgoing></bpmn:receiveTask><bpmn:endEvent id="EndEvent_019ia1a"><bpmn:incoming>SequenceFlow_1mszrjf</bpmn:incoming><bpmn:terminateEventDefinition id="TerminateEventDefinition_0l8wgwc" /></bpmn:endEvent><bpmn:endEvent id="EndEvent_0fna8dy"><bpmn:incoming>SequenceFlow_136zzgf</bpmn:incoming><bpmn:terminateEventDefinition id="TerminateEventDefinition_1us7bzc" /></bpmn:endEvent><bpmn:serviceTask id="ServiceTask_170af35" name="Сохранение  даты факта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{"Date_fact_payment": "${Date_fact_payment}"}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1fbudh0</bpmn:incoming><bpmn:outgoing>SequenceFlow_1lhlrf0</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1r5hosh" name="Статус Подтверждение заявки" camunda:expression="${&#34;Подтверждение заявки&#34;}" camunda:resultVariable="labelStatus"><bpmn:incoming>SequenceFlow_0tx936q</bpmn:incoming><bpmn:outgoing>SequenceFlow_03c08e3</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_03c08e3" sourceRef="ServiceTask_1r5hosh" targetRef="ServiceTask_0aphjs7" /><bpmn:sequenceFlow id="SequenceFlow_1fbudh0" sourceRef="ReceiveTask_1x3x2qd" targetRef="ServiceTask_170af35" /><bpmn:sequenceFlow id="SequenceFlow_1lhlrf0" sourceRef="ServiceTask_170af35" targetRef="ServiceTask_10whw29" /><bpmn:sequenceFlow id="SequenceFlow_1mszrjf" sourceRef="UserTask_0hw7p6v" targetRef="EndEvent_019ia1a" /><bpmn:sequenceFlow id="SequenceFlow_0tx936q" sourceRef="ParallelGateway_18oka5e" targetRef="ServiceTask_1r5hosh" /><bpmn:sequenceFlow id="SequenceFlow_1ov3db5" sourceRef="ParallelGateway_18oka5e" targetRef="UserTask_058o7u2" /><bpmn:sequenceFlow id="SequenceFlow_0sf53u2" sourceRef="StartEvent_1imbnb2" targetRef="ParallelGateway_18oka5e" /><bpmn:sequenceFlow id="SequenceFlow_1a72ikq" sourceRef="ServiceTask_1ygfbwk" targetRef="UserTask_0hw7p6v" /><bpmn:sequenceFlow id="SequenceFlow_0kmmj31" sourceRef="ExclusiveGateway_0x8zqvr" targetRef="ServiceTask_1ygfbwk" /><bpmn:sequenceFlow id="SequenceFlow_0tvtvnn" sourceRef="ServiceTask_18corv1" targetRef="ExclusiveGateway_0x8zqvr" /><bpmn:sequenceFlow id="SequenceFlow_1fcbwyz" sourceRef="ExclusiveGateway_0x8zqvr" targetRef="ServiceTask_0ybacv2"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${(Date_fact_payment &gt; modifyDate)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_16c5pwe" sourceRef="ExclusiveGateway_0644zow" targetRef="ServiceTask_18corv1" /><bpmn:sequenceFlow id="SequenceFlow_06rctd2" sourceRef="ExclusiveGateway_0644zow" targetRef="ServiceTask_1wz4m97"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${( Date_fact_payment ==null )||( Date_fact_payment   =="")}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1ti2u7a" sourceRef="UserTask_058o7u2" targetRef="ServiceTask_1k9bsz2" /><bpmn:sequenceFlow id="SequenceFlow_1g2n4su" sourceRef="ServiceTask_0ybacv2" targetRef="UserTask_058o7u2" /><bpmn:sequenceFlow id="SequenceFlow_1lv44bm" sourceRef="ServiceTask_1wz4m97" targetRef="UserTask_058o7u2" /><bpmn:serviceTask id="ServiceTask_0733ahl" name="Статус заявки &#34;Сумма фактического исполнения не может быть больше плановой&#34;"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Сумма+фактического+исполнения+не+может+быть+больше+плановой</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1qod5bp</bpmn:incoming><bpmn:outgoing>SequenceFlow_118d0i3</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1qod5bp" sourceRef="ExclusiveGateway_0x8zqvr" targetRef="ServiceTask_0733ahl"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${(AssetFlows___txtQtyPcs___Value &gt; hlk_plan_qty)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_118d0i3" sourceRef="ServiceTask_0733ahl" targetRef="UserTask_058o7u2" /><bpmn:serviceTask id="ServiceTask_1k9bsz2" name="Получение поля Дата факта и Количества"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
	"find": "enrichment",
	"filter": {
	"_id" : ObjectId("${instanceId}")
	},
	"projection": {
		"attributes.Date_fact_payment": 1
"attributes.AssetFlows___txtQtyPcs___Value": 1
"attributes.hlk_plan_qty": 1
	}
}</camunda:inputParameter><camunda:outputParameter name="Date_fact_payment"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.Date_fact_payment</camunda:script></camunda:outputParameter><camunda:outputParameter name="AssetFlows___txtQtyPcs___Value"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.AssetFlows___txtQtyPcs___Value</camunda:script></camunda:outputParameter><camunda:outputParameter name="hlk_plan_qty"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.hlk_plan_qty</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1ti2u7a</bpmn:incoming><bpmn:outgoing>SequenceFlow_157weul</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_157weul" sourceRef="ServiceTask_1k9bsz2" targetRef="ExclusiveGateway_0644zow" /><bpmn:serviceTask id="ServiceTask_0aphjs7" name="Получить данные с форма: дата плана, инструмент, тип"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttributes?systemName=AssetFlows___dateFlowDate___ValueDisplayed&amp;systemName=AssetFlows___lkupFlowType___ValueDisplayed&amp;systemName=AssetFlows___lkupCorpEventAsset___ValueDisplayed&amp;systemName=AssetFlows___txtQtyPcs___Value</camunda:inputParameter><camunda:outputParameter name="AssetFlows___dateFlowDate___ValueDisplayed"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___dateFlowDate___ValueDisplayed.substring(0, 10)</camunda:script></camunda:outputParameter><camunda:outputParameter name="AssetFlows___lkupFlowType___ValueDisplayed">${S(response).prop('AssetFlows___lkupFlowType___ValueDisplayed').stringValue()}</camunda:outputParameter><camunda:outputParameter name="AssetFlows___lkupCorpEventAsset___ValueDisplayed">${S(response).prop('AssetFlows___lkupCorpEventAsset___ValueDisplayed').stringValue()}</camunda:outputParameter><camunda:outputParameter name="AssetFlows___txtQtyPcs___Value"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___txtQtyPcs___Value</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_03c08e3</bpmn:incoming><bpmn:outgoing>SequenceFlow_0s37hbe</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0s37hbe" sourceRef="ServiceTask_0aphjs7" targetRef="ReceiveTask_1x3x2qd" /><bpmn:serviceTask id="ServiceTask_10whw29" name="Получение поля Дата факта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
	"find": "enrichment",
	"filter": {
	"_id" : ObjectId("${instanceId}")
	},
	"projection": {
		"attributes.Date_fact_payment": 1
	}
}</camunda:inputParameter><camunda:outputParameter name="Date_fact_payment"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.Date_fact_payment</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1lhlrf0</bpmn:incoming><bpmn:outgoing>SequenceFlow_136zzgf</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_136zzgf" sourceRef="ServiceTask_10whw29" targetRef="EndEvent_0fna8dy" /></bpmn:subProcess><bpmn:sequenceFlow id="SequenceFlow_0w7kgf3" sourceRef="ServiceTask_06zdq0z" targetRef="ServiceTask_1wsrvgv" /><bpmn:sequenceFlow id="SequenceFlow_0cb628w" sourceRef="SubProcess_14ypmmq" targetRef="ServiceTask_17wpqv6" /><bpmn:serviceTask id="ServiceTask_1wsrvgv" name="Получение количества"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttribute/AssetFlows___txtQtyPcs___Value</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="qty">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0w7kgf3</bpmn:incoming><bpmn:outgoing>SequenceFlow_0muer96</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1w8dgot" name="Сохранить количество в тех параметры"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{"hlk_plan_qty": "${qty}"}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0muer96</bpmn:incoming><bpmn:outgoing>SequenceFlow_0t09t9y</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0muer96" sourceRef="ServiceTask_1wsrvgv" targetRef="ServiceTask_1w8dgot" /><bpmn:sequenceFlow id="SequenceFlow_0t09t9y" sourceRef="ServiceTask_1w8dgot" targetRef="SubProcess_14ypmmq" /><bpmn:exclusiveGateway id="ExclusiveGateway_02rvq9w" default="SequenceFlow_1gnuocu"><bpmn:incoming>SequenceFlow_1kgdcyf</bpmn:incoming><bpmn:outgoing>SequenceFlow_1gnuocu</bpmn:outgoing><bpmn:outgoing>SequenceFlow_05hkq7b</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:exclusiveGateway id="ExclusiveGateway_1a6v1pu"><bpmn:incoming>SequenceFlow_08264my</bpmn:incoming><bpmn:incoming>SequenceFlow_0k0sfjl</bpmn:incoming><bpmn:outgoing>SequenceFlow_0us3r2h</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_01uygxl" name="ФЗ. Получаем почту клиента"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="payload">{
  "aggregate": "individualPerson",
  "pipeline": [
    {
      "$match": {
        "actual": true,
        "status": "VERIFICATED",
        "primaryId": "${clientPrimaryId}",
      }
    },
    {
      "$project": {
        "hlk_email": { "$ifNull": ["$attributes.hlk_email", null]},
        "_id": 0
      }
    }
  ],
  "cursor": {
    "batchSize": 10000
  },
  "allowDiskUse": true
}</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:outputParameter name="Email"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].hlk_email</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1gnuocu</bpmn:incoming><bpmn:outgoing>SequenceFlow_0k0sfjl</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0ughzl1" name="ЮЛ. Получаем почту клиента"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="payload">{
  "aggregate": "legalEntity",
  "pipeline": [
    {
      "$match": {
        "actual": true,
        "status": "VERIFICATED",
        "primaryId": "${clientPrimaryId}",
      }
    },
    {
      "$project": {
        "hlk_email": { "$ifNull": ["$attributes.hlk_email", null]},
        "_id": 0
      }
    }
  ],
  "cursor": {
    "batchSize": 10000
  },
  "allowDiskUse": true
}</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:outputParameter name="Email"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].hlk_email</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_05hkq7b</bpmn:incoming><bpmn:outgoing>SequenceFlow_08264my</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1fuqsyv" name="Отправляем отчёт клиенту"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/email/send</camunda:inputParameter><camunda:inputParameter name="payload">{
"email":"${Email}",
"subject":"Отчёт о зачислении суммы вознаграждения/погашения по финансовым инструментам",
"text":"",
"attachments": ["${generated}"]
}</camunda:inputParameter><camunda:outputParameter name="errorMessage">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0us3r2h</bpmn:incoming><bpmn:outgoing>SequenceFlow_0q0oy70</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1gnuocu" sourceRef="ExclusiveGateway_02rvq9w" targetRef="ServiceTask_01uygxl" /><bpmn:sequenceFlow id="SequenceFlow_05hkq7b" sourceRef="ExclusiveGateway_02rvq9w" targetRef="ServiceTask_0ughzl1"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${clientSource == 'legalEntity'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_08264my" sourceRef="ServiceTask_0ughzl1" targetRef="ExclusiveGateway_1a6v1pu" /><bpmn:sequenceFlow id="SequenceFlow_0k0sfjl" sourceRef="ServiceTask_01uygxl" targetRef="ExclusiveGateway_1a6v1pu" /><bpmn:sequenceFlow id="SequenceFlow_0us3r2h" sourceRef="ExclusiveGateway_1a6v1pu" targetRef="ServiceTask_1fuqsyv" /><bpmn:sequenceFlow id="SequenceFlow_0q0oy70" sourceRef="ServiceTask_1fuqsyv" targetRef="EndEvent_0wpfl50" /></bpmn:process><bpmn:message id="Message_1j8sudo" name="confirmPayment" /><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="TEMPLATE_INSTANCE_PROCESS_PaymentAmortizationInstrument_1dbcbb98-3f9b-4d4d-98b9-d406193a58d2"><bpmndi:BPMNEdge id="SequenceFlow_0q0oy70_di" bpmnElement="SequenceFlow_0q0oy70"><di:waypoint x="5220" y="280" /><di:waypoint x="5252" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0us3r2h_di" bpmnElement="SequenceFlow_0us3r2h"><di:waypoint x="5095" y="280" /><di:waypoint x="5120" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0k0sfjl_di" bpmnElement="SequenceFlow_0k0sfjl"><di:waypoint x="5020" y="230" /><di:waypoint x="5070" y="230" /><di:waypoint x="5070" y="255" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_08264my_di" bpmnElement="SequenceFlow_08264my"><di:waypoint x="5020" y="340" /><di:waypoint x="5070" y="340" /><di:waypoint x="5070" y="305" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_05hkq7b_di" bpmnElement="SequenceFlow_05hkq7b"><di:waypoint x="4870" y="305" /><di:waypoint x="4870" y="340" /><di:waypoint x="4920" y="340" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1gnuocu_di" bpmnElement="SequenceFlow_1gnuocu"><di:waypoint x="4870" y="255" /><di:waypoint x="4870" y="230" /><di:waypoint x="4920" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0t09t9y_di" bpmnElement="SequenceFlow_0t09t9y"><di:waypoint x="1550" y="290" /><di:waypoint x="1590" y="290" /><di:waypoint x="1590" y="471" /><di:waypoint x="1752" y="471" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0muer96_di" bpmnElement="SequenceFlow_0muer96"><di:waypoint x="1420" y="290" /><di:waypoint x="1450" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0cb628w_di" bpmnElement="SequenceFlow_0cb628w"><di:waypoint x="3466" y="471" /><di:waypoint x="3484" y="471" /><di:waypoint x="3484" y="280" /><di:waypoint x="3502" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0w7kgf3_di" bpmnElement="SequenceFlow_0w7kgf3"><di:waypoint x="1300" y="290" /><di:waypoint x="1320" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0k49h91_di" bpmnElement="SequenceFlow_0k49h91"><di:waypoint x="4283" y="280" /><di:waypoint x="4328" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0rpx6uo_di" bpmnElement="SequenceFlow_0rpx6uo"><di:waypoint x="1170" y="290" /><di:waypoint x="1200" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1hm05kv_di" bpmnElement="SequenceFlow_1hm05kv"><di:waypoint x="785" y="290" /><di:waypoint x="810" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0ur62pz_di" bpmnElement="SequenceFlow_0ur62pz"><di:waypoint x="1040" y="290" /><di:waypoint x="1070" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ey996l_di" bpmnElement="SequenceFlow_1ey996l"><di:waypoint x="910" y="290" /><di:waypoint x="940" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0ru2ej3_di" bpmnElement="SequenceFlow_0ru2ej3"><di:waypoint x="760" y="315" /><di:waypoint x="760" y="390" /><di:waypoint x="990" y="390" /><di:waypoint x="990" y="330" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0aknbzm_di" bpmnElement="SequenceFlow_0aknbzm"><di:waypoint x="700" y="290" /><di:waypoint x="735" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_19p14z2_di" bpmnElement="SequenceFlow_19p14z2"><di:waypoint x="3932" y="382" /><di:waypoint x="3972" y="382" /><di:waypoint x="3972" y="320" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0nge99t_di" bpmnElement="SequenceFlow_0nge99t"><di:waypoint x="3792" y="382" /><di:waypoint x="3832" y="382" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1fbwe6o_di" bpmnElement="SequenceFlow_1fbwe6o"><di:waypoint x="3662" y="305" /><di:waypoint x="3662" y="389" /><di:waypoint x="3692" y="389" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0sg4bwt_di" bpmnElement="SequenceFlow_0sg4bwt"><di:waypoint x="3687" y="280" /><di:waypoint x="3922" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1d255he_di" bpmnElement="SequenceFlow_1d255he"><di:waypoint x="3602" y="280" /><di:waypoint x="3637" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0vfqor6_di" bpmnElement="SequenceFlow_0vfqor6"><di:waypoint x="4690" y="280" /><di:waypoint x="4720" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_02tqrmg_di" bpmnElement="SequenceFlow_02tqrmg"><di:waypoint x="4570" y="280" /><di:waypoint x="4590" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_19g7sen_di" bpmnElement="SequenceFlow_19g7sen"><di:waypoint x="4428" y="280" /><di:waypoint x="4470" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0bxz0z3_di" bpmnElement="SequenceFlow_0bxz0z3"><di:waypoint x="570" y="290" /><di:waypoint x="600" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1cck70r_di" bpmnElement="SequenceFlow_1cck70r"><di:waypoint x="440" y="290" /><di:waypoint x="470" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0hnst7f_di" bpmnElement="SequenceFlow_0hnst7f"><di:waypoint x="310" y="290" /><di:waypoint x="340" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_10no950_di" bpmnElement="SequenceFlow_10no950"><di:waypoint x="4150" y="280" /><di:waypoint x="4183" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1jhjz0t_di" bpmnElement="SequenceFlow_1jhjz0t"><di:waypoint x="4022" y="280" /><di:waypoint x="4050" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1kgdcyf_di" bpmnElement="SequenceFlow_1kgdcyf"><di:waypoint x="4820" y="280" /><di:waypoint x="4845" y="280" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0pr84yj_di" bpmnElement="SequenceFlow_0pr84yj"><di:waypoint x="188" y="290" /><di:waypoint x="210" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNShape id="StartEvent_1xjczg5_di" bpmnElement="StartEvent_1xjczg5"><dc:Bounds x="152" y="272" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_0wpfl50_di" bpmnElement="EndEvent_0wpfl50"><dc:Bounds x="5252" y="262" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1l1eld8_di" bpmnElement="ServiceTask_1l1eld8"><dc:Bounds x="4050" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0buh97r_di" bpmnElement="ServiceTask_0buh97r"><dc:Bounds x="340" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0bx8tw1_di" bpmnElement="ServiceTask_0bx8tw1"><dc:Bounds x="470" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_05ff5n6_di" bpmnElement="ServiceTask_05ff5n6"><dc:Bounds x="4470" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0opqfwn_di" bpmnElement="ServiceTask_0opqfwn"><dc:Bounds x="4590" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0ndsgbj_di" bpmnElement="ServiceTask_0ndsgbj"><dc:Bounds x="4720" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0e867z9_di" bpmnElement="ExclusiveGateway_0e867z9" isMarkerVisible="true"><dc:Bounds x="3637" y="255" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0tb7agh_di" bpmnElement="ServiceTask_0tb7agh"><dc:Bounds x="3692" y="349" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_17wpqv6_di" bpmnElement="ServiceTask_17wpqv6"><dc:Bounds x="3502" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_12d1jon_di" bpmnElement="ServiceTask_12d1jon"><dc:Bounds x="3832" y="342" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0forhta_di" bpmnElement="ServiceTask_0forhta"><dc:Bounds x="3922" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_10q57k3_di" bpmnElement="ServiceTask_10q57k3"><dc:Bounds x="210" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0w9pwdj_di" bpmnElement="ServiceTask_0w9pwdj"><dc:Bounds x="630" y="132" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0jddbw2_di" bpmnElement="ServiceTask_0jddbw2"><dc:Bounds x="600" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0zguqai_di" bpmnElement="ServiceTask_0zguqai"><dc:Bounds x="940" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_14gbsho_di" bpmnElement="ExclusiveGateway_14gbsho" isMarkerVisible="true"><dc:Bounds x="735" y="265" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0d5q1cr_di" bpmnElement="ServiceTask_0d5q1cr"><dc:Bounds x="810" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_06zdq0z_di" bpmnElement="ServiceTask_06zdq0z"><dc:Bounds x="1200" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0mtl33w_di" bpmnElement="ServiceTask_0mtl33w"><dc:Bounds x="1070" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1lro8zi_di" bpmnElement="ServiceTask_1lro8zi"><dc:Bounds x="4183" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0401pf9_di" bpmnElement="ServiceTask_0401pf9"><dc:Bounds x="4328" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0gsggat_di" bpmnElement="ServiceTask_0gsggat"><dc:Bounds x="1642" y="50" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="SubProcess_14ypmmq_di" bpmnElement="SubProcess_14ypmmq" isExpanded="true"><dc:Bounds x="1752" y="132" width="1714" height="677" /></bpmndi:BPMNShape><bpmndi:BPMNEdge id="SequenceFlow_136zzgf_di" bpmnElement="SequenceFlow_136zzgf"><di:waypoint x="2630" y="643" /><di:waypoint x="2837" y="640" /><di:waypoint x="2837" y="640" /><di:waypoint x="3240" y="642" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0s37hbe_di" bpmnElement="SequenceFlow_0s37hbe"><di:waypoint x="2170" y="643" /><di:waypoint x="2194" y="643" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_157weul_di" bpmnElement="SequenceFlow_157weul"><di:waypoint x="2190" y="392" /><di:waypoint x="2219" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_118d0i3_di" bpmnElement="SequenceFlow_118d0i3"><di:waypoint x="2400" y="540" /><di:waypoint x="2020" y="540" /><di:waypoint x="2020" y="432" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1qod5bp_di" bpmnElement="SequenceFlow_1qod5bp"><di:waypoint x="2450" y="417" /><di:waypoint x="2450" y="500" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1lv44bm_di" bpmnElement="SequenceFlow_1lv44bm"><di:waypoint x="2194" y="480" /><di:waypoint x="2020" y="480" /><di:waypoint x="2020" y="432" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1g2n4su_di" bpmnElement="SequenceFlow_1g2n4su"><di:waypoint x="2400" y="280" /><di:waypoint x="2020" y="280" /><di:waypoint x="2020" y="352" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ti2u7a_di" bpmnElement="SequenceFlow_1ti2u7a"><di:waypoint x="2070" y="392" /><di:waypoint x="2090" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_06rctd2_di" bpmnElement="SequenceFlow_06rctd2"><di:waypoint x="2244" y="417" /><di:waypoint x="2244" y="440" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_16c5pwe_di" bpmnElement="SequenceFlow_16c5pwe"><di:waypoint x="2269" y="392" /><di:waypoint x="2300" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1fcbwyz_di" bpmnElement="SequenceFlow_1fcbwyz"><di:waypoint x="2450" y="367" /><di:waypoint x="2450" y="320" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0tvtvnn_di" bpmnElement="SequenceFlow_0tvtvnn"><di:waypoint x="2400" y="392" /><di:waypoint x="2425" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0kmmj31_di" bpmnElement="SequenceFlow_0kmmj31"><di:waypoint x="2475" y="392" /><di:waypoint x="2990" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1a72ikq_di" bpmnElement="SequenceFlow_1a72ikq"><di:waypoint x="3090" y="392" /><di:waypoint x="3160" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0sf53u2_di" bpmnElement="SequenceFlow_0sf53u2"><di:waypoint x="1850" y="470" /><di:waypoint x="1900" y="470" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ov3db5_di" bpmnElement="SequenceFlow_1ov3db5"><di:waypoint x="1925" y="445" /><di:waypoint x="1925" y="392" /><di:waypoint x="1970" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0tx936q_di" bpmnElement="SequenceFlow_0tx936q"><di:waypoint x="1925" y="495" /><di:waypoint x="1925" y="643" /><di:waypoint x="1944" y="643" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1mszrjf_di" bpmnElement="SequenceFlow_1mszrjf"><di:waypoint x="3260" y="392" /><di:waypoint x="3392" y="392" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1lhlrf0_di" bpmnElement="SequenceFlow_1lhlrf0"><di:waypoint x="2434" y="643" /><di:waypoint x="2530" y="643" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1fbudh0_di" bpmnElement="SequenceFlow_1fbudh0"><di:waypoint x="2294" y="643" /><di:waypoint x="2334" y="643" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_03c08e3_di" bpmnElement="SequenceFlow_03c08e3"><di:waypoint x="2044" y="643" /><di:waypoint x="2070" y="643" /></bpmndi:BPMNEdge><bpmndi:BPMNShape id="StartEvent_1imbnb2_di" bpmnElement="StartEvent_1imbnb2"><dc:Bounds x="1814" y="452" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_058o7u2_di" bpmnElement="UserTask_058o7u2"><dc:Bounds x="1970" y="352" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0644zow_di" bpmnElement="ExclusiveGateway_0644zow" isMarkerVisible="true"><dc:Bounds x="2219" y="367" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1wz4m97_di" bpmnElement="ServiceTask_1wz4m97"><dc:Bounds x="2194" y="440" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0ybacv2_di" bpmnElement="ServiceTask_0ybacv2"><dc:Bounds x="2400" y="240" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_18corv1_di" bpmnElement="ServiceTask_18corv1"><dc:Bounds x="2300" y="352" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0x8zqvr_di" bpmnElement="ExclusiveGateway_0x8zqvr" isMarkerVisible="true"><dc:Bounds x="2425" y="367" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1ygfbwk_di" bpmnElement="ServiceTask_1ygfbwk"><dc:Bounds x="2990" y="352" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0hw7p6v_di" bpmnElement="UserTask_0hw7p6v" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="3160" y="352" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ParallelGateway_18oka5e_di" bpmnElement="ParallelGateway_18oka5e"><dc:Bounds x="1900" y="445" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ReceiveTask_1x3x2qd_di" bpmnElement="ReceiveTask_1x3x2qd"><dc:Bounds x="2194" y="603" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_019ia1a_di" bpmnElement="EndEvent_019ia1a"><dc:Bounds x="3392" y="374" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_0fna8dy_di" bpmnElement="EndEvent_0fna8dy"><dc:Bounds x="3240" y="624" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_170af35_di" bpmnElement="ServiceTask_170af35"><dc:Bounds x="2334" y="603" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1r5hosh_di" bpmnElement="ServiceTask_1r5hosh"><dc:Bounds x="1944" y="603" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0733ahl_di" bpmnElement="ServiceTask_0733ahl"><dc:Bounds x="2400" y="500" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1k9bsz2_di" bpmnElement="ServiceTask_1k9bsz2"><dc:Bounds x="2090" y="352" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0aphjs7_di" bpmnElement="ServiceTask_0aphjs7"><dc:Bounds x="2070" y="603" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_10whw29_di" bpmnElement="ServiceTask_10whw29"><dc:Bounds x="2530" y="603" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1wsrvgv_di" bpmnElement="ServiceTask_1wsrvgv"><dc:Bounds x="1320" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1w8dgot_di" bpmnElement="ServiceTask_1w8dgot"><dc:Bounds x="1450" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_02rvq9w_di" bpmnElement="ExclusiveGateway_02rvq9w" isMarkerVisible="true"><dc:Bounds x="4845" y="255" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_1a6v1pu_di" bpmnElement="ExclusiveGateway_1a6v1pu" isMarkerVisible="true"><dc:Bounds x="5045" y="255" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_01uygxl_di" bpmnElement="ServiceTask_01uygxl"><dc:Bounds x="4920" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0ughzl1_di" bpmnElement="ServiceTask_0ughzl1"><dc:Bounds x="4920" y="300" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1fuqsyv_di" bpmnElement="ServiceTask_1fuqsyv"><dc:Bounds x="5120" y="240" width="100" height="80" /></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>