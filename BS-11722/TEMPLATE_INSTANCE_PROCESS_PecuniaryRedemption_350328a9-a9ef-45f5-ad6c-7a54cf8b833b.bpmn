<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.4.1"><bpmn:process id="TEMPLATE_INSTANCE_PROCESS_PecuniaryRedemption_350328a9-a9ef-45f5-ad6c-7a54cf8b833b" name="Движение ДС при погашении облигаций" isExecutable="true"><bpmn:documentation>-</bpmn:documentation><bpmn:startEvent id="StartEvent_0lfjwo6"><bpmn:outgoing>SequenceFlow_0ihh6jk</bpmn:outgoing></bpmn:startEvent><bpmn:endEvent id="EndEvent_1kbfz7s"><bpmn:incoming>SequenceFlow_0q6p0hr</bpmn:incoming></bpmn:endEvent><bpmn:serviceTask id="ServiceTask_1poq37r" name="Статус Подтверждено"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Подтверждено</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_09cz0r3</bpmn:incoming><bpmn:outgoing>SequenceFlow_1rbl8pk</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_16qonji" name="Получить значение из объекта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "enrichment",
    "filter": {
        "_id": ObjectId("${instanceId}")
    },
    "projection": {
        "attributes.AssetFlows___lkupClient___ValueDisplayed": 1
    }
}</camunda:inputParameter><camunda:outputParameter name="clientPrimaryId"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.AssetFlows___lkupClient___ValueDisplayed.primaryId</camunda:script></camunda:outputParameter><camunda:outputParameter name="clientSource"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.AssetFlows___lkupClient___ValueDisplayed.source</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1lstg1p</bpmn:incoming><bpmn:outgoing>SequenceFlow_0e5vt9m</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_05xyxb6" name="Сохранить значение из связанного объекта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
 "hlk_app_id": "${clientPrimaryId}"
}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0e5vt9m</bpmn:incoming><bpmn:outgoing>SequenceFlow_1gialr5</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1j7278y" name="Получить номер обязательства"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttribute/AssetFlows___txtID___ValueDisplayed</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="payload" /><camunda:outputParameter name="assetflowid">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0to1cqb</bpmn:incoming><bpmn:outgoing>SequenceFlow_1o76v5a</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0d8ml0k" name="Формируем отчёт"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/report-service/generate-report-save/by-name?name=CouponTicketReport</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">[
	{
		"displayName": "Номер заказа",
		"name": "FlowId",
		"value":  "${assetflowid}"
	}
]</camunda:inputParameter><camunda:outputParameter name="generated">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1o76v5a</bpmn:incoming><bpmn:outgoing>SequenceFlow_1ptad3w</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_00zprbn" name="Привязываем отчёт к обязательству"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/file/create/ENRICHMENT/${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="payload">${generated}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1ptad3w</bpmn:incoming><bpmn:outgoing>SequenceFlow_190ula9</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_16f8mk6" default="SequenceFlow_1pj7114"><bpmn:incoming>SequenceFlow_1vxo6sz</bpmn:incoming><bpmn:outgoing>SequenceFlow_0nrwo6v</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1pj7114</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_19elqez" name="Получение курса валюты"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${msUrl}/api/FXRates?ccyCode1=${ccy}&amp;ccyCode2=KZT&amp;rateSet=NBRK&amp;dateHist=${date.substring(0,10)}</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="rate">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1pj7114</bpmn:incoming><bpmn:outgoing>SequenceFlow_14985k9</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0hpjx6h" name="Получение данных из объекта для расчета суммы в KZT"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttributes?systemName=AssetFlows___lkupAsset___ValueDisplayed&amp;systemName=AssetFlows___txtQtyPcs___Value&amp;systemName=AssetFlows___dateFlowDate___ValueDisplayed</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="ccy"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___lkupAsset___ValueDisplayed</camunda:script></camunda:outputParameter><camunda:outputParameter name="amount"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___txtQtyPcs___Value</camunda:script></camunda:outputParameter><camunda:outputParameter name="date"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___dateFlowDate___ValueDisplayed</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0u0eu8r</bpmn:incoming><bpmn:outgoing>SequenceFlow_1vxo6sz</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1sohlk8" name="Расчет суммы в валюте KZT" camunda:expression="${amount * rate}" camunda:resultVariable="amount"><bpmn:incoming>SequenceFlow_14985k9</bpmn:incoming><bpmn:outgoing>SequenceFlow_1t1u5fx</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0wdyjxe" name="Сохранение суммы в KZT"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{"amountKZT": ${amount}}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0nrwo6v</bpmn:incoming><bpmn:incoming>SequenceFlow_1t1u5fx</bpmn:incoming><bpmn:outgoing>SequenceFlow_09cz0r3</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_14lvfrq" name="Статус Новая"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Новая</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0ihh6jk</bpmn:incoming><bpmn:outgoing>SequenceFlow_1lstg1p</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_10g0ymi" name="Найти связанный объект клиент"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "${clientSource}",
    "filter": {
        "primaryId": "${clientPrimaryId}",
		"activityStatus": "ACTIVE"
    },
    "projection": {
        "attributes.hlk_app_id": 1
    }
}</camunda:inputParameter><camunda:outputParameter name="hlk_app_id"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.hlk_app_id</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_00qyoc9" name="Получение данных из объекта для счета"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttributes?systemName=AssetFlows___lkupAsset___ValueDisplayed&amp;systemName=AssetFlows___lkupCS___ValueDisplayed&amp;systemName=AssetFlows___dateFlowDate___ValueDisplayed</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="ccyCS"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___lkupAsset___ValueDisplayed</camunda:script></camunda:outputParameter><camunda:outputParameter name="CS"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___lkupCS___ValueDisplayed</camunda:script></camunda:outputParameter><camunda:outputParameter name="date"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___dateFlowDate___ValueDisplayed</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1gialr5</bpmn:incoming><bpmn:outgoing>SequenceFlow_19pxeqt</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0dakwg1" name="Найти cчет, попадающий под условия"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "invoice",
    "filter": {
        "templatePrimaryId": "5d9af8742ab79c000a9a05c5",
		"attributes.hlk_account_type": "Денежный",   
        "attributes.hlk_account_currency": "${ccyCS}", 
   "attributes.hlk_account_owner.primaryId": "${clientPrimaryId}",
    "attributes.hlk_clearing_system.value": "${CS.replaceAll("\"", "\\\\\\\"")}",
		"activityStatus": "ACTIVE"
    },
    "projection": {
        "attributes.hlk_Account_Number": 1
"primaryId" : 1
    }
}</camunda:inputParameter><camunda:outputParameter name="hlk_Account_Number"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0].attributes.hlk_Account_Number;
} catch(e) {
"";
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="hlk_Account_Number_primaryId"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].primaryId</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_15hysm8</bpmn:incoming><bpmn:incoming>SequenceFlow_1qu7vxi</bpmn:incoming><bpmn:outgoing>SequenceFlow_0rg8vkm</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_1nj5hk5" default="SequenceFlow_15hysm8"><bpmn:incoming>SequenceFlow_19pxeqt</bpmn:incoming><bpmn:outgoing>SequenceFlow_15hysm8</bpmn:outgoing><bpmn:outgoing>SequenceFlow_0cxhsev</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_0tri8ko" name="Изменить валюту с RUR на RUB" camunda:expression="RUB" camunda:resultVariable="ccyCS"><bpmn:incoming>SequenceFlow_0cxhsev</bpmn:incoming><bpmn:outgoing>SequenceFlow_1qu7vxi</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0k3bdow" name="создание обязательств"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/sendInstanceTo/ENRICHMENT_OBLIGATION/${instanceId}?AssetFlows___radioFactPlan___ValueDisplayed=План</camunda:inputParameter><camunda:inputParameter name="payload">{
}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_070s9ym</bpmn:incoming><bpmn:outgoing>SequenceFlow_0cp2su5</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1tx3l49" name="Сохранить номер счета"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
"AssetFlows___lkupBOAccountNumber___ValueDisplayed" : {
"value" : "${hlk_Account_Number}",
"primaryId" : "${hlk_Account_Number_primaryId}",
"source" : "invoice",
"_class" : "egar.ezdoc.model.entity.attribute.DictionaryValue"
}
}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0rg8vkm</bpmn:incoming><bpmn:outgoing>SequenceFlow_070s9ym</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0cvq7x6" name="Поиск обязательства"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/obligations/one/by-attribute?name=AssetflowID&amp;value=50</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="OutputCash">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1rbl8pk</bpmn:incoming><bpmn:outgoing>SequenceFlow_1r83l4y</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1pdrrmi" name="Создание фактов"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment-obligation/fact/${OutputCash}?AssetFlows___radioFactPlan___ValueDisplayed=Факт&amp;AssetFlows___dateFlowDate___ValueDisplayed=${Date_fact_payment}&amp;AssetFlows___txtQtyPcs___Value=${AssetFlows___txtQtyPcs___Value}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1r83l4y</bpmn:incoming><bpmn:outgoing>SequenceFlow_0to1cqb</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1agjauz" name="Статус Заполнение:Дата фактической выплаты"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Заполнение:+Дата+фактической+выплаты</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0ihh6jk" sourceRef="StartEvent_0lfjwo6" targetRef="ServiceTask_14lvfrq" /><bpmn:sequenceFlow id="SequenceFlow_190ula9" sourceRef="ServiceTask_00zprbn" targetRef="ExclusiveGateway_0imzfr1" /><bpmn:sequenceFlow id="SequenceFlow_09cz0r3" sourceRef="ServiceTask_0wdyjxe" targetRef="ServiceTask_1poq37r" /><bpmn:sequenceFlow id="SequenceFlow_1rbl8pk" sourceRef="ServiceTask_1poq37r" targetRef="ServiceTask_0cvq7x6" /><bpmn:sequenceFlow id="SequenceFlow_1lstg1p" sourceRef="ServiceTask_14lvfrq" targetRef="ServiceTask_16qonji" /><bpmn:sequenceFlow id="SequenceFlow_0e5vt9m" sourceRef="ServiceTask_16qonji" targetRef="ServiceTask_05xyxb6" /><bpmn:sequenceFlow id="SequenceFlow_1gialr5" sourceRef="ServiceTask_05xyxb6" targetRef="ServiceTask_00qyoc9" /><bpmn:sequenceFlow id="SequenceFlow_0to1cqb" sourceRef="ServiceTask_1pdrrmi" targetRef="ServiceTask_1j7278y" /><bpmn:sequenceFlow id="SequenceFlow_1o76v5a" sourceRef="ServiceTask_1j7278y" targetRef="ServiceTask_0d8ml0k" /><bpmn:sequenceFlow id="SequenceFlow_1ptad3w" sourceRef="ServiceTask_0d8ml0k" targetRef="ServiceTask_00zprbn" /><bpmn:sequenceFlow id="SequenceFlow_1vxo6sz" sourceRef="ServiceTask_0hpjx6h" targetRef="ExclusiveGateway_16f8mk6" /><bpmn:sequenceFlow id="SequenceFlow_0nrwo6v" sourceRef="ExclusiveGateway_16f8mk6" targetRef="ServiceTask_0wdyjxe"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"KZT".equals(ccy)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1pj7114" sourceRef="ExclusiveGateway_16f8mk6" targetRef="ServiceTask_19elqez" /><bpmn:sequenceFlow id="SequenceFlow_14985k9" sourceRef="ServiceTask_19elqez" targetRef="ServiceTask_1sohlk8" /><bpmn:sequenceFlow id="SequenceFlow_1t1u5fx" sourceRef="ServiceTask_1sohlk8" targetRef="ServiceTask_0wdyjxe" /><bpmn:sequenceFlow id="SequenceFlow_19pxeqt" sourceRef="ServiceTask_00qyoc9" targetRef="ExclusiveGateway_1nj5hk5" /><bpmn:sequenceFlow id="SequenceFlow_15hysm8" sourceRef="ExclusiveGateway_1nj5hk5" targetRef="ServiceTask_0dakwg1" /><bpmn:sequenceFlow id="SequenceFlow_1qu7vxi" sourceRef="ServiceTask_0tri8ko" targetRef="ServiceTask_0dakwg1" /><bpmn:sequenceFlow id="SequenceFlow_0rg8vkm" sourceRef="ServiceTask_0dakwg1" targetRef="ServiceTask_1tx3l49" /><bpmn:sequenceFlow id="SequenceFlow_0cxhsev" sourceRef="ExclusiveGateway_1nj5hk5" targetRef="ServiceTask_0tri8ko"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${"RUR".equals(ccyCS)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_070s9ym" sourceRef="ServiceTask_1tx3l49" targetRef="ServiceTask_0k3bdow" /><bpmn:sequenceFlow id="SequenceFlow_1r83l4y" sourceRef="ServiceTask_0cvq7x6" targetRef="ServiceTask_1pdrrmi" /><bpmn:subProcess id="SubProcess_0ow6811"><bpmn:incoming>SequenceFlow_1f3xvyj</bpmn:incoming><bpmn:outgoing>SequenceFlow_0u0eu8r</bpmn:outgoing><bpmn:startEvent id="StartEvent_051vfwj"><bpmn:outgoing>SequenceFlow_1xqveem</bpmn:outgoing></bpmn:startEvent><bpmn:userTask id="UserTask_0ah95yq" name="Заполнение поля Дата факта и Количество актива" camunda:formKey="FILL" camunda:candidateGroups="jira-users,cb_backoffice"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="fillverify" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="Date_fact_payment" label="Corp. Дата фактической выплаты" type="string" /><camunda:formField id="AssetFlows___txtQtyPcs___Value" label="Corp. Количество актива" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0cw79nx</bpmn:incoming><bpmn:incoming>SequenceFlow_08q03se</bpmn:incoming><bpmn:incoming>SequenceFlow_0ddshgr</bpmn:incoming><bpmn:incoming>SequenceFlow_1n85m1a</bpmn:incoming><bpmn:outgoing>SequenceFlow_0ihobt7</bpmn:outgoing></bpmn:userTask><bpmn:exclusiveGateway id="ExclusiveGateway_0qxicem" default="SequenceFlow_1knvoru"><bpmn:incoming>SequenceFlow_095ewdv</bpmn:incoming><bpmn:outgoing>SequenceFlow_1knvoru</bpmn:outgoing><bpmn:outgoing>SequenceFlow_13n6rs7</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_1nbwlii" name="Статус заявки &#34;Дата факта не указана&#34;"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Дата+фактической+выплаты+не+указана</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_13n6rs7</bpmn:incoming><bpmn:outgoing>SequenceFlow_0ddshgr</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0899gqm" name="Статус заявки &#34;Дата факта &#62; TODAY&#34;"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Дата+фактической+выплаты+больше+текущей+даты</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0kxu8ze</bpmn:incoming><bpmn:outgoing>SequenceFlow_08q03se</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1r30pju" name="Получаем modifyDate"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="payload">{
	"find": "enrichment",
	"filter": {
	"_id" : ObjectId("${instanceId}")
	},
	"projection": {
		"modifyDate": 1
	}
}</camunda:inputParameter><camunda:outputParameter name="modifyDate"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].modifyDate</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1knvoru</bpmn:incoming><bpmn:outgoing>SequenceFlow_0mh0cme</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_0gfasww" default="SequenceFlow_1k41agn"><bpmn:incoming>SequenceFlow_0mh0cme</bpmn:incoming><bpmn:outgoing>SequenceFlow_1k41agn</bpmn:outgoing><bpmn:outgoing>SequenceFlow_0kxu8ze</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1cqzgp7</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_141k84s" name="Статус Подтверждение заявки" camunda:expression="${&#34;Подтверждение заявки&#34;}" camunda:resultVariable="labelStatus"><bpmn:incoming>SequenceFlow_1k41agn</bpmn:incoming><bpmn:outgoing>SequenceFlow_0sm24g0</bpmn:outgoing></bpmn:serviceTask><bpmn:userTask id="UserTask_0u13mv6" name="Подтверждение заявки" camunda:assignee="${initiator}" camunda:candidateGroups="jira-users,cb_backoffice"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;:&#34;Accept&#34;,&#34;label&#34;:&#34;Подтвердить&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0sm24g0</bpmn:incoming><bpmn:outgoing>SequenceFlow_0yajda5</bpmn:outgoing></bpmn:userTask><bpmn:parallelGateway id="ParallelGateway_0qfgwn7"><bpmn:incoming>SequenceFlow_1xqveem</bpmn:incoming><bpmn:outgoing>SequenceFlow_1xvtd7d</bpmn:outgoing><bpmn:outgoing>SequenceFlow_0cw79nx</bpmn:outgoing></bpmn:parallelGateway><bpmn:receiveTask id="ReceiveTask_0bu72n4" messageRef="Message_0o4y5z7"><bpmn:incoming>SequenceFlow_00gpg7e</bpmn:incoming><bpmn:outgoing>SequenceFlow_1gfxnih</bpmn:outgoing></bpmn:receiveTask><bpmn:endEvent id="EndEvent_0ya9vbf"><bpmn:incoming>SequenceFlow_0yajda5</bpmn:incoming><bpmn:terminateEventDefinition id="TerminateEventDefinition_0o9hfot" /></bpmn:endEvent><bpmn:endEvent id="EndEvent_04a8jwq"><bpmn:incoming>SequenceFlow_0q929xx</bpmn:incoming><bpmn:terminateEventDefinition id="TerminateEventDefinition_0gm7qrk" /></bpmn:endEvent><bpmn:serviceTask id="ServiceTask_0n6ko4c" name="Сохранение  даты факта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{"Date_fact_payment": "${Date_fact_payment}"}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1gfxnih</bpmn:incoming><bpmn:outgoing>SequenceFlow_0hst3cd</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_113kbms" name="Статус Подтверждение заявки" camunda:expression="${&#34;Подтверждение заявки&#34;}" camunda:resultVariable="labelStatus"><bpmn:incoming>SequenceFlow_1xvtd7d</bpmn:incoming><bpmn:outgoing>SequenceFlow_1ia5rem</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1ia5rem" sourceRef="ServiceTask_113kbms" targetRef="ServiceTask_03zfqdd" /><bpmn:sequenceFlow id="SequenceFlow_1gfxnih" sourceRef="ReceiveTask_0bu72n4" targetRef="ServiceTask_0n6ko4c" /><bpmn:sequenceFlow id="SequenceFlow_0hst3cd" sourceRef="ServiceTask_0n6ko4c" targetRef="ServiceTask_1mzpudr" /><bpmn:sequenceFlow id="SequenceFlow_0yajda5" sourceRef="UserTask_0u13mv6" targetRef="EndEvent_0ya9vbf" /><bpmn:sequenceFlow id="SequenceFlow_1xvtd7d" sourceRef="ParallelGateway_0qfgwn7" targetRef="ServiceTask_113kbms" /><bpmn:sequenceFlow id="SequenceFlow_0cw79nx" sourceRef="ParallelGateway_0qfgwn7" targetRef="UserTask_0ah95yq" /><bpmn:sequenceFlow id="SequenceFlow_1xqveem" sourceRef="StartEvent_051vfwj" targetRef="ParallelGateway_0qfgwn7" /><bpmn:sequenceFlow id="SequenceFlow_0sm24g0" sourceRef="ServiceTask_141k84s" targetRef="UserTask_0u13mv6" /><bpmn:sequenceFlow id="SequenceFlow_1k41agn" sourceRef="ExclusiveGateway_0gfasww" targetRef="ServiceTask_141k84s" /><bpmn:sequenceFlow id="SequenceFlow_0mh0cme" sourceRef="ServiceTask_1r30pju" targetRef="ExclusiveGateway_0gfasww" /><bpmn:sequenceFlow id="SequenceFlow_0kxu8ze" sourceRef="ExclusiveGateway_0gfasww" targetRef="ServiceTask_0899gqm"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${(Date_fact_payment &gt; modifyDate)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1knvoru" sourceRef="ExclusiveGateway_0qxicem" targetRef="ServiceTask_1r30pju" /><bpmn:sequenceFlow id="SequenceFlow_13n6rs7" sourceRef="ExclusiveGateway_0qxicem" targetRef="ServiceTask_1nbwlii"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${( Date_fact_payment ==null )||( Date_fact_payment   =="")}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_0ihobt7" sourceRef="UserTask_0ah95yq" targetRef="ServiceTask_0h36s1s" /><bpmn:sequenceFlow id="SequenceFlow_08q03se" sourceRef="ServiceTask_0899gqm" targetRef="UserTask_0ah95yq" /><bpmn:sequenceFlow id="SequenceFlow_0ddshgr" sourceRef="ServiceTask_1nbwlii" targetRef="UserTask_0ah95yq" /><bpmn:serviceTask id="ServiceTask_0h36s1s" name="Получение поля Дата факта и Количества"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
	"find": "enrichment",
	"filter": {
	"_id" : ObjectId("${instanceId}")
	},
	"projection": {
		"attributes.Date_fact_payment": 1
"attributes.AssetFlows___txtQtyPcs___Value": 1
"attributes.hlk_plan_qty": 1
	}
}</camunda:inputParameter><camunda:outputParameter name="Date_fact_payment"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.Date_fact_payment</camunda:script></camunda:outputParameter><camunda:outputParameter name="AssetFlows___txtQtyPcs___Value"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.AssetFlows___txtQtyPcs___Value</camunda:script></camunda:outputParameter><camunda:outputParameter name="hlk_plan_qty"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.hlk_plan_qty</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0ihobt7</bpmn:incoming><bpmn:outgoing>SequenceFlow_095ewdv</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_095ewdv" sourceRef="ServiceTask_0h36s1s" targetRef="ExclusiveGateway_0qxicem" /><bpmn:sequenceFlow id="SequenceFlow_1cqzgp7" sourceRef="ExclusiveGateway_0gfasww" targetRef="ServiceTask_1ksumuf"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${(AssetFlows___txtQtyPcs___Value &gt; hlk_plan_qty)}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_1ksumuf" name="Статус заявки &#34;Сумма фактического исполнения не может быть больше плановой&#34;"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/saveLabel/${instanceId}?label=Сумма+фактического+исполнения+не+может+быть+больше+плановой</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1cqzgp7</bpmn:incoming><bpmn:outgoing>SequenceFlow_1n85m1a</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1n85m1a" sourceRef="ServiceTask_1ksumuf" targetRef="UserTask_0ah95yq" /><bpmn:serviceTask id="ServiceTask_1mzpudr" name="Получение поля Дата факта"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
	"find": "enrichment",
	"filter": {
	"_id" : ObjectId("${instanceId}")
	},
	"projection": {
		"attributes.Date_fact_payment": 1
	}
}</camunda:inputParameter><camunda:outputParameter name="Date_fact_payment"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].attributes.Date_fact_payment</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0hst3cd</bpmn:incoming><bpmn:outgoing>SequenceFlow_0q929xx</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0q929xx" sourceRef="ServiceTask_1mzpudr" targetRef="EndEvent_04a8jwq" /><bpmn:serviceTask id="ServiceTask_03zfqdd" name="Получить данные с форма: дата плана, инструмент, тип"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttributes?systemName=AssetFlows___dateFlowDate___ValueDisplayed&amp;systemName=AssetFlows___lkupFlowType___ValueDisplayed&amp;systemName=AssetFlows___lkupCorpEventAsset___ValueDisplayed&amp;systemName=AssetFlows___txtQtyPcs___Value</camunda:inputParameter><camunda:outputParameter name="AssetFlows___dateFlowDate___ValueDisplayed"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___dateFlowDate___ValueDisplayed.substring(0, 10)</camunda:script></camunda:outputParameter><camunda:outputParameter name="AssetFlows___lkupFlowType___ValueDisplayed">${S(response).prop('AssetFlows___lkupFlowType___ValueDisplayed').stringValue()}</camunda:outputParameter><camunda:outputParameter name="AssetFlows___lkupCorpEventAsset___ValueDisplayed">${S(response).prop('AssetFlows___lkupCorpEventAsset___ValueDisplayed').stringValue()}</camunda:outputParameter><camunda:outputParameter name="AssetFlows___txtQtyPcs___Value"><camunda:script scriptFormat="javascript">JSON.parse(response).AssetFlows___txtQtyPcs___Value</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1ia5rem</bpmn:incoming><bpmn:outgoing>SequenceFlow_00gpg7e</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_00gpg7e" sourceRef="ServiceTask_03zfqdd" targetRef="ReceiveTask_0bu72n4" /></bpmn:subProcess><bpmn:sequenceFlow id="SequenceFlow_0cp2su5" sourceRef="ServiceTask_0k3bdow" targetRef="ServiceTask_14b1vg1" /><bpmn:sequenceFlow id="SequenceFlow_0u0eu8r" sourceRef="SubProcess_0ow6811" targetRef="ServiceTask_0hpjx6h" /><bpmn:serviceTask id="ServiceTask_14b1vg1" name="Получение количества"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/getAttribute/AssetFlows___txtQtyPcs___Value</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="qty">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0cp2su5</bpmn:incoming><bpmn:outgoing>SequenceFlow_0hs0ewy</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_19d8g4v" name="Сохранить количество в тех параметры"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/enrichment/${instanceId}/setAttributes</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{"hlk_plan_qty": "${qty}"}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0hs0ewy</bpmn:incoming><bpmn:outgoing>SequenceFlow_1f3xvyj</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0hs0ewy" sourceRef="ServiceTask_14b1vg1" targetRef="ServiceTask_19d8g4v" /><bpmn:sequenceFlow id="SequenceFlow_1f3xvyj" sourceRef="ServiceTask_19d8g4v" targetRef="SubProcess_0ow6811" /><bpmn:exclusiveGateway id="ExclusiveGateway_0imzfr1" default="SequenceFlow_1ngbsuv"><bpmn:incoming>SequenceFlow_190ula9</bpmn:incoming><bpmn:outgoing>SequenceFlow_1ngbsuv</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1i1qww5</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:exclusiveGateway id="ExclusiveGateway_0uu1q8w"><bpmn:incoming>SequenceFlow_0mzk2tm</bpmn:incoming><bpmn:incoming>SequenceFlow_0zt51w3</bpmn:incoming><bpmn:outgoing>SequenceFlow_07p7a81</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_0u2txyu" name="ФЗ. Получаем почту клиента"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="payload">{
  "aggregate": "individualPerson",
  "pipeline": [
    {
      "$match": {
        "actual": true,
        "status": "VERIFICATED",
        "primaryId": "${clientPrimaryId}",
      }
    },
    {
      "$project": {
        "hlk_email": { "$ifNull": ["$attributes.hlk_email", null]},
        "_id": 0
      }
    }
  ],
  "cursor": {
    "batchSize": 10000
  },
  "allowDiskUse": true
}</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:outputParameter name="Email"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].hlk_email</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1ngbsuv</bpmn:incoming><bpmn:outgoing>SequenceFlow_0zt51w3</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_10rsflf" name="ЮЛ. Получаем почту клиента"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="payload">{
  "aggregate": "legalEntity",
  "pipeline": [
    {
      "$match": {
        "actual": true,
        "status": "VERIFICATED",
        "primaryId": "${clientPrimaryId}",
      }
    },
    {
      "$project": {
        "hlk_email": { "$ifNull": ["$attributes.hlk_email", null]},
        "_id": 0
      }
    }
  ],
  "cursor": {
    "batchSize": 10000
  },
  "allowDiskUse": true
}</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:outputParameter name="Email"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].hlk_email</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1i1qww5</bpmn:incoming><bpmn:outgoing>SequenceFlow_0mzk2tm</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1o2xrw9" name="Отправляем отчёт клиенту"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/email/send</camunda:inputParameter><camunda:inputParameter name="payload">{
"email":"${Email}",
"subject":"Отчёт о зачислении суммы вознаграждения/погашения по финансовым инструментам",
"text":"",
"attachments": ["${generated}"]
}</camunda:inputParameter><camunda:outputParameter name="errorMessage">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_07p7a81</bpmn:incoming><bpmn:outgoing>SequenceFlow_0q6p0hr</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1ngbsuv" sourceRef="ExclusiveGateway_0imzfr1" targetRef="ServiceTask_0u2txyu" /><bpmn:sequenceFlow id="SequenceFlow_1i1qww5" sourceRef="ExclusiveGateway_0imzfr1" targetRef="ServiceTask_10rsflf"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${clientSource == 'legalEntity'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_0mzk2tm" sourceRef="ServiceTask_10rsflf" targetRef="ExclusiveGateway_0uu1q8w" /><bpmn:sequenceFlow id="SequenceFlow_0zt51w3" sourceRef="ServiceTask_0u2txyu" targetRef="ExclusiveGateway_0uu1q8w" /><bpmn:sequenceFlow id="SequenceFlow_07p7a81" sourceRef="ExclusiveGateway_0uu1q8w" targetRef="ServiceTask_1o2xrw9" /><bpmn:sequenceFlow id="SequenceFlow_0q6p0hr" sourceRef="ServiceTask_1o2xrw9" targetRef="EndEvent_1kbfz7s" /></bpmn:process><bpmn:message id="Message_0o4y5z7" name="confirmPayment" /><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="TEMPLATE_INSTANCE_PROCESS_PecuniaryRedemption_350328a9-a9ef-45f5-ad6c-7a54cf8b833b"><bpmndi:BPMNEdge id="SequenceFlow_0q6p0hr_di" bpmnElement="SequenceFlow_0q6p0hr"><di:waypoint x="5400" y="440" /><di:waypoint x="5420" y="440" /><di:waypoint x="5436" y="367" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_07p7a81_di" bpmnElement="SequenceFlow_07p7a81"><di:waypoint x="5195" y="340" /><di:waypoint x="5195" y="440" /><di:waypoint x="5300" y="440" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0zt51w3_di" bpmnElement="SequenceFlow_0zt51w3"><di:waypoint x="5120" y="460" /><di:waypoint x="5170" y="460" /><di:waypoint x="5170" y="365" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0mzk2tm_di" bpmnElement="SequenceFlow_0mzk2tm"><di:waypoint x="5120" y="290" /><di:waypoint x="5170" y="290" /><di:waypoint x="5170" y="315" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1i1qww5_di" bpmnElement="SequenceFlow_1i1qww5"><di:waypoint x="4970" y="315" /><di:waypoint x="4970" y="290" /><di:waypoint x="5020" y="290" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ngbsuv_di" bpmnElement="SequenceFlow_1ngbsuv"><di:waypoint x="4970" y="365" /><di:waypoint x="4970" y="460" /><di:waypoint x="5020" y="460" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1f3xvyj_di" bpmnElement="SequenceFlow_1f3xvyj"><di:waypoint x="1560" y="350" /><di:waypoint x="1630" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0hs0ewy_di" bpmnElement="SequenceFlow_0hs0ewy"><di:waypoint x="1430" y="350" /><di:waypoint x="1460" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0u0eu8r_di" bpmnElement="SequenceFlow_0u0eu8r"><di:waypoint x="3304" y="395" /><di:waypoint x="3341" y="395" /><di:waypoint x="3341" y="350" /><di:waypoint x="3378" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0cp2su5_di" bpmnElement="SequenceFlow_0cp2su5"><di:waypoint x="1310" y="350" /><di:waypoint x="1330" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1r83l4y_di" bpmnElement="SequenceFlow_1r83l4y"><di:waypoint x="4159" y="350" /><di:waypoint x="4204" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_070s9ym_di" bpmnElement="SequenceFlow_070s9ym"><di:waypoint x="1190" y="350" /><di:waypoint x="1210" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0cxhsev_di" bpmnElement="SequenceFlow_0cxhsev"><di:waypoint x="805" y="350" /><di:waypoint x="830" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0rg8vkm_di" bpmnElement="SequenceFlow_0rg8vkm"><di:waypoint x="1060" y="350" /><di:waypoint x="1090" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1qu7vxi_di" bpmnElement="SequenceFlow_1qu7vxi"><di:waypoint x="930" y="350" /><di:waypoint x="960" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_15hysm8_di" bpmnElement="SequenceFlow_15hysm8"><di:waypoint x="780" y="375" /><di:waypoint x="780" y="450" /><di:waypoint x="1010" y="450" /><di:waypoint x="1010" y="390" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_19pxeqt_di" bpmnElement="SequenceFlow_19pxeqt"><di:waypoint x="732" y="350" /><di:waypoint x="755" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1t1u5fx_di" bpmnElement="SequenceFlow_1t1u5fx"><di:waypoint x="3808" y="452" /><di:waypoint x="3848" y="452" /><di:waypoint x="3848" y="390" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_14985k9_di" bpmnElement="SequenceFlow_14985k9"><di:waypoint x="3668" y="452" /><di:waypoint x="3708" y="452" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1pj7114_di" bpmnElement="SequenceFlow_1pj7114"><di:waypoint x="3538" y="375" /><di:waypoint x="3538" y="459" /><di:waypoint x="3568" y="459" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0nrwo6v_di" bpmnElement="SequenceFlow_0nrwo6v"><di:waypoint x="3563" y="350" /><di:waypoint x="3798" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1vxo6sz_di" bpmnElement="SequenceFlow_1vxo6sz"><di:waypoint x="3478" y="350" /><di:waypoint x="3513" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ptad3w_di" bpmnElement="SequenceFlow_1ptad3w"><di:waypoint x="4728" y="350" /><di:waypoint x="4818" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1o76v5a_di" bpmnElement="SequenceFlow_1o76v5a"><di:waypoint x="4578" y="350" /><di:waypoint x="4628" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0to1cqb_di" bpmnElement="SequenceFlow_0to1cqb"><di:waypoint x="4304" y="350" /><di:waypoint x="4478" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1gialr5_di" bpmnElement="SequenceFlow_1gialr5"><di:waypoint x="602" y="350" /><di:waypoint x="632" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0e5vt9m_di" bpmnElement="SequenceFlow_0e5vt9m"><di:waypoint x="472" y="350" /><di:waypoint x="502" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1lstg1p_di" bpmnElement="SequenceFlow_1lstg1p"><di:waypoint x="342" y="350" /><di:waypoint x="372" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1rbl8pk_di" bpmnElement="SequenceFlow_1rbl8pk"><di:waypoint x="4026" y="350" /><di:waypoint x="4059" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_09cz0r3_di" bpmnElement="SequenceFlow_09cz0r3"><di:waypoint x="3898" y="350" /><di:waypoint x="3926" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_190ula9_di" bpmnElement="SequenceFlow_190ula9"><di:waypoint x="4918" y="350" /><di:waypoint x="4932" y="350" /><di:waypoint x="4932" y="340" /><di:waypoint x="4945" y="340" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0ihh6jk_di" bpmnElement="SequenceFlow_0ihh6jk"><di:waypoint x="190" y="350" /><di:waypoint x="242" y="350" /></bpmndi:BPMNEdge><bpmndi:BPMNShape id="StartEvent_0lfjwo6_di" bpmnElement="StartEvent_0lfjwo6"><dc:Bounds x="154" y="332" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_1kbfz7s_di" bpmnElement="EndEvent_1kbfz7s"><dc:Bounds x="5422" y="332" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1poq37r_di" bpmnElement="ServiceTask_1poq37r"><dc:Bounds x="3926" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_16qonji_di" bpmnElement="ServiceTask_16qonji"><dc:Bounds x="372" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_05xyxb6_di" bpmnElement="ServiceTask_05xyxb6"><dc:Bounds x="502" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1j7278y_di" bpmnElement="ServiceTask_1j7278y"><dc:Bounds x="4478" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0d8ml0k_di" bpmnElement="ServiceTask_0d8ml0k"><dc:Bounds x="4628" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_00zprbn_di" bpmnElement="ServiceTask_00zprbn"><dc:Bounds x="4818" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_16f8mk6_di" bpmnElement="ExclusiveGateway_16f8mk6" isMarkerVisible="true"><dc:Bounds x="3513" y="325" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_19elqez_di" bpmnElement="ServiceTask_19elqez"><dc:Bounds x="3568" y="419" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0hpjx6h_di" bpmnElement="ServiceTask_0hpjx6h"><dc:Bounds x="3378" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1sohlk8_di" bpmnElement="ServiceTask_1sohlk8"><dc:Bounds x="3708" y="412" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0wdyjxe_di" bpmnElement="ServiceTask_0wdyjxe"><dc:Bounds x="3798" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_14lvfrq_di" bpmnElement="ServiceTask_14lvfrq"><dc:Bounds x="242" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_10g0ymi_di" bpmnElement="ServiceTask_10g0ymi"><dc:Bounds x="420" y="192" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_00qyoc9_di" bpmnElement="ServiceTask_00qyoc9"><dc:Bounds x="632" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0dakwg1_di" bpmnElement="ServiceTask_0dakwg1"><dc:Bounds x="960" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_1nj5hk5_di" bpmnElement="ExclusiveGateway_1nj5hk5" isMarkerVisible="true"><dc:Bounds x="755" y="325" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0tri8ko_di" bpmnElement="ServiceTask_0tri8ko"><dc:Bounds x="830" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0k3bdow_di" bpmnElement="ServiceTask_0k3bdow"><dc:Bounds x="1210" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1tx3l49_di" bpmnElement="ServiceTask_1tx3l49"><dc:Bounds x="1090" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0cvq7x6_di" bpmnElement="ServiceTask_0cvq7x6"><dc:Bounds x="4059" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1pdrrmi_di" bpmnElement="ServiceTask_1pdrrmi"><dc:Bounds x="4204" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1agjauz_di" bpmnElement="ServiceTask_1agjauz"><dc:Bounds x="1440" y="120" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="SubProcess_0ow6811_di" bpmnElement="SubProcess_0ow6811" isExpanded="true"><dc:Bounds x="1630" y="80" width="1674" height="630" /></bpmndi:BPMNShape><bpmndi:BPMNEdge id="SequenceFlow_00gpg7e_di" bpmnElement="SequenceFlow_00gpg7e"><di:waypoint x="2000" y="551" /><di:waypoint x="2032" y="551" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0q929xx_di" bpmnElement="SequenceFlow_0q929xx"><di:waypoint x="2420" y="551" /><di:waypoint x="2675" y="550" /><di:waypoint x="2675" y="550" /><di:waypoint x="3078" y="550" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1n85m1a_di" bpmnElement="SequenceFlow_1n85m1a"><di:waypoint x="2248" y="470" /><di:waypoint x="1900" y="470" /><di:waypoint x="1900" y="340" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1cqzgp7_di" bpmnElement="SequenceFlow_1cqzgp7"><di:waypoint x="2408" y="325" /><di:waypoint x="2408" y="460" /><di:waypoint x="2350" y="460" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_095ewdv_di" bpmnElement="SequenceFlow_095ewdv"><di:waypoint x="2118" y="300" /><di:waypoint x="2163" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0ddshgr_di" bpmnElement="SequenceFlow_0ddshgr"><di:waypoint x="2018" y="422" /><di:waypoint x="1925" y="422" /><di:waypoint x="1925" y="340" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_08q03se_di" bpmnElement="SequenceFlow_08q03se"><di:waypoint x="2248" y="188" /><di:waypoint x="1925" y="188" /><di:waypoint x="1925" y="260" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0ihobt7_di" bpmnElement="SequenceFlow_0ihobt7"><di:waypoint x="1975" y="300" /><di:waypoint x="2018" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_13n6rs7_di" bpmnElement="SequenceFlow_13n6rs7"><di:waypoint x="2188" y="325" /><di:waypoint x="2188" y="422" /><di:waypoint x="2118" y="422" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1knvoru_di" bpmnElement="SequenceFlow_1knvoru"><di:waypoint x="2213" y="300" /><di:waypoint x="2248" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0kxu8ze_di" bpmnElement="SequenceFlow_0kxu8ze"><di:waypoint x="2408" y="275" /><di:waypoint x="2408" y="188" /><di:waypoint x="2348" y="188" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0mh0cme_di" bpmnElement="SequenceFlow_0mh0cme"><di:waypoint x="2348" y="300" /><di:waypoint x="2383" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1k41agn_di" bpmnElement="SequenceFlow_1k41agn"><di:waypoint x="2433" y="300" /><di:waypoint x="2458" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0sm24g0_di" bpmnElement="SequenceFlow_0sm24g0"><di:waypoint x="2558" y="300" /><di:waypoint x="2878" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1xqveem_di" bpmnElement="SequenceFlow_1xqveem"><di:waypoint x="1688" y="378" /><di:waypoint x="1738" y="378" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0cw79nx_di" bpmnElement="SequenceFlow_0cw79nx"><di:waypoint x="1763" y="353" /><di:waypoint x="1763" y="300" /><di:waypoint x="1875" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1xvtd7d_di" bpmnElement="SequenceFlow_1xvtd7d"><di:waypoint x="1763" y="403" /><di:waypoint x="1763" y="551" /><di:waypoint x="1782" y="551" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0yajda5_di" bpmnElement="SequenceFlow_0yajda5"><di:waypoint x="2978" y="300" /><di:waypoint x="3078" y="300" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0hst3cd_di" bpmnElement="SequenceFlow_0hst3cd"><di:waypoint x="2272" y="551" /><di:waypoint x="2320" y="551" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1gfxnih_di" bpmnElement="SequenceFlow_1gfxnih"><di:waypoint x="2132" y="551" /><di:waypoint x="2172" y="551" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ia5rem_di" bpmnElement="SequenceFlow_1ia5rem"><di:waypoint x="1832" y="511" /><di:waypoint x="1832" y="491" /><di:waypoint x="1950" y="491" /><di:waypoint x="1950" y="511" /></bpmndi:BPMNEdge><bpmndi:BPMNShape id="StartEvent_051vfwj_di" bpmnElement="StartEvent_051vfwj"><dc:Bounds x="1652" y="360" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0ah95yq_di" bpmnElement="UserTask_0ah95yq"><dc:Bounds x="1875" y="260" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0qxicem_di" bpmnElement="ExclusiveGateway_0qxicem" isMarkerVisible="true"><dc:Bounds x="2163" y="275" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1nbwlii_di" bpmnElement="ServiceTask_1nbwlii"><dc:Bounds x="2018" y="382" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0899gqm_di" bpmnElement="ServiceTask_0899gqm"><dc:Bounds x="2248" y="148" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1r30pju_di" bpmnElement="ServiceTask_1r30pju"><dc:Bounds x="2248" y="260" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0gfasww_di" bpmnElement="ExclusiveGateway_0gfasww" isMarkerVisible="true"><dc:Bounds x="2383" y="275" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_141k84s_di" bpmnElement="ServiceTask_141k84s"><dc:Bounds x="2458" y="260" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0u13mv6_di" bpmnElement="UserTask_0u13mv6" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="2878" y="260" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ParallelGateway_0qfgwn7_di" bpmnElement="ParallelGateway_0qfgwn7"><dc:Bounds x="1738" y="353" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ReceiveTask_0bu72n4_di" bpmnElement="ReceiveTask_0bu72n4"><dc:Bounds x="2032" y="511" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_0ya9vbf_di" bpmnElement="EndEvent_0ya9vbf"><dc:Bounds x="3078" y="282" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_04a8jwq_di" bpmnElement="EndEvent_04a8jwq"><dc:Bounds x="3078" y="532" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0n6ko4c_di" bpmnElement="ServiceTask_0n6ko4c"><dc:Bounds x="2172" y="511" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_113kbms_di" bpmnElement="ServiceTask_113kbms"><dc:Bounds x="1782" y="511" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0h36s1s_di" bpmnElement="ServiceTask_0h36s1s"><dc:Bounds x="2018" y="260" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1ksumuf_di" bpmnElement="ServiceTask_1ksumuf"><dc:Bounds x="2248" y="410" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1mzpudr_di" bpmnElement="ServiceTask_1mzpudr"><dc:Bounds x="2320" y="511" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_03zfqdd_di" bpmnElement="ServiceTask_03zfqdd"><dc:Bounds x="1900" y="511" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_14b1vg1_di" bpmnElement="ServiceTask_14b1vg1"><dc:Bounds x="1330" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_19d8g4v_di" bpmnElement="ServiceTask_19d8g4v"><dc:Bounds x="1460" y="310" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0imzfr1_di" bpmnElement="ExclusiveGateway_0imzfr1" isMarkerVisible="true"><dc:Bounds x="4945" y="315" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0uu1q8w_di" bpmnElement="ExclusiveGateway_0uu1q8w" isMarkerVisible="true"><dc:Bounds x="5145" y="315" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0u2txyu_di" bpmnElement="ServiceTask_0u2txyu"><dc:Bounds x="5020" y="420" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_10rsflf_di" bpmnElement="ServiceTask_10rsflf"><dc:Bounds x="5020" y="250" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1o2xrw9_di" bpmnElement="ServiceTask_1o2xrw9"><dc:Bounds x="5300" y="400" width="100" height="80" /></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>