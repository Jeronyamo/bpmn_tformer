<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="4.8.1"><bpmn:process id="TEMPLATE_INSTANCE_PROCESS_hlk_app_sms_chng_phone_e9359630-8f1c-4682-bfae-6e303c6ae21a" name="Заявка на изменение номера телефона клиента, подключенного к услуге SMS-подтверждения документов" isExecutable="true"><bpmn:documentation /><bpmn:startEvent id="StartEvent_1"><bpmn:outgoing>SequenceFlow_0or7jn6</bpmn:outgoing></bpmn:startEvent><bpmn:endEvent id="EndEvent_0djl7a3"><bpmn:incoming>SequenceFlow_1pfq7ia</bpmn:incoming></bpmn:endEvent><bpmn:userTask id="Task_0micukk" name="Заполнение заявки на изменение SMS номера" camunda:formKey="FILL" camunda:candidateGroups="cb_clientmanager, cb_directordp, cb_backoffice, jira-users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="fillverify" /></camunda:properties><camunda:formData><camunda:formField id="ezdocObjectUrl" type="string" /><camunda:formField id="ezdocObjectEditorUrl" type="string" /><camunda:formField id="hlk_client_app" label="Клиент" type="string" /><camunda:formField id="hlk_NewPhone" label="Новый номер телефона" type="string" /></camunda:formData><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
data.templateId = templateId;
data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener></bpmn:extensionElements><bpmn:incoming>SequenceFlow_16wp7ax</bpmn:incoming><bpmn:incoming>SequenceFlow_0gmqzip</bpmn:incoming><bpmn:incoming>SequenceFlow_0k1u4lp</bpmn:incoming><bpmn:incoming>SequenceFlow_1ubkdfd</bpmn:incoming><bpmn:outgoing>SequenceFlow_1biea4a</bpmn:outgoing></bpmn:userTask><bpmn:sequenceFlow id="SequenceFlow_0or7jn6" sourceRef="StartEvent_1" targetRef="TaskStatus_Creation" /><bpmn:serviceTask id="ServiceTask_1874kb5" name="Установка статуса &#34;Заполнение заявки&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Заполнение:+Заполнение+заявки</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1mties1</bpmn:incoming><bpmn:outgoing>SequenceFlow_1ss7jpi</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1kxma4u" name="Установка статуса &#34;Исполнена&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Исполнена</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1mddh2m</bpmn:incoming><bpmn:outgoing>SequenceFlow_1prao3e</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1prao3e" sourceRef="ServiceTask_1kxma4u" targetRef="ServiceTask_01i8luq" /><bpmn:serviceTask id="ServiceTask_01i8luq" name="Обновляем номер в договоре"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("hlk_sms_auth_phone",hlk_NewPhone)
.toString()</camunda:script></camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${contract_id}/setAttributes?incrementVersion=false</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1prao3e</bpmn:incoming><bpmn:outgoing>SequenceFlow_0em2q13</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0em2q13" sourceRef="ServiceTask_01i8luq" targetRef="ServiceTask_1b409j5" /><bpmn:serviceTask id="ServiceTask_0n2efx3" name="Получение поля &#34;исходная заявка&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_sms_doc_app</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="hlk_sms_doc_app">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1ss7jpi</bpmn:incoming><bpmn:outgoing>SequenceFlow_0lxgqvm</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0lxgqvm" sourceRef="ServiceTask_0n2efx3" targetRef="Gateway_0nozanw" /><bpmn:sequenceFlow id="SequenceFlow_16wp7ax" sourceRef="Gateway_0nozanw" targetRef="Task_0micukk"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${hlk_sms_doc_app == null || hlk_sms_doc_app == "" || hlk_sms_doc_app == "null"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:exclusiveGateway id="Gateway_0nozanw" default="SequenceFlow_0i8o93e"><bpmn:incoming>SequenceFlow_0lxgqvm</bpmn:incoming><bpmn:outgoing>SequenceFlow_16wp7ax</bpmn:outgoing><bpmn:outgoing>SequenceFlow_0i8o93e</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="SequenceFlow_0i8o93e" sourceRef="Gateway_0nozanw" targetRef="ServiceTask_0j4o5bo" /><bpmn:sequenceFlow id="SequenceFlow_1ss7jpi" sourceRef="ServiceTask_1874kb5" targetRef="ServiceTask_0n2efx3" /><bpmn:serviceTask id="ServiceTask_1t6wkdk" name="Достаем primaryId заявки"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="payload">{
	"find": "book",
	"filter": {
		"_id": ObjectId("${instanceId}")
	},
	"projection": {
		"primaryId": 1
	}
}</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:outputParameter name="primaryId"><camunda:script scriptFormat="javascript">JSON.parse(response).cursor.firstBatch[0].primaryId</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1f6i83c</bpmn:incoming><bpmn:outgoing>SequenceFlow_0dsk6yp</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0dsk6yp" sourceRef="ServiceTask_1t6wkdk" targetRef="ServiceTask_1dpfeu8" /><bpmn:serviceTask id="ServiceTask_1dpfeu8" name="Записываем в объект"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttribute/hlk_app_id?incrementVersion=true&amp;value=${primaryId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0dsk6yp</bpmn:incoming><bpmn:outgoing>SequenceFlow_1mties1</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1mties1" sourceRef="ServiceTask_1dpfeu8" targetRef="ServiceTask_1874kb5" /><bpmn:serviceTask id="ServiceTask_0iuag6i" name="Установка статуса &#34;Зарегистрирована&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Зарегистрирована</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1w6zzx1</bpmn:incoming><bpmn:outgoing>SequenceFlow_1opz674</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1opz674" sourceRef="ServiceTask_0iuag6i" targetRef="CallActivity_17gbhxu" /><bpmn:userTask id="UserTask_0y0cvvk" name="Подтверждение заявки изменения номера телефона, подключенного к услуге SMS" camunda:candidateGroups="cb_headmiddleofice, cb_managermiddleoffice, cb_backoffice, jira-users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;:&#34;confirm&#34;,&#34;label&#34;:&#34;Подтвердить&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /><camunda:formField id="{&#34;id&#34;:&#34;retry&#34;,&#34;label&#34;:&#34;Повторное заполнение&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /><camunda:formField id="{&#34;id&#34;: &#34;cancel&#34;, &#34;label&#34;: &#34;Отказать в подтверждении&#34;, &#34;type&#34;:&#34;fillingParam&#34;,&#34;params&#34;: [ {&#34;name&#34;: &#34;hlk_reason_close&#34;, &#34;label&#34;: &#34;Причина отказа&#34;, &#34;type&#34;: &#34;string&#34;}  ]}" type="string" /><camunda:formField id="{&#34;id&#34;:&#34;arhiv&#34;,&#34;label&#34;:&#34;Архивировать&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0vognlb</bpmn:incoming><bpmn:outgoing>SequenceFlow_1mddh2m</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1511xnn</bpmn:outgoing><bpmn:outgoing>SequenceFlow_176bmih</bpmn:outgoing><bpmn:outgoing>SequenceFlow_059fuyh</bpmn:outgoing></bpmn:userTask><bpmn:sequenceFlow id="SequenceFlow_1mddh2m" sourceRef="UserTask_0y0cvvk" targetRef="ServiceTask_1kxma4u"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'confirm'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1511xnn" sourceRef="UserTask_0y0cvvk" targetRef="ServiceTask_1tbixl0"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'retry'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_1q3llch" name="Получение поля &#34;Новый номер телефона&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_NewPhone</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="hlk_NewPhone">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_17q0fa0</bpmn:incoming><bpmn:outgoing>SequenceFlow_1w47e3j</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1w47e3j" sourceRef="ServiceTask_1q3llch" targetRef="ServiceTask_01v3jks" /><bpmn:serviceTask id="ServiceTask_01v3jks" name="Получение поля &#34;Текущий номер телефона&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_CurrentPhone</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "book",
    "filter": {
        "_id": ObjectId("${instanceId}")
    },
    "projection": {
        "attributes.hlk_CurrentPhone.value": 1
    }
}</camunda:inputParameter><camunda:outputParameter name="hlk_CurrentPhone">JSON.parse(response).cursor.firstBatch[0].attributes.hlk_CurrentPhone.value</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1w47e3j</bpmn:incoming><bpmn:outgoing>SequenceFlow_0lvklua</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0lvklua" sourceRef="ServiceTask_01v3jks" targetRef="ServiceTask_03wkxzn" /><bpmn:exclusiveGateway id="ExclusiveGateway_02tzfni" default="SequenceFlow_15qayel"><bpmn:incoming>SequenceFlow_1cvgtgl</bpmn:incoming><bpmn:outgoing>SequenceFlow_1sc25uv</bpmn:outgoing><bpmn:outgoing>SequenceFlow_15qayel</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="SequenceFlow_1sc25uv" sourceRef="ExclusiveGateway_02tzfni" targetRef="ServiceTask_15xbd42"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${hlk_NewPhone == sms_number}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_15xbd42" name="Установка статуса &#34;Новый номер телефона совпадает с текущим&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Обработка:+Новый+номер+телефона+совпадает+с+текущим</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1sc25uv</bpmn:incoming><bpmn:outgoing>SequenceFlow_0gmqzip</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_15qayel" sourceRef="ExclusiveGateway_02tzfni" targetRef="ServiceTask_06bctdx" /><bpmn:sequenceFlow id="SequenceFlow_0gmqzip" sourceRef="ServiceTask_15xbd42" targetRef="Task_0micukk" /><bpmn:serviceTask id="ServiceTask_06bctdx" name="Проверка на дубли заявки"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{ 	"find": "book", 	"filter": { 		"templatePrimaryId": "5e5bf74ee03dd80007c05269", 		"attributes.hlk_client_app.primaryId": "${hlk_client_app}",  "labelStatus" : "Зарегистрирована","_id": { "$ne": ObjectId("${instanceId}") }}, 	"projection": { 		"_id": 1 	} }</camunda:inputParameter><camunda:outputParameter name="found"><camunda:script scriptFormat="javascript">!!JSON.parse(response).cursor.firstBatch.length</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_15qayel</bpmn:incoming><bpmn:outgoing>SequenceFlow_0yex3u7</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0j4o5bo" name="Получение поля &#34;Текущий номер телефона&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_CurrentPhone</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="hlk_CurrentPhone">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0i8o93e</bpmn:incoming><bpmn:outgoing>SequenceFlow_0yx7ffr</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0yx7ffr" sourceRef="ServiceTask_0j4o5bo" targetRef="ServiceTask_1h2n9rs" /><bpmn:serviceTask id="ServiceTask_1h2n9rs" name="Получение поля &#34;Клиент&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_client_app</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="hlk_client_app">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0yx7ffr</bpmn:incoming><bpmn:outgoing>SequenceFlow_1amgfe1</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1amgfe1" sourceRef="ServiceTask_1h2n9rs" targetRef="ServiceTask_1220wgx" /><bpmn:serviceTask id="ServiceTask_03wkxzn" name="Получение поля &#34;Клиент&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_client_app</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="hlk_client_app">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0lvklua</bpmn:incoming><bpmn:outgoing>SequenceFlow_1gx1efy</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1gx1efy" sourceRef="ServiceTask_03wkxzn" targetRef="ServiceTask_04o9llb" /><bpmn:sequenceFlow id="SequenceFlow_0yex3u7" sourceRef="ServiceTask_06bctdx" targetRef="ExclusiveGateway_0uu6z7l" /><bpmn:serviceTask id="ServiceTask_0ol5cy9" name="Установка статуса &#34;Дублирующая заявка&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Обработка:+Дублирующая+заявка</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_07o6d1f</bpmn:incoming><bpmn:incoming>SequenceFlow_1f0ncyg</bpmn:incoming><bpmn:outgoing>SequenceFlow_0uefohe</bpmn:outgoing></bpmn:serviceTask><bpmn:endEvent id="EndEvent_0m2h7cz"><bpmn:incoming>SequenceFlow_0uefohe</bpmn:incoming></bpmn:endEvent><bpmn:sequenceFlow id="SequenceFlow_0uefohe" sourceRef="ServiceTask_0ol5cy9" targetRef="EndEvent_0m2h7cz" /><bpmn:exclusiveGateway id="ExclusiveGateway_0uu6z7l" default="SequenceFlow_03gz56x"><bpmn:incoming>SequenceFlow_0yex3u7</bpmn:incoming><bpmn:outgoing>SequenceFlow_03gz56x</bpmn:outgoing><bpmn:outgoing>SequenceFlow_07o6d1f</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="SequenceFlow_03gz56x" sourceRef="ExclusiveGateway_0uu6z7l" targetRef="ServiceTask_0mly4g5" /><bpmn:sequenceFlow id="SequenceFlow_07o6d1f" sourceRef="ExclusiveGateway_0uu6z7l" targetRef="ServiceTask_0ol5cy9"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${found == true}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_1tbixl0" name="Установка статуса &#34;Повторное заполнение&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Заполнение:+Повторное+заполнение</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1511xnn</bpmn:incoming><bpmn:incoming>SequenceFlow_01anwp8</bpmn:incoming><bpmn:outgoing>SequenceFlow_0k1u4lp</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0k1u4lp" sourceRef="ServiceTask_1tbixl0" targetRef="Task_0micukk" /><bpmn:serviceTask id="ServiceTask_1220wgx" name="Получение поля &#34;Новый номер телефона&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_NewPhone</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="hlk_NewPhone">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1amgfe1</bpmn:incoming><bpmn:outgoing>SequenceFlow_1344cnl</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1344cnl" sourceRef="ServiceTask_1220wgx" targetRef="ServiceTask_18rnfn7" /><bpmn:callActivity id="CallActivity_17gbhxu" name="Генерация печатной формы " calledElement="FormSMSEdit"><bpmn:extensionElements><camunda:in variables="all" /><camunda:out variables="all" /><camunda:in sourceExpression="${ezdocUrl}" target="ezdocUrl" /></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1opz674</bpmn:incoming><bpmn:outgoing>SequenceFlow_0vognlb</bpmn:outgoing></bpmn:callActivity><bpmn:sequenceFlow id="SequenceFlow_0vognlb" sourceRef="CallActivity_17gbhxu" targetRef="UserTask_0y0cvvk" /><bpmn:sequenceFlow id="SequenceFlow_176bmih" sourceRef="UserTask_0y0cvvk" targetRef="ServiceTask_11d5fvj"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'cancel'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_134maac" name="Проверка на дубли заявки"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{ 	"find": "book", 	"filter": { 		"templatePrimaryId": "5e5bf74ee03dd80007c05269", 		"attributes.hlk_client_app.primaryId": "${hlk_client_app}",  "labelStatus" : "Зарегистрирована","_id": { "$ne": ObjectId("${instanceId}") }}, 	"projection": { 		"_id": 1 	} }</camunda:inputParameter><camunda:outputParameter name="found"><camunda:script scriptFormat="javascript">!!JSON.parse(response).cursor.firstBatch.length</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0q82csz</bpmn:incoming><bpmn:outgoing>SequenceFlow_03ke0fk</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_03ke0fk" sourceRef="ServiceTask_134maac" targetRef="ExclusiveGateway_1yw67nc" /><bpmn:exclusiveGateway id="ExclusiveGateway_1yw67nc" default="SequenceFlow_1p50hyu"><bpmn:incoming>SequenceFlow_03ke0fk</bpmn:incoming><bpmn:outgoing>SequenceFlow_1p50hyu</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1f0ncyg</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="SequenceFlow_1p50hyu" sourceRef="ExclusiveGateway_1yw67nc" targetRef="ServiceTask_0mly4g5" /><bpmn:sequenceFlow id="SequenceFlow_1f0ncyg" sourceRef="ExclusiveGateway_1yw67nc" targetRef="ServiceTask_0ol5cy9"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${found == true}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_18rnfn7" name="Получение данных по договору"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "book",
    "filter": {
        "templatePrimaryId": "5e2ea8e551915100088d013a",
        "attributes.hlk_client_FL.primaryId": "${hlk_client_app}",
        "activityStatus": "ACTIVE"
    },
    "projection": {
        "attributes.hlk_need_sms_confirm": 1,
        "attributes.hlk_sms_auth_phone": 1,
        "_id": 1
    }
}</camunda:inputParameter><camunda:outputParameter name="found"><camunda:script scriptFormat="javascript">!!JSON.parse(response).cursor.firstBatch.length</camunda:script></camunda:outputParameter><camunda:outputParameter name="sms_active"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0].attributes.hlk_need_sms_confirm;
} catch(e) {
false;
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="sms_number"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0].attributes.hlk_sms_auth_phone;
} catch(e) {
"";
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="contract_id"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0]._id;
} catch(e) {
"";
}</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1344cnl</bpmn:incoming><bpmn:outgoing>SequenceFlow_0q82csz</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0q82csz" sourceRef="ServiceTask_18rnfn7" targetRef="ServiceTask_134maac" /><bpmn:serviceTask id="ServiceTask_04o9llb" name="Получение данных по договору"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{
    "find": "book",
    "filter": {
        "templatePrimaryId": "5e2ea8e551915100088d013a",
        "attributes.hlk_client_FL.primaryId": "${hlk_client_app}",
        "activityStatus": "ACTIVE"
    },
    "projection": {
        "attributes.hlk_need_sms_confirm": 1,
        "attributes.hlk_sms_auth_phone": 1,
        "_id": 1
    }
}</camunda:inputParameter><camunda:outputParameter name="found"><camunda:script scriptFormat="javascript">!!JSON.parse(response).cursor.firstBatch.length</camunda:script></camunda:outputParameter><camunda:outputParameter name="sms_active"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0].attributes.hlk_need_sms_confirm;
} catch(e) {
false;
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="sms_number"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0].attributes.hlk_sms_auth_phone;
} catch(e) {
"";
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="contract_id"><camunda:script scriptFormat="javascript">try{
JSON.parse(response).cursor.firstBatch[0]._id;
} catch(e) {
"";
}</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1gx1efy</bpmn:incoming><bpmn:outgoing>SequenceFlow_1cvgtgl</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1cvgtgl" sourceRef="ServiceTask_04o9llb" targetRef="ExclusiveGateway_02tzfni" /><bpmn:serviceTask id="ServiceTask_01zx1ix" name="Получаем аттрибуты"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttributes?systemName=hlk_NewPhone</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="attributes">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1sojqjs</bpmn:incoming><bpmn:outgoing>SequenceFlow_1uvczis</bpmn:outgoing></bpmn:serviceTask><bpmn:scriptTask id="ScriptTask_0h4wcf2" name="Проверяем правильность заполнения" scriptFormat="javascript" camunda:resultVariable="validationErrors"><bpmn:incoming>SequenceFlow_1uvczis</bpmn:incoming><bpmn:outgoing>SequenceFlow_0jzmp4u</bpmn:outgoing><bpmn:script>var attrs = JSON.parse(attributes);
var errors = {};
var mobile_phone_prefix = [700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 747, 750, 751, 760, 761, 762, 763, 764, 771, 775, 776, 777, 778];

//Сами проверки

var flag = 0; 
for (var i = 0; i &lt; mobile_phone_prefix.length; i++) {
  if ( mobile_phone_prefix[i] == attrs.hlk_NewPhone.substring(1,4)) {
	flag=1;
	continue;
  }
} 

if (!flag) {
    errors.hlk_NewPhone = {
        verified: false,
        decision: 'Код мобильного телефона не соответствует справочнику допустимых кодов'
    };
} else {
    errors.hlk_NewPhone = {
        verified: true
    }
}
JSON.stringify(errors);</bpmn:script></bpmn:scriptTask><bpmn:serviceTask id="ServiceTask_1nolhq5" name="Записываем результат валидации"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/verification/${instanceId}</camunda:inputParameter><camunda:inputParameter name="payload">${validationErrors}</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0jzmp4u</bpmn:incoming><bpmn:outgoing>SequenceFlow_04b2dkw</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_1gz23sd" default="SequenceFlow_1ubkdfd"><bpmn:incoming>SequenceFlow_04b2dkw</bpmn:incoming><bpmn:outgoing>SequenceFlow_17q0fa0</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1ubkdfd</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="SequenceFlow_1uvczis" sourceRef="ServiceTask_01zx1ix" targetRef="ScriptTask_0h4wcf2" /><bpmn:sequenceFlow id="SequenceFlow_0jzmp4u" sourceRef="ScriptTask_0h4wcf2" targetRef="ServiceTask_1nolhq5" /><bpmn:sequenceFlow id="SequenceFlow_04b2dkw" sourceRef="ServiceTask_1nolhq5" targetRef="ExclusiveGateway_1gz23sd" /><bpmn:sequenceFlow id="SequenceFlow_1biea4a" sourceRef="Task_0micukk" targetRef="ServiceTask_0zycg84" /><bpmn:sequenceFlow id="SequenceFlow_17q0fa0" sourceRef="ExclusiveGateway_1gz23sd" targetRef="ServiceTask_1q3llch"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression" language="javascript">var verified =true;
var v = JSON.parse(validationErrors);
for (key in v) {
    verified = verified &amp;&amp; v[key].verified; 
}
verified;</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1ubkdfd" sourceRef="ExclusiveGateway_1gz23sd" targetRef="Task_0micukk" /><bpmn:serviceTask id="ServiceTask_0mly4g5" name="Получаем мобильный телефон"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/getAttribute/hlk_NewPhone</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="hlk_mobile_phone">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_03gz56x</bpmn:incoming><bpmn:incoming>SequenceFlow_1p50hyu</bpmn:incoming><bpmn:outgoing>SequenceFlow_1ywkpf3</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0ln0nkf" name="Проверка на уникальность номера телефона"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/common/executeRequest</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload">{ 	"find": "book", 	"filter": 
{
 "$or": 
[		
{
"templatePrimaryId": "5e5bf730e03dd80007c05255", 		
"attributes.hlk_mobile_phone": "${hlk_mobile_phone}",  
"labelStatus" : "Зарегистрирована",
"_id": { "$ne": ObjectId("${instanceId}") }
}, 	
{
"templatePrimaryId": "5e5bf74ee03dd80007c05269", 		
"attributes.hlk_NewPhone": "${hlk_mobile_phone}",  
"labelStatus" : "Зарегистрирована",
"_id": { "$ne": ObjectId("${instanceId}") }
}, 	
{
"templatePrimaryId": "5e2ea8e551915100088d013a", 		
"attributes.hlk_sms_auth_phone": "${hlk_mobile_phone}",  
"status" : "VERIFICATED",
"_id": { "$ne": ObjectId("${instanceId}") }
}
]
},
"projection": { 		"_id": 1 	}
}</camunda:inputParameter><camunda:outputParameter name="found"><camunda:script scriptFormat="javascript">!!JSON.parse(response).cursor.firstBatch.length</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1ywkpf3</bpmn:incoming><bpmn:outgoing>SequenceFlow_171xsup</bpmn:outgoing></bpmn:serviceTask><bpmn:exclusiveGateway id="ExclusiveGateway_07mpa0r" default="SequenceFlow_1w6zzx1"><bpmn:incoming>SequenceFlow_171xsup</bpmn:incoming><bpmn:outgoing>SequenceFlow_0swhudd</bpmn:outgoing><bpmn:outgoing>SequenceFlow_1w6zzx1</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_10pk9be" name="Установка статуса &#34;Мобильный номер не уникален&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Обработка:+Мобильный+номер+не+уникален</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0swhudd</bpmn:incoming><bpmn:outgoing>SequenceFlow_0dpcm16</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1ywkpf3" sourceRef="ServiceTask_0mly4g5" targetRef="ServiceTask_0ln0nkf" /><bpmn:sequenceFlow id="SequenceFlow_171xsup" sourceRef="ServiceTask_0ln0nkf" targetRef="ExclusiveGateway_07mpa0r" /><bpmn:sequenceFlow id="SequenceFlow_0swhudd" sourceRef="ExclusiveGateway_07mpa0r" targetRef="ServiceTask_10pk9be"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${found == true}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1w6zzx1" sourceRef="ExclusiveGateway_07mpa0r" targetRef="ServiceTask_0iuag6i" /><bpmn:userTask id="UserTask_1b4sa5x" name="Подтверждение заявки добавление SMS услуги" camunda:candidateGroups="cb_headmiddleofice, cb_managermiddleoffice,cb_backoffice, jira-users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;:&#34;retry&#34;,&#34;label&#34;:&#34;Повторное заполнение&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /><camunda:formField id="{&#34;id&#34;:&#34;cancel&#34;,&#34;label&#34;:&#34;Отменить заявку&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0dpcm16</bpmn:incoming><bpmn:outgoing>SequenceFlow_0feo9zk</bpmn:outgoing><bpmn:outgoing>SequenceFlow_01anwp8</bpmn:outgoing></bpmn:userTask><bpmn:serviceTask id="ServiceTask_0unlw67" name="Установка статуса &#34;Заявка отклонена&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Обработка:+Заявка+отменена</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0feo9zk</bpmn:incoming><bpmn:outgoing>SequenceFlow_1j26znl</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0feo9zk" sourceRef="UserTask_1b4sa5x" targetRef="ServiceTask_0unlw67"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'cancel'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_0dpcm16" sourceRef="ServiceTask_10pk9be" targetRef="UserTask_1b4sa5x" /><bpmn:sequenceFlow id="SequenceFlow_01anwp8" sourceRef="UserTask_1b4sa5x" targetRef="ServiceTask_1tbixl0"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'retry'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_11d5fvj" name="Установка статуса &#34;Отказано в подтверждении&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Отказано+в+подтверждении</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_176bmih</bpmn:incoming><bpmn:outgoing>SequenceFlow_0yd5ln2</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1he1afd" name="Записываем в объект причину отказа"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/setAttribute/hlk_app_reason_close?incrementVersion=false&amp;value=${hlk_reason_close.replace(" ","+")}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0mrbngq</bpmn:incoming><bpmn:outgoing>SequenceFlow_1g72w7b</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0yd5ln2" sourceRef="ServiceTask_11d5fvj" targetRef="Activity_18k8xto" /><bpmn:userTask id="UserTask_0kx8dge" name="Кнопка &#34;Архивировать&#34;" camunda:candidateGroups="cb_backoffice, cb_frontoffice, cb_middleoffice, jira-users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;:&#34;retry&#34;,&#34;label&#34;:&#34;Архивировать&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1j26znl</bpmn:incoming><bpmn:outgoing>SequenceFlow_1k0de0b</bpmn:outgoing></bpmn:userTask><bpmn:serviceTask id="ServiceTask_1l446xg" name="Архивация"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/archive</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1k0de0b</bpmn:incoming><bpmn:incoming>SequenceFlow_059fuyh</bpmn:incoming><bpmn:outgoing>SequenceFlow_1xlxlsf</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_0pz782q" name="Установка статуса &#34;Архив&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Архив</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_133wgfi</bpmn:incoming><bpmn:outgoing>SequenceFlow_09tfc2k</bpmn:outgoing></bpmn:serviceTask><bpmn:endEvent id="EndEvent_10h3v7e"><bpmn:incoming>SequenceFlow_09tfc2k</bpmn:incoming></bpmn:endEvent><bpmn:sequenceFlow id="SequenceFlow_1k0de0b" sourceRef="UserTask_0kx8dge" targetRef="ServiceTask_1l446xg" /><bpmn:sequenceFlow id="SequenceFlow_1xlxlsf" sourceRef="ServiceTask_1l446xg" targetRef="IntermediateCatchEvent_1575ria" /><bpmn:sequenceFlow id="SequenceFlow_09tfc2k" sourceRef="ServiceTask_0pz782q" targetRef="EndEvent_10h3v7e" /><bpmn:sequenceFlow id="SequenceFlow_059fuyh" sourceRef="UserTask_0y0cvvk" targetRef="ServiceTask_1l446xg"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == 'arhiv'}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_1j26znl" sourceRef="ServiceTask_0unlw67" targetRef="UserTask_0kx8dge" /><bpmn:userTask id="UserTask_0np8kzv" name="Кнопка &#34;Архивировать&#34;" camunda:candidateGroups="cb_backoffice, cb_frontoffice, cb_middleoffice, jira-users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;:&#34;retry&#34;,&#34;label&#34;:&#34;Архивировать&#34;,&#34;type&#34;:&#34;simple&#34;}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1g72w7b</bpmn:incoming><bpmn:outgoing>SequenceFlow_0gs7exy</bpmn:outgoing></bpmn:userTask><bpmn:serviceTask id="ServiceTask_10o5dbq" name="Архивация"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${instanceId}/archive</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0gs7exy</bpmn:incoming><bpmn:outgoing>SequenceFlow_0cl9wpu</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_00659gq" name="Установка статуса &#34;Архив&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Архив</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1e5tix7</bpmn:incoming><bpmn:outgoing>SequenceFlow_1mokski</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0gs7exy" sourceRef="UserTask_0np8kzv" targetRef="ServiceTask_10o5dbq" /><bpmn:sequenceFlow id="SequenceFlow_0cl9wpu" sourceRef="ServiceTask_10o5dbq" targetRef="IntermediateCatchEvent_06vyigr" /><bpmn:sequenceFlow id="SequenceFlow_1g72w7b" sourceRef="ServiceTask_1he1afd" targetRef="UserTask_0np8kzv" /><bpmn:endEvent id="EndEvent_0z7ukki"><bpmn:incoming>SequenceFlow_1mokski</bpmn:incoming></bpmn:endEvent><bpmn:sequenceFlow id="SequenceFlow_1mokski" sourceRef="ServiceTask_00659gq" targetRef="EndEvent_0z7ukki" /><bpmn:intermediateCatchEvent id="IntermediateCatchEvent_1575ria"><bpmn:incoming>SequenceFlow_1xlxlsf</bpmn:incoming><bpmn:outgoing>SequenceFlow_133wgfi</bpmn:outgoing><bpmn:timerEventDefinition id="TimerEventDefinition_1xdcenu"><bpmn:timeDuration xsi:type="bpmn:tFormalExpression">PT5S</bpmn:timeDuration></bpmn:timerEventDefinition></bpmn:intermediateCatchEvent><bpmn:sequenceFlow id="SequenceFlow_133wgfi" sourceRef="IntermediateCatchEvent_1575ria" targetRef="ServiceTask_0pz782q" /><bpmn:intermediateCatchEvent id="IntermediateCatchEvent_06vyigr"><bpmn:incoming>SequenceFlow_0cl9wpu</bpmn:incoming><bpmn:outgoing>SequenceFlow_1e5tix7</bpmn:outgoing><bpmn:timerEventDefinition id="TimerEventDefinition_02cwf0l"><bpmn:timeDuration xsi:type="bpmn:tFormalExpression">PT5S</bpmn:timeDuration></bpmn:timerEventDefinition></bpmn:intermediateCatchEvent><bpmn:sequenceFlow id="SequenceFlow_1e5tix7" sourceRef="IntermediateCatchEvent_06vyigr" targetRef="ServiceTask_00659gq" /><bpmn:serviceTask id="TaskStatus_Creation" name="Установка статуса &#34;Создание заявки&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Обработка:+Создание+заявки</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0or7jn6</bpmn:incoming><bpmn:outgoing>SequenceFlow_1f6i83c</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1f6i83c" sourceRef="TaskStatus_Creation" targetRef="ServiceTask_1t6wkdk" /><bpmn:serviceTask id="ServiceTask_0zycg84" name="Установка статуса &#34;Обработка: Регистрация заявки&#34;"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/saveLabel/${instanceId}?label=Обработка:+Регистрация+заявки</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1biea4a</bpmn:incoming><bpmn:outgoing>SequenceFlow_1sojqjs</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1sojqjs" sourceRef="ServiceTask_0zycg84" targetRef="ServiceTask_01zx1ix" /><bpmn:serviceTask id="ServiceTask_1b409j5" name="Сброс в ФЛ признака отправки в фокус и терминал"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/book/${contract_id}/setAttributes?incrementVersion=false</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="payload"><camunda:script scriptFormat="javascript">S("{}")
.prop("export_terminal", false)
.toString()</camunda:script></camunda:inputParameter><camunda:outputParameter name="rrr">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0em2q13</bpmn:incoming><bpmn:outgoing>SequenceFlow_1pfq7ia</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1pfq7ia" sourceRef="ServiceTask_1b409j5" targetRef="EndEvent_0djl7a3" /><bpmn:scriptTask id="Activity_18k8xto" name="Декодируем url для отправки причины отклонения" scriptFormat="groovy" camunda:resultVariable="hlk_reason_close"><bpmn:incoming>SequenceFlow_0yd5ln2</bpmn:incoming><bpmn:outgoing>Flow_0mrbngq</bpmn:outgoing><bpmn:script>import groovy.*

def hlk_reason_close = execution.getVariable("hlk_reason_close")

hlk_reason_return = java.net.URLEncoder.encode(hlk_reason_close, "UTF-8")</bpmn:script></bpmn:scriptTask><bpmn:sequenceFlow id="Flow_0mrbngq" sourceRef="Activity_18k8xto" targetRef="ServiceTask_1he1afd" /></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="TEMPLATE_INSTANCE_PROCESS_hlk_app_sms_chng_phone_e9359630-8f1c-4682-bfae-6e303c6ae21a"><bpmndi:BPMNEdge id="Flow_0mrbngq_di" bpmnElement="Flow_0mrbngq"><di:waypoint x="2600" y="639" /><di:waypoint x="2600" y="700" /><di:waypoint x="2740" y="700" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1pfq7ia_di" bpmnElement="SequenceFlow_1pfq7ia"><di:waypoint x="3150" y="348" /><di:waypoint x="3260" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1sojqjs_di" bpmnElement="SequenceFlow_1sojqjs"><di:waypoint x="1188" y="230" /><di:waypoint x="1206" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1f6i83c_di" bpmnElement="SequenceFlow_1f6i83c"><di:waypoint x="342" y="348" /><di:waypoint x="391" y="348" /><bpmndi:BPMNLabel><dc:Bounds x="211.5" y="327" width="0" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1e5tix7_di" bpmnElement="SequenceFlow_1e5tix7"><di:waypoint x="3158" y="599" /><di:waypoint x="3228" y="599" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_133wgfi_di" bpmnElement="SequenceFlow_133wgfi"><di:waypoint x="3067" y="230" /><di:waypoint x="3107" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1mokski_di" bpmnElement="SequenceFlow_1mokski"><di:waypoint x="3328" y="599" /><di:waypoint x="3372" y="599" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1g72w7b_di" bpmnElement="SequenceFlow_1g72w7b"><di:waypoint x="2790" y="660" /><di:waypoint x="2790" y="599" /><di:waypoint x="2870" y="599" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0cl9wpu_di" bpmnElement="SequenceFlow_0cl9wpu"><di:waypoint x="3090" y="599" /><di:waypoint x="3122" y="599" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0gs7exy_di" bpmnElement="SequenceFlow_0gs7exy"><di:waypoint x="2970" y="599" /><di:waypoint x="2990" y="599" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1j26znl_di" bpmnElement="SequenceFlow_1j26znl"><di:waypoint x="2630" y="217" /><di:waypoint x="2769" y="217" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_059fuyh_di" bpmnElement="SequenceFlow_059fuyh"><di:waypoint x="2727" y="308" /><di:waypoint x="2727" y="291" /><di:waypoint x="2935" y="291" /><di:waypoint x="2935" y="270" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_09tfc2k_di" bpmnElement="SequenceFlow_09tfc2k"><di:waypoint x="3207" y="230" /><di:waypoint x="3260" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1xlxlsf_di" bpmnElement="SequenceFlow_1xlxlsf"><di:waypoint x="3003" y="230" /><di:waypoint x="3031" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1k0de0b_di" bpmnElement="SequenceFlow_1k0de0b"><di:waypoint x="2869" y="230" /><di:waypoint x="2903" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0yd5ln2_di" bpmnElement="SequenceFlow_0yd5ln2"><di:waypoint x="2687" y="523" /><di:waypoint x="2687" y="599" /><di:waypoint x="2650" y="599" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_01anwp8_di" bpmnElement="SequenceFlow_01anwp8"><di:waypoint x="2443" y="190" /><di:waypoint x="2443" y="117" /><di:waypoint x="1464" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0dpcm16_di" bpmnElement="SequenceFlow_0dpcm16"><di:waypoint x="2360" y="229" /><di:waypoint x="2393" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0feo9zk_di" bpmnElement="SequenceFlow_0feo9zk"><di:waypoint x="2493" y="230" /><di:waypoint x="2530" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1w6zzx1_di" bpmnElement="SequenceFlow_1w6zzx1"><di:waypoint x="2335" y="348" /><di:waypoint x="2393" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0swhudd_di" bpmnElement="SequenceFlow_0swhudd"><di:waypoint x="2310" y="323" /><di:waypoint x="2310" y="266" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_171xsup_di" bpmnElement="SequenceFlow_171xsup"><di:waypoint x="2262" y="348" /><di:waypoint x="2285" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ywkpf3_di" bpmnElement="SequenceFlow_1ywkpf3"><di:waypoint x="2121" y="348" /><di:waypoint x="2162" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ubkdfd_di" bpmnElement="SequenceFlow_1ubkdfd"><di:waypoint x="1589" y="255" /><di:waypoint x="1589" y="280" /><di:waypoint x="1095" y="280" /><di:waypoint x="1095" y="308" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_17q0fa0_di" bpmnElement="SequenceFlow_17q0fa0"><di:waypoint x="1614" y="230" /><di:waypoint x="1634" y="230" /><di:waypoint x="1634" y="290" /><di:waypoint x="1256" y="290" /><di:waypoint x="1256" y="308" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1biea4a_di" bpmnElement="SequenceFlow_1biea4a"><di:waypoint x="1072" y="308" /><di:waypoint x="1072" y="230" /><di:waypoint x="1088" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_04b2dkw_di" bpmnElement="SequenceFlow_04b2dkw"><di:waypoint x="1549" y="230" /><di:waypoint x="1564" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0jzmp4u_di" bpmnElement="SequenceFlow_0jzmp4u"><di:waypoint x="1429" y="230" /><di:waypoint x="1449" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1uvczis_di" bpmnElement="SequenceFlow_1uvczis"><di:waypoint x="1306" y="230" /><di:waypoint x="1329" y="230" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1cvgtgl_di" bpmnElement="SequenceFlow_1cvgtgl"><di:waypoint x="1693" y="348" /><di:waypoint x="1711" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0q82csz_di" bpmnElement="SequenceFlow_0q82csz"><di:waypoint x="1567" y="579" /><di:waypoint x="1791" y="579" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1f0ncyg_di" bpmnElement="SequenceFlow_1f0ncyg"><di:waypoint x="1942" y="554" /><di:waypoint x="1942" y="495" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1p50hyu_di" bpmnElement="SequenceFlow_1p50hyu"><di:waypoint x="1967" y="579" /><di:waypoint x="2071" y="579" /><di:waypoint x="2071" y="388" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_03ke0fk_di" bpmnElement="SequenceFlow_03ke0fk"><di:waypoint x="1891" y="579" /><di:waypoint x="1917" y="579" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_176bmih_di" bpmnElement="SequenceFlow_176bmih"><di:waypoint x="2687" y="388" /><di:waypoint x="2687" y="443" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0vognlb_di" bpmnElement="SequenceFlow_0vognlb"><di:waypoint x="2614" y="348" /><di:waypoint x="2637" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1344cnl_di" bpmnElement="SequenceFlow_1344cnl"><di:waypoint x="1434" y="579" /><di:waypoint x="1467" y="579" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0k1u4lp_di" bpmnElement="SequenceFlow_0k1u4lp"><di:waypoint x="1364" y="120" /><di:waypoint x="1059" y="120" /><di:waypoint x="1059" y="308" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_07o6d1f_di" bpmnElement="SequenceFlow_07o6d1f"><di:waypoint x="1942" y="373" /><di:waypoint x="1942" y="415" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_03gz56x_di" bpmnElement="SequenceFlow_03gz56x"><di:waypoint x="1967" y="348" /><di:waypoint x="2021" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0uefohe_di" bpmnElement="SequenceFlow_0uefohe"><di:waypoint x="1992" y="455" /><di:waypoint x="2023" y="455" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0yex3u7_di" bpmnElement="SequenceFlow_0yex3u7"><di:waypoint x="1891" y="348" /><di:waypoint x="1917" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1gx1efy_di" bpmnElement="SequenceFlow_1gx1efy"><di:waypoint x="1567" y="348" /><di:waypoint x="1593" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1amgfe1_di" bpmnElement="SequenceFlow_1amgfe1"><di:waypoint x="1306" y="579" /><di:waypoint x="1334" y="579" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0yx7ffr_di" bpmnElement="SequenceFlow_0yx7ffr"><di:waypoint x="1109" y="579" /><di:waypoint x="1206" y="579" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0gmqzip_di" bpmnElement="SequenceFlow_0gmqzip"><di:waypoint x="1334" y="455" /><di:waypoint x="1059" y="455" /><di:waypoint x="1059" y="388" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_15qayel_di" bpmnElement="SequenceFlow_15qayel"><di:waypoint x="1761" y="348" /><di:waypoint x="1791" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1sc25uv_di" bpmnElement="SequenceFlow_1sc25uv"><di:waypoint x="1736" y="373" /><di:waypoint x="1736" y="455" /><di:waypoint x="1434" y="455" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0lvklua_di" bpmnElement="SequenceFlow_0lvklua"><di:waypoint x="1434" y="348" /><di:waypoint x="1467" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1w47e3j_di" bpmnElement="SequenceFlow_1w47e3j"><di:waypoint x="1306" y="348" /><di:waypoint x="1334" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1511xnn_di" bpmnElement="SequenceFlow_1511xnn"><di:waypoint x="2699" y="308" /><di:waypoint x="2699" y="120" /><di:waypoint x="1464" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1mddh2m_di" bpmnElement="SequenceFlow_1mddh2m"><di:waypoint x="2737" y="348" /><di:waypoint x="2762" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1opz674_di" bpmnElement="SequenceFlow_1opz674"><di:waypoint x="2493" y="348" /><di:waypoint x="2514" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1mties1_di" bpmnElement="SequenceFlow_1mties1"><di:waypoint x="621" y="348" /><di:waypoint x="658" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0dsk6yp_di" bpmnElement="SequenceFlow_0dsk6yp"><di:waypoint x="491" y="348" /><di:waypoint x="521" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1ss7jpi_di" bpmnElement="SequenceFlow_1ss7jpi"><di:waypoint x="758" y="348" /><di:waypoint x="800" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0i8o93e_di" bpmnElement="SequenceFlow_0i8o93e"><di:waypoint x="955" y="373" /><di:waypoint x="955" y="579" /><di:waypoint x="1009" y="579" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_16wp7ax_di" bpmnElement="SequenceFlow_16wp7ax"><di:waypoint x="980" y="348" /><di:waypoint x="1009" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0lxgqvm_di" bpmnElement="SequenceFlow_0lxgqvm"><di:waypoint x="900" y="348" /><di:waypoint x="930" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0em2q13_di" bpmnElement="SequenceFlow_0em2q13"><di:waypoint x="3003" y="348" /><di:waypoint x="3050" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1prao3e_di" bpmnElement="SequenceFlow_1prao3e"><di:waypoint x="2862" y="348" /><di:waypoint x="2903" y="348" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0or7jn6_di" bpmnElement="SequenceFlow_0or7jn6"><di:waypoint x="192" y="348" /><di:waypoint x="242" y="348" /><bpmndi:BPMNLabel><dc:Bounds x="17" y="327" width="90" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds x="156" y="330" width="36" height="36" /><bpmndi:BPMNLabel><dc:Bounds x="-26" y="366" width="90" height="20" /></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_0djl7a3_di" bpmnElement="EndEvent_0djl7a3"><dc:Bounds x="3260" y="330" width="36" height="36" /><bpmndi:BPMNLabel><dc:Bounds x="1064" y="142" width="90" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_1quc7do_di" bpmnElement="Task_0micukk" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="1009" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1874kb5_di" bpmnElement="ServiceTask_1874kb5" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="658" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1kxma4u_di" bpmnElement="ServiceTask_1kxma4u" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="2762" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_01i8luq_di" bpmnElement="ServiceTask_01i8luq"><dc:Bounds x="2903" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0n2efx3_di" bpmnElement="ServiceTask_0n2efx3"><dc:Bounds x="800" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0r7xs60_di" bpmnElement="Gateway_0nozanw" isMarkerVisible="true"><dc:Bounds x="930" y="323" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1t6wkdk_di" bpmnElement="ServiceTask_1t6wkdk"><dc:Bounds x="391" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1dpfeu8_di" bpmnElement="ServiceTask_1dpfeu8"><dc:Bounds x="521" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0iuag6i_di" bpmnElement="ServiceTask_0iuag6i" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="2393" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0y0cvvk_di" bpmnElement="UserTask_0y0cvvk" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="2637" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1q3llch_di" bpmnElement="ServiceTask_1q3llch"><dc:Bounds x="1206" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_01v3jks_di" bpmnElement="ServiceTask_01v3jks"><dc:Bounds x="1334" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_02tzfni_di" bpmnElement="ExclusiveGateway_02tzfni" isMarkerVisible="true"><dc:Bounds x="1711" y="323" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_15xbd42_di" bpmnElement="ServiceTask_15xbd42" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="1334" y="415" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_06bctdx_di" bpmnElement="ServiceTask_06bctdx"><dc:Bounds x="1791" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0j4o5bo_di" bpmnElement="ServiceTask_0j4o5bo"><dc:Bounds x="1009" y="539" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1h2n9rs_di" bpmnElement="ServiceTask_1h2n9rs"><dc:Bounds x="1206" y="539" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_03wkxzn_di" bpmnElement="ServiceTask_03wkxzn"><dc:Bounds x="1467" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0ol5cy9_di" bpmnElement="ServiceTask_0ol5cy9" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="1892" y="415" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_0m2h7cz_di" bpmnElement="EndEvent_0m2h7cz"><dc:Bounds x="2023" y="437" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_0uu6z7l_di" bpmnElement="ExclusiveGateway_0uu6z7l" isMarkerVisible="true"><dc:Bounds x="1917" y="323" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1tbixl0_di" bpmnElement="ServiceTask_1tbixl0"><dc:Bounds x="1364" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1220wgx_di" bpmnElement="ServiceTask_1220wgx"><dc:Bounds x="1334" y="539" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="CallActivity_17gbhxu_di" bpmnElement="CallActivity_17gbhxu" bioc:stroke="rgb(30, 136, 229)" bioc:fill="rgb(187, 222, 251)"><dc:Bounds x="2514" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_134maac_di" bpmnElement="ServiceTask_134maac"><dc:Bounds x="1791" y="539" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_1yw67nc_di" bpmnElement="ExclusiveGateway_1yw67nc" isMarkerVisible="true"><dc:Bounds x="1917" y="554" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_18rnfn7_di" bpmnElement="ServiceTask_18rnfn7"><dc:Bounds x="1467" y="539" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_04o9llb_di" bpmnElement="ServiceTask_04o9llb"><dc:Bounds x="1593" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_01zx1ix_di" bpmnElement="ServiceTask_01zx1ix"><dc:Bounds x="1206" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ScriptTask_0h4wcf2_di" bpmnElement="ScriptTask_0h4wcf2"><dc:Bounds x="1329" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1nolhq5_di" bpmnElement="ServiceTask_1nolhq5"><dc:Bounds x="1449" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_1gz23sd_di" bpmnElement="ExclusiveGateway_1gz23sd" isMarkerVisible="true"><dc:Bounds x="1564" y="205" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0mly4g5_di" bpmnElement="ServiceTask_0mly4g5"><dc:Bounds x="2021" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0ln0nkf_di" bpmnElement="ServiceTask_0ln0nkf"><dc:Bounds x="2162" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_07mpa0r_di" bpmnElement="ExclusiveGateway_07mpa0r" isMarkerVisible="true"><dc:Bounds x="2285" y="323" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_10pk9be_di" bpmnElement="ServiceTask_10pk9be" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="2260" y="186" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_1b4sa5x_di" bpmnElement="UserTask_1b4sa5x" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="2393" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0unlw67_di" bpmnElement="ServiceTask_0unlw67"><dc:Bounds x="2530" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_11d5fvj_di" bpmnElement="ServiceTask_11d5fvj" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="2637" y="443" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1he1afd_di" bpmnElement="ServiceTask_1he1afd"><dc:Bounds x="2740" y="660" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0kx8dge_di" bpmnElement="UserTask_0kx8dge" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="2769" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1l446xg_di" bpmnElement="ServiceTask_1l446xg"><dc:Bounds x="2903" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0pz782q_di" bpmnElement="ServiceTask_0pz782q" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="3107" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_10h3v7e_di" bpmnElement="EndEvent_10h3v7e"><dc:Bounds x="3260" y="212" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0np8kzv_di" bpmnElement="UserTask_0np8kzv" bioc:stroke="rgb(67, 160, 71)" bioc:fill="rgb(200, 230, 201)"><dc:Bounds x="2870" y="559" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_10o5dbq_di" bpmnElement="ServiceTask_10o5dbq"><dc:Bounds x="2990" y="559" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_00659gq_di" bpmnElement="ServiceTask_00659gq" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="3228" y="559" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="EndEvent_0z7ukki_di" bpmnElement="EndEvent_0z7ukki"><dc:Bounds x="3372" y="581" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="IntermediateCatchEvent_1575ria_di" bpmnElement="IntermediateCatchEvent_1575ria"><dc:Bounds x="3031" y="212" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="IntermediateCatchEvent_06vyigr_di" bpmnElement="IntermediateCatchEvent_06vyigr"><dc:Bounds x="3122" y="581" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0dz7f09_di" bpmnElement="TaskStatus_Creation" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="242" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0zycg84_di" bpmnElement="ServiceTask_0zycg84" bioc:stroke="rgb(251, 140, 0)" bioc:fill="rgb(255, 224, 178)"><dc:Bounds x="1088" y="190" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1b409j5_di" bpmnElement="ServiceTask_1b409j5"><dc:Bounds x="3050" y="308" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_18k8xto_di" bpmnElement="Activity_18k8xto"><dc:Bounds x="2550" y="559" width="100" height="80" /></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>