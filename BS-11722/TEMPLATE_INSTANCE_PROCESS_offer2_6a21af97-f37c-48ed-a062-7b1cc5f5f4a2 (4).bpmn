<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="4.2.0"><bpmn:process id="TEMPLATE_INSTANCE_PROCESS_offer2_6a21af97-f37c-48ed-a062-7b1cc5f5f4a2" name="TEMPLATE_INSTANCE_PROCESS_offer2_6a21af97-f37c-48ed-a062-7b1cc5f5f4a2" isExecutable="true"><bpmn:documentation>{"path":["PROFIT_CENTER"],"name":"Предложение 2"}</bpmn:documentation><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="url">http://gpbinst-ez/api/offer/recalculate-offer?offerId=${instanceId}</camunda:inputParameter></camunda:inputOutput></camunda:connector></bpmn:extensionElements><bpmn:startEvent id="StartEvent_1"><bpmn:outgoing>SequenceFlow_0or7jn6</bpmn:outgoing></bpmn:startEvent><bpmn:endEvent id="EndEvent_0djl7a3"><bpmn:incoming>SequenceFlow_049okmm</bpmn:incoming></bpmn:endEvent><bpmn:sequenceFlow id="SequenceFlow_0or7jn6" sourceRef="StartEvent_1" targetRef="Activity_0wgw6h8" /><bpmn:sequenceFlow id="SequenceFlow_049okmm" sourceRef="Task_1ujk4ck" targetRef="EndEvent_0djl7a3" /><bpmn:serviceTask id="Task_1ujk4ck" name="Сообщаем об окончании процесса"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/profit-center/processCompleted/${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1nd8j3u</bpmn:incoming><bpmn:outgoing>SequenceFlow_049okmm</bpmn:outgoing></bpmn:serviceTask><bpmn:serviceTask id="ServiceTask_1twgz9c" name="Выставление &#34;Даты продажи&#34;"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/offer/setup-sell-date?offerId=${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_05vltot</bpmn:incoming><bpmn:incoming>SequenceFlow_054e6nm</bpmn:incoming><bpmn:incoming>Flow_0rjzaw6</bpmn:incoming><bpmn:outgoing>SequenceFlow_1nd8j3u</bpmn:outgoing></bpmn:serviceTask><bpmn:userTask id="UserTask_0atfrph" name="Статусы" camunda:candidateGroups="app-asa-usr, app-asa-bus, app-asa-adm, jira-users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="buttons" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="{&#34;id&#34;:&#34;agree&#34;,&#34;label&#34;:&#34;Согласен&#34;,&#34;type&#34;:&#34;dialog&#34;,&#34;params&#34;: { &#34;dialogMessage&#34;: &#34;Вы уверены в выборе статуса? Дальнейшее изменение статуса невозможно!&#34;, &#34;dialogOkButton&#34; : &#34;Да, уверен&#34;, &#34;dialogCancelButton&#34;: &#34;Отмена&#34; }}" type="string" /><camunda:formField id="{&#34;id&#34;:&#34;pagree&#34;,&#34;label&#34;:&#34;Частично согласен&#34;,&#34;type&#34;:&#34;dialog&#34;,&#34;params&#34;: { &#34;dialogMessage&#34;: &#34;Укажите, пожалуйста, оформленные Клиентом продукты в таблице \&#34;Оформленные продукты\&#34;&#34;, &#34;dialogOkButton&#34; : &#34;Ок&#34;, &#34;dialogCancelButton&#34;: &#34;Отмена&#34; }}" type="string" /><camunda:formField id="{&#34;id&#34;:&#34;refuse&#34;,&#34;label&#34;:&#34;Отказ&#34;,&#34;type&#34;:&#34;dialog&#34;,&#34;params&#34;: { &#34;dialogMessage&#34;: &#34;Вы уверены в выборе статуса? Дальнейшее изменение статуса невозможно!&#34;, &#34;dialogOkButton&#34; : &#34;Да, уверен&#34;, &#34;dialogCancelButton&#34;: &#34;Отмена&#34; }}" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>Flow_1v2zdj9</bpmn:incoming><bpmn:outgoing>SequenceFlow_1fidi66</bpmn:outgoing></bpmn:userTask><bpmn:sequenceFlow id="SequenceFlow_1fidi66" sourceRef="UserTask_0atfrph" targetRef="Gateway_0ewpioj" /><bpmn:exclusiveGateway id="Gateway_0ewpioj"><bpmn:incoming>SequenceFlow_1fidi66</bpmn:incoming><bpmn:outgoing>SequenceFlow_1o4099i</bpmn:outgoing><bpmn:outgoing>SequenceFlow_0hkcpho</bpmn:outgoing><bpmn:outgoing>SequenceFlow_162vbdb</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:serviceTask id="ServiceTask_1p12lhg" name="Полностью согласен"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/profit-center/${instanceId}/setAttribute/Port_status/?value=%D0%A1%D0%BE%D0%B3%D0%BB%D0%B0%D1%81%D0%B5%D0%BD%20%D0%BF%D0%BE%D0%BB%D0%BD%D0%BE%D1%81%D1%82%D1%8C%D1%8E</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1o4099i</bpmn:incoming><bpmn:outgoing>SequenceFlow_05vltot</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1o4099i" sourceRef="Gateway_0ewpioj" targetRef="ServiceTask_1p12lhg"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == "agree"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:serviceTask id="ServiceTask_19pm05a" name="Частично согласен"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/profit-center/${instanceId}/setAttribute/Port_status/?value=%D0%A7%D0%B0%D1%81%D1%82%D0%B8%D1%87%D0%BD%D0%BE%20%D1%81%D0%BE%D0%B3%D0%BB%D0%B0%D1%81%D0%B5%D0%BD</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0ngjy38</bpmn:incoming><bpmn:incoming>Flow_0htgwnl</bpmn:incoming><bpmn:outgoing>Flow_0rjzaw6</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0hkcpho" sourceRef="Gateway_0ewpioj" targetRef="Activity_00kxf3z"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == "pagree"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_05vltot" sourceRef="ServiceTask_1p12lhg" targetRef="ServiceTask_1twgz9c" /><bpmn:sequenceFlow id="SequenceFlow_1nd8j3u" sourceRef="ServiceTask_1twgz9c" targetRef="Task_1ujk4ck" /><bpmn:serviceTask id="ServiceTask_0wyw1c2" name="Отказ"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/profit-center/${instanceId}/setAttribute/Port_status/?value=%D0%9E%D1%82%D0%BA%D0%B0%D0%B7</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_162vbdb</bpmn:incoming><bpmn:outgoing>SequenceFlow_0tvb0if</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_162vbdb" sourceRef="Gateway_0ewpioj" targetRef="ServiceTask_0wyw1c2"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${buttonId == "refuse"}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="SequenceFlow_0tvb0if" sourceRef="ServiceTask_0wyw1c2" targetRef="ServiceTask_1ty8ze2" /><bpmn:userTask id="UserTask_0za42ik" name="Частично согласен" camunda:formKey="FILL" camunda:assignee="${initiator}" camunda:candidateGroups="app-asa-usr, app-asa-bus, app-asa-adm, jira-users"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocTask" value="true" /><camunda:property name="ezdocTaskType" value="fillverify" /></camunda:properties><camunda:taskListener event="create"><camunda:script scriptFormat="javascript">try {
              var formData = task.execution.processEngineServices.formService.getTaskFormData(task.id);
              var data = {};
              data.taskId = task.id;
              data.templateId = templateId;
              data.formKey = formData.formKey;
              var formFields = [];
              formData.formFields.forEach(function (a) {formFields.push(a.id)});
              data.formFields = formFields;

              httpPost(ezdocUrl + "/api/camunda/common/taskNotify?type=" + type + "&amp;instanceId=" + instanceId, JSON.stringify(data));
              }
              catch(error) {}

              /*************
              UTILITY FUNCTIONS
              *************/
              function httpPost(e,t,n){n=n||"application/json;charset=UTF-8";var a=new java.net.URL(e).openConnection();return a.requestMethod="POST",a.setRequestProperty("Content-Type",n),a.setRequestProperty("Accept-Charset", "UTF-8"),a.doOutput=!0,write(a.outputStream,t),asResponse(a)}function asResponse(e){return{data:read(e.inputStream),statusCode:e.responseCode}}function write(e,t){var n=new java.io.DataOutputStream(e);n.writeChars(t),n.flush(),n.close()}function read(e){for(var t,n=new java.io.BufferedReader(new java.io.InputStreamReader(e)),a=new java.lang.StringBuffer;null!=(t=n.readLine());)a.append(t);return n.close(),a.toString()}</camunda:script></camunda:taskListener><camunda:formData><camunda:formField id="offer_agree" label="Частично согласен" type="string" /></camunda:formData></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0vx13u7</bpmn:incoming><bpmn:incoming>Flow_06gbo6o</bpmn:incoming><bpmn:outgoing>SequenceFlow_1qprfcd</bpmn:outgoing></bpmn:userTask><bpmn:serviceTask id="ServiceTask_0y9tntx" name="Перерасчет" camunda:asyncBefore="true"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/offer/recalculate-offer?offerId=${instanceId}</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1yhpitw</bpmn:incoming><bpmn:outgoing>SequenceFlow_1jm0v3s</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_1qprfcd" sourceRef="UserTask_0za42ik" targetRef="ServiceTask_1ve2fvh" /><bpmn:serviceTask id="ServiceTask_1ve2fvh" name="Получение таблицы оформленных продуктов" camunda:asyncBefore="true" camunda:asyncAfter="true"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/profit-center/${instanceId}/getAttribute/offer_agree</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="offer_agree">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_1qprfcd</bpmn:incoming><bpmn:outgoing>SequenceFlow_0g21dwa</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_0g21dwa" sourceRef="ServiceTask_1ve2fvh" targetRef="Gateway_03r6atj" /><bpmn:sequenceFlow id="SequenceFlow_1yhpitw" sourceRef="Gateway_03r6atj" targetRef="ServiceTask_0y9tntx"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression" language="groovy">import static org.camunda.spin.Spin.*;

def notEmpty = false
if (execution.hasVariable("offer_agree") &amp;&amp; execution.getVariable("offer_agree") != null &amp;&amp; !execution.getVariable("offer_agree").isEmpty()) {
    def json = JSON(execution.getVariable("offer_agree"))
    notEmpty = json.isArray() &amp;&amp; !json.elements().isEmpty()
}
notEmpty</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:exclusiveGateway id="Gateway_03r6atj"><bpmn:incoming>SequenceFlow_0g21dwa</bpmn:incoming><bpmn:outgoing>SequenceFlow_1yhpitw</bpmn:outgoing><bpmn:outgoing>SequenceFlow_0vx13u7</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="SequenceFlow_0vx13u7" sourceRef="Gateway_03r6atj" targetRef="UserTask_0za42ik" /><bpmn:serviceTask id="ServiceTask_1ty8ze2" name="Выставление суммы вложений"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/api/camunda/instance/profit-center/${instanceId}/setAttribute/Port_chSumm?value=0</camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0tvb0if</bpmn:incoming><bpmn:outgoing>SequenceFlow_054e6nm</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="SequenceFlow_054e6nm" sourceRef="ServiceTask_1ty8ze2" targetRef="ServiceTask_1twgz9c" /><bpmn:sequenceFlow id="Flow_06gbo6o" sourceRef="Activity_00kxf3z" targetRef="UserTask_0za42ik" /><bpmn:serviceTask id="Activity_00kxf3z" name="Установка идентификатора печатной формы"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/offer/get-print-template-id?historyId=722f5ff4-0a07-410a-ac7a-10ecb83e8103</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="CamundaUser">${lastUser}</camunda:entry><camunda:entry key="Accept">*/*</camunda:entry></camunda:map></camunda:inputParameter><camunda:outputParameter name="partAgreeTemplateId">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0hkcpho</bpmn:incoming><bpmn:outgoing>Flow_06gbo6o</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0rjzaw6" sourceRef="ServiceTask_19pm05a" targetRef="ServiceTask_1twgz9c" /><bpmn:sequenceFlow id="Flow_16432wy" sourceRef="Activity_0bw4svw" targetRef="Event_1y65i0e" /><bpmn:serviceTask id="Activity_0bw4svw" name="Добавляем печатку в очередь" camunda:asyncBefore="true"><bpmn:extensionElements><camunda:connector><camunda:inputOutput><camunda:inputParameter name="url">${ezdocUrl}/api/offer/make-offer-recalc-report?profitCenterId=${instanceId}&amp;profitCenterPrintTemplateId=${partAgreeTemplateId}&amp;camundaMessageName=ProfitCenterRegeneratedMessage</camunda:inputParameter><camunda:inputParameter name="method">POST</camunda:inputParameter><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="CamundaUser">${lastUser}</camunda:entry></camunda:map></camunda:inputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0ay4s3h</bpmn:incoming><bpmn:outgoing>Flow_16432wy</bpmn:outgoing></bpmn:serviceTask><bpmn:intermediateCatchEvent id="Event_1y65i0e" name="Ожидаем сообщение о готовности печатки" camunda:asyncBefore="true"><bpmn:incoming>Flow_16432wy</bpmn:incoming><bpmn:outgoing>Flow_0ngjy38</bpmn:outgoing><bpmn:messageEventDefinition id="MessageEventDefinition_00our34" messageRef="Message_1w7cg9i" /></bpmn:intermediateCatchEvent><bpmn:sequenceFlow id="Flow_0ngjy38" sourceRef="Event_1y65i0e" targetRef="ServiceTask_19pm05a" /><bpmn:exclusiveGateway id="Gateway_1sl3o0q" default="Flow_0htgwnl"><bpmn:incoming>SequenceFlow_1jm0v3s</bpmn:incoming><bpmn:outgoing>Flow_0ay4s3h</bpmn:outgoing><bpmn:outgoing>Flow_0htgwnl</bpmn:outgoing></bpmn:exclusiveGateway><bpmn:sequenceFlow id="Flow_0ay4s3h" sourceRef="Gateway_1sl3o0q" targetRef="Activity_0bw4svw"><bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recalculation_enabled == true}</bpmn:conditionExpression></bpmn:sequenceFlow><bpmn:sequenceFlow id="Flow_0htgwnl" sourceRef="Gateway_1sl3o0q" targetRef="ServiceTask_19pm05a" /><bpmn:sequenceFlow id="SequenceFlow_1jm0v3s" sourceRef="ServiceTask_0y9tntx" targetRef="Gateway_1sl3o0q" /><bpmn:serviceTask id="Activity_0wgw6h8" name="Ищем все дисклеймеры"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/asset-allocator/api/desktop/offer/part-agree/instruments?templatePrimaryId=2640df65-9cf6-4217-9884-99944cc04488</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="response11">${response}</camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>SequenceFlow_0or7jn6</bpmn:incoming><bpmn:outgoing>Flow_0u2a9zb</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_0u2a9zb" sourceRef="Activity_0wgw6h8" targetRef="Activity_11cugxm" /><bpmn:serviceTask id="Activity_11cugxm" name="Ищем один дисклеймер"><bpmn:extensionElements><camunda:properties><camunda:property name="isEzdocServiceTask" value="true" /><camunda:property name="ezdocServiceTaskType" value="request" /><camunda:property name="requestType" value="GENERIC" /></camunda:properties><camunda:connector><camunda:inputOutput><camunda:inputParameter name="headers"><camunda:map><camunda:entry key="Accept">*/*</camunda:entry><camunda:entry key="Content-Type">application/json</camunda:entry></camunda:map></camunda:inputParameter><camunda:inputParameter name="url">${ezdocUrl}/asset-allocator/api/instrument/one?primaryId=6929ac54-3047-4c89-a6ff-cdb9df262f2f</camunda:inputParameter><camunda:inputParameter name="method">GET</camunda:inputParameter><camunda:outputParameter name="d_Category"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).attributes.Category
}
catch (e)
{
"0"
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="d_DisplayOrder"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).attributes.DisplayOrder
}
catch (e)
{
0
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="d_PartText"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).attributes.PartText
}
catch (e)
{
" "
}</camunda:script></camunda:outputParameter><camunda:outputParameter name="d_IsConstant"><camunda:script scriptFormat="javascript">try {
JSON.parse(response).attributes.IsConstant
}
catch (e)
{
false
}</camunda:script></camunda:outputParameter></camunda:inputOutput><camunda:connectorId>http-connector</camunda:connectorId></camunda:connector></bpmn:extensionElements><bpmn:incoming>Flow_0u2a9zb</bpmn:incoming><bpmn:outgoing>Flow_1v2zdj9</bpmn:outgoing></bpmn:serviceTask><bpmn:sequenceFlow id="Flow_1v2zdj9" sourceRef="Activity_11cugxm" targetRef="UserTask_0atfrph" /></bpmn:process><bpmn:message id="Message_1w7cg9i" name="ProfitCenterRegeneratedMessage" /><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="TEMPLATE_INSTANCE_PROCESS_offer2_6a21af97-f37c-48ed-a062-7b1cc5f5f4a2"><bpmndi:BPMNEdge id="SequenceFlow_1jm0v3s_di" bpmnElement="SequenceFlow_1jm0v3s"><di:waypoint x="2084" y="244" /><di:waypoint x="2105" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0htgwnl_di" bpmnElement="Flow_0htgwnl"><di:waypoint x="2130" y="219" /><di:waypoint x="2130" y="140" /><di:waypoint x="2500" y="140" /><di:waypoint x="2500" y="204" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0ay4s3h_di" bpmnElement="Flow_0ay4s3h"><di:waypoint x="2155" y="244" /><di:waypoint x="2180" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0ngjy38_di" bpmnElement="Flow_0ngjy38"><di:waypoint x="2368" y="244" /><di:waypoint x="2450" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_16432wy_di" bpmnElement="Flow_16432wy"><di:waypoint x="2280" y="244" /><di:waypoint x="2332" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0rjzaw6_di" bpmnElement="Flow_0rjzaw6"><di:waypoint x="2550" y="244" /><di:waypoint x="2590" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_06gbo6o_di" bpmnElement="Flow_06gbo6o"><di:waypoint x="1418" y="244" /><di:waypoint x="1522" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_054e6nm_di" bpmnElement="SequenceFlow_054e6nm"><di:waypoint x="1585" y="416" /><di:waypoint x="2640" y="416" /><di:waypoint x="2640" y="284" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0vx13u7_di" bpmnElement="SequenceFlow_0vx13u7"><di:waypoint x="1930" y="219" /><di:waypoint x="1930" y="174" /><di:waypoint x="1572" y="174" /><di:waypoint x="1572" y="204" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1yhpitw_di" bpmnElement="SequenceFlow_1yhpitw"><di:waypoint x="1955" y="244" /><di:waypoint x="1984" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0g21dwa_di" bpmnElement="SequenceFlow_0g21dwa"><di:waypoint x="1776" y="244" /><di:waypoint x="1905" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1qprfcd_di" bpmnElement="SequenceFlow_1qprfcd"><di:waypoint x="1622" y="244" /><di:waypoint x="1676" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0tvb0if_di" bpmnElement="SequenceFlow_0tvb0if"><di:waypoint x="1430" y="416" /><di:waypoint x="1485" y="416" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_162vbdb_di" bpmnElement="SequenceFlow_162vbdb"><di:waypoint x="1242" y="365" /><di:waypoint x="1242" y="416" /><di:waypoint x="1330" y="416" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1nd8j3u_di" bpmnElement="SequenceFlow_1nd8j3u"><di:waypoint x="2690" y="244" /><di:waypoint x="2740" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_05vltot_di" bpmnElement="SequenceFlow_05vltot"><di:waypoint x="1418" y="120" /><di:waypoint x="2640" y="120" /><di:waypoint x="2640" y="204" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0hkcpho_di" bpmnElement="SequenceFlow_0hkcpho"><di:waypoint x="1242" y="315" /><di:waypoint x="1242" y="244" /><di:waypoint x="1318" y="244" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1o4099i_di" bpmnElement="SequenceFlow_1o4099i"><di:waypoint x="1242" y="315" /><di:waypoint x="1242" y="120" /><di:waypoint x="1318" y="120" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_1fidi66_di" bpmnElement="SequenceFlow_1fidi66"><di:waypoint x="1185" y="340" /><di:waypoint x="1217" y="340" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_049okmm_di" bpmnElement="SequenceFlow_049okmm"><di:waypoint x="2840" y="244" /><di:waypoint x="2922" y="244" /><bpmndi:BPMNLabel><dc:Bounds x="1026.5" y="99" width="0" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="SequenceFlow_0or7jn6_di" bpmnElement="SequenceFlow_0or7jn6"><di:waypoint x="188" y="340" /><di:waypoint x="220" y="340" /><bpmndi:BPMNLabel><dc:Bounds x="228" y="114" width="90" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_0u2a9zb_di" bpmnElement="Flow_0u2a9zb"><di:waypoint x="320" y="340" /><di:waypoint x="470" y="340" /></bpmndi:BPMNEdge><bpmndi:BPMNEdge id="Flow_1v2zdj9_di" bpmnElement="Flow_1v2zdj9"><di:waypoint x="570" y="340" /><di:waypoint x="1085" y="340" /></bpmndi:BPMNEdge><bpmndi:BPMNShape id="EndEvent_0djl7a3_di" bpmnElement="EndEvent_0djl7a3"><dc:Bounds x="2922" y="226" width="36" height="36" /><bpmndi:BPMNLabel><dc:Bounds x="1064" y="142" width="90" height="12" /></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1ezl3om_di" bpmnElement="Task_1ujk4ck"><dc:Bounds x="2740" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1twgz9c_di" bpmnElement="ServiceTask_1twgz9c"><dc:Bounds x="2590" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0atfrph_di" bpmnElement="UserTask_0atfrph"><dc:Bounds x="1085" y="300" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_1xftubo_di" bpmnElement="Gateway_0ewpioj" isMarkerVisible="true"><dc:Bounds x="1217" y="315" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1p12lhg_di" bpmnElement="ServiceTask_1p12lhg"><dc:Bounds x="1318" y="80" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_19pm05a_di" bpmnElement="ServiceTask_19pm05a"><dc:Bounds x="2450" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0wyw1c2_di" bpmnElement="ServiceTask_0wyw1c2"><dc:Bounds x="1330" y="376" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="UserTask_0za42ik_di" bpmnElement="UserTask_0za42ik"><dc:Bounds x="1522" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_0y9tntx_di" bpmnElement="ServiceTask_0y9tntx"><dc:Bounds x="1984" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1ve2fvh_di" bpmnElement="ServiceTask_1ve2fvh"><dc:Bounds x="1676" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ExclusiveGateway_13twtyp_di" bpmnElement="Gateway_03r6atj" isMarkerVisible="true"><dc:Bounds x="1905" y="219" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="ServiceTask_1ty8ze2_di" bpmnElement="ServiceTask_1ty8ze2"><dc:Bounds x="1485" y="376" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0dcw9t5_di" bpmnElement="Activity_00kxf3z"><dc:Bounds x="1318" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_004faqz_di" bpmnElement="Activity_0bw4svw"><dc:Bounds x="2180" y="204" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Event_14ud5bl_di" bpmnElement="Event_1y65i0e"><dc:Bounds x="2332" y="226" width="36" height="36" /><bpmndi:BPMNLabel><dc:Bounds x="2318" y="269" width="67" height="53" /></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape id="Gateway_1sl3o0q_di" bpmnElement="Gateway_1sl3o0q" isMarkerVisible="true"><dc:Bounds x="2105" y="219" width="50" height="50" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds x="152" y="322" width="36" height="36" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_0wgw6h8_di" bpmnElement="Activity_0wgw6h8" bioc:stroke="rgb(30, 136, 229)" bioc:fill="rgb(187, 222, 251)"><dc:Bounds x="220" y="300" width="100" height="80" /></bpmndi:BPMNShape><bpmndi:BPMNShape id="Activity_11cugxm_di" bpmnElement="Activity_11cugxm" bioc:stroke="rgb(30, 136, 229)" bioc:fill="rgb(187, 222, 251)"><dc:Bounds x="470" y="300" width="100" height="80" /></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>